
          0200
          0200          ;*********************************
          0200          ;**                             **
          0200          ;**     CAOS 4.2 reassembliert  **
          0200          ;**     von haftmann#software   **
          0200          ;**     03.12.91 bis 27.03.92   **
          0200          ;**                             **
          0200          ;**     ergaenzt: ML-Soft        **
          0200          ;**              13.04.94       **
          0200          ;*********************************
          0200
          0200          ;**     Speicheruebersicht       **
          0200
          0200          ;C000   MODUL, SYSTEM
          0200          ;C0F7   KEYL, SQR, MULT, WININ, COLOR
          0200          ;C17C   LINE, PUDE
          0200          ;C223   DISPLAY, MODIFY
          0200          ;C2D5   V24OUT
          0200          ;C3CF   ShCLR-Reaktionsprogramm
          0200          ;C425   Hardcopyroutinen
          0200          ;C64F   V24DUP und UMINIT
          0200          ;C70E   GARG, MBIN, MBOUT
          0200          ;C8A4   frei *)
          0200          ;------------------------------------
          0200          ;E000   RESET und BASIC-Verteiler
          0200          ;E040   CRT-Treiber mit PADR
          0200          ;E339   KBD-Treiber mit BRKT
          0200          ;E3E8   SWITCH, JUMP
          0200          ;E4B4   TAPE-Treiber
          0200          ;E64F   BASIC-Extension
          0200          ;EDDB   ESC-Tabelle
          0200          ;EDF1   frei *)
          0200          ;EE00   Zeichenbildtab. Grossbuchst. *)
          0200          ;------------------------------------
          0200          ;F000   PWRON und Programmverteiler
          0200          ;F12A   Kommandointerpreter (MENU)
          0200          ;F238   KBD, IRM-Default, INLIN
          0200          ;F354   Hexzahlen-Verarbeitung
          0200          ;F3D0   Systeminit, SIXD, Portinittab.
          0200          ;F488   SAVE, VERIFY, LOAD
          0200          ;F619   COLOR, CSTBT, DISPLAY, MODIFY,
          0200          ;       WINDOW-Routinen, KEY, KEYLIST
          0200          ;F74A   CUCP, Grafikroutinen, CIRCLE
          0200          ;F86B   MBOUT,MBIN, MODUL, SYSTEM
          0200          ;F8A7   BASIC-I/O-Verteiler
          0200          ;F91C   ZKOUT, TON, ESC-Prograemmchen
          0200          ;F9C6   V24OUT, V24DUP, ISR SIO
          0200          ;FB61   ROMC-Schalter, MULT, SQR
          0200          ;FB92   ESC/P->IBM-Codewandeltabelle
          0200          ;FBA0   I/O-UP-Nummer-Tabelle
          0200          ;FBA8   Unterprogrammtab. fuer SUTAB
          0200          ;FC3A   Tastaturtabelle KTAB
          0200          ;FCBA   Interruptvektortabelle
          0200          ;FCC8   Steuerfunktionstabelle fuer CTAB
          0200          ;FD08   BASIC-Token
          0200          ;FD2B   Sprungtabelle f. BASIC-Token
          0200          ;FDF0   frei *)
          0200          ;FDF8   Bittabelle fuer Punktroutinen
          0200          ;FE00   Zeichenbildtab. Kleinbuchst. *)
          0200          ;------------------------------------
          0200          ;*) nicht in diesem Listing aufgefuehrt
          0200
          0200
          0200          ;**     EQU-Liste               **
          0200
          0200
          0200          ARGC    EQU     0B780H
          0200          ARGN    EQU     0B781H
          0200          ARG1    EQU     0B782H
          0200          ARG2    EQU     0B784H
          0200          ARG3    EQU     0B786H
          0200          ARG49   EQU     0B788H
          0200          ARG10   EQU     0B794H
          0200          NUMNX   EQU     0B796H
          0200          NUMVX   EQU     0B797H
          0200          HCADR   EQU     0B799H
          0200          WINNR   EQU     0B79BH
          0200          WINON   EQU     0B79CH
          0200          WINLG   EQU     0B79EH
          0200          CURSO   EQU     0B7A0H
          0200          STBT    EQU     0B7A2H
          0200          COLOR   EQU     0B7A3H
          0200          WEND    EQU     0B7A4H
          0200          CCTL0   EQU     0B7A6H
          0200          SYSP    EQU     0B7AEH
          0200          SUTAB   EQU     0B7B0H
          0200          CTAB    EQU     0B7B2H
          0200          BJUMP   EQU     0B7B4H
          0200          OUTAB   EQU     0B7B9H
          0200          INTAB   EQU     0B7BBH
          0200          UOUT1   EQU     0B7BDH
          0200          UIN1    EQU     0B7C0H
          0200          UOUT2   EQU     0B7C3H
          0200          UIN2    EQU     0B7C6H
          0200          IOERR   EQU     0B7C9H
          0200          VRAM    EQU     0B7CBH
          0200          ZOTAB   EQU     0B7CDH
          0200          ZWEND   EQU     0B7CFH
          0200          FTAST   EQU     0B7D1H
          0200          HOR     EQU     0B7D3H
          0200          VERT    EQU     0B7D5H
          0200          FARB    EQU     0B7D6H
          0200          MIXIT   EQU     0B7D7H
          0200          VORTN   EQU     0B7D8H
          0200          DTADR   EQU     0B7DAH
          0200          DTNR    EQU     0B7DCH
          0200          L3TAB   EQU     0B7DDH
          0200          L3SIZ   EQU     0B7DFH
          0200          COUNT   EQU     0B7E0H
          0200          HCPZ    EQU     0B7E1H
          0200          INTV1   EQU     0B7E2H
          0200          INTV1L  EQU     0B7E4H
          0200          INTV2   EQU     0B7E5H
          0200          INTV2L  EQU     0B7E7H
          0200          HCPZ2   EQU     0B7E8H
          0200          WNDFN   EQU     0B99CH
          0200          ;--------------------------------
          0200
          0200
          0200
          0200
          0200
          0200
          0200
          0200          ;**     CAOS 4.2 ROM C          **
          0200
          0200                  ORG     0C000H
          C000
          C000          MODULC: ;Modulkontrollanzeige
          C000 D5               PUSH    DE
          C001 2E08             LD      L,8     ;ab Platz 8
          C003 E5       MODC1:  PUSH    HL
          C004 3E01             LD      A,1     ;lesen
          C006 CD04E4           CALL    MODU
          C009 7C               LD      A,H
          C00A 3C               INC     A       ;Kennbyte=FFh?
          C00B 280F             JR      Z,MODC2 ;kein Modul
          C00D 7D               LD      A,L
          C00E CD59F3           CALL    AHSPC   ;Platz
          C011 7C               LD      A,H
          C012 CD59F3           CALL    AHSPC   ;Kennbyte
          C015 7A               LD      A,D
          C016 CD76F3           CALL    AHEX    ;Steuerbyte
          C019 CD6BF3           CALL    CRLF
          C01C E1       MODC2:  POP     HL
          C01D 7D               LD      A,L
          C01E C604             ADD     4       ;Viererschritte
          C020 6F               LD      L,A
          C021 30E0             JR      NC,MODC1;bis FCh
          C023 CD6BF3           CALL    CRLF
          C026 D1               POP     DE
          C027 C9               RET
          C028
          C028
          C028          SYSTC:  ;Systemcheck, umstaendlichst!!
          C028 D5               PUSH    DE
          C029 CDEEF1           CALL    OSTR
          C02C 43414F53         DB      'CAOS',0
          C031 3E45             LD      A,'E'
          C033 CD29E3           CALL    CRT
          C036 DB88             IN      A,88H
          C038 0F               RRCA            ;Bit 0
          C039 3805             JR      C,SYSC1
          C03B CDECC0           CALL    WON     ;on/off ausg.
          C03E 1803             JR      SYSC2
          C040
          C040 CDE2C0   SYSC1:  CALL    WOFF
          C043 CDEEF1   SYSC2:  CALL    OSTR
          C046 524F4D43         DB      'ROMC ',0
          C04C DD7E04           LD      A,(IX+4)
          C04F CB3F             SRL     A       ;Bits 5,6
          C051 CB3F             SRL     A
          C053 CB3F             SRL     A
          C055 CB3F             SRL     A
          C057 CB3F             SRL     A       ;nach Bits 0,1
          C059 2F               CPL
          C05A E633             AND     '3'
          C05C CD29E3           CALL    CRT     ;Ebene ausgeben
          C05F DB88             IN      A,88H
          C061 5F               LD      E,A
          C062 07               RLCA            ;Bit 7
          C063 3805             JR      C,SYSC3
          C065 CDECC0           CALL    WON     ;on/off ausg.
          C068 1803             JR      SYSC4
          C06A
          C06A CDE2C0   SYSC3:  CALL    WOFF
          C06D CDDAC0   SYSC4:  CALL    WRAM    ;'RAM' ausg.
          C070 3E30             LD      A,'0'
          C072 CD29E3           CALL    CRT     ;RAM0
          C075 CB4B             BIT     1,E     ;von 88h
          C077 2005             JR      NZ,SYSC5
          C079 CDECC0           CALL    WON     ;on/off ausg.
          C07C 1803             JR      SYSC6
          C07E
          C07E CDE2C0   SYSC5:  CALL    WOFF
          C081 CDDAC0   SYSC6:  CALL    WRAM
          C084 3E34             LD      A,'4'   ;RAM4
          C086 CD29E3           CALL    CRT
          C089 DDCB0446         BIT     0,(IX+4)
          C08D 2005             JR      NZ,SYSC7
          C08F CDECC0           CALL    WON     ;on/off ausg.
          C092 1803             JR      SYSC8
          C094
          C094 CDE2C0   SYSC7:  CALL    WOFF
          C097 CDDAC0   SYSC8:  CALL    WRAM
          C09A CDEEF1           CALL    OSTR
          C09D 382000           DB      '8 ',0  ;RAM8
          C0A0 DD7E01           LD      A,(IX+1)
          C0A3 CB3F             SRL     A       ;Bits 4,5,6,7
          C0A5 CB3F             SRL     A
          C0A7 CB3F             SRL     A
          C0A9 CB3F             SRL     A       ;nach 0,1,2,3
          C0AB C62E             ADD     '0'-2
          C0AD CD29E3           CALL    CRT     ;Ebene ausg.
          C0B0 DB89             IN      A,89H
          C0B2 CB6F             BIT     5,A
          C0B4 2005             JR      NZ,SYSC9
          C0B6 CDECC0           CALL    WON     ;on/off ausg.
          C0B9 1803             JR      SYSC10
          C0BB
          C0BB CDE2C0   SYSC9:  CALL    WOFF
          C0BE DD7E01   SYSC10: LD      A,(IX+1)
          C0C1 5F               LD      E,A
          C0C2 CDEEF1           CALL    OSTR
          C0C5 42494C44         DB      'BILD ',0
          C0CB CB53             BIT     2,E     ;Zugriffs-Bit
          C0CD 3E30             LD      A,'0'
          C0CF 2801             JR      Z,SYSC11
          C0D1 3C               INC     A
          C0D2 CD29E3   SYSC11: CALL    CRT     ;Nummer ausg.
          C0D5 CD6BF3           CALL    CRLF
          C0D8 D1               POP     DE
          C0D9 C9               RET
          C0DA
          C0DA          WRAM:   ;Schreibe 'RAM'
          C0DA CDEEF1           CALL    OSTR
          C0DD 52414D00         DB      'RAM',0
          C0E1 C9               RET
          C0E2
          C0E2          WOFF:   ;Schreibe ' ON' und CRLF
          C0E2 CDEEF1           CALL    OSTR
          C0E5 204F4E0D         DB      ' ON',0DH,0AH,0
          C0EB C9               RET
          C0EC
          C0EC          WON:    ;Schreibe ' OFF' und CRLF
          C0EC CDEEF1           CALL    OSTR
          C0EF 204F4646         DB      ' OFF',0DH,0AH,0
          C0F6 C9               RET
          C0F7
          C0F7
          C0F7          KEYLIC: ;Anzeige Belegung F-Tasten
          C0F7 2100B9           LD      HL,0B900H
          C0FA 01F00C           LD      BC,0CF0H
          C0FD 0C       KEYLC1: INC     C
          C0FE 79               LD      A,C
          C0FF CDEBF1           CALL    AHOSTR  ;Fn ausgeben
          C102 203A00           DB      ' :',0
          C105 CDCFF6           CALL    NCHAR   ;Belegung
          C108 CD6BF3           CALL    CRLF
          C10B 10F0             DJNZ    KEYLC1  ;12*
          C10D C9               RET
          C10E
          C10E          SQRC:   ;Quadratwurzel A=SQR(HL)
          C10E AF               XOR     A
          C10F 3EFF             LD      A,0FFH
          C111 5F               LD      E,A
          C112 57               LD      D,A
          C113 3C       SQRC1:  INC     A
          C114 13               INC     DE
          C115 13               INC     DE
          C116 ED52             SBC     HL,DE
          C118 F213C1           JP      P,SQRC1
          C11B C9               RET
          C11C
          C11C          MULC:   ;Multiplikation BA=C*D
          C11C 0600             LD      B,0
          C11E 1E09             LD      E,9
          C120 7A       MULC1:  LD      A,D
          C121 1F               RRA
          C122 1D               DEC     E
          C123 C8               RET     Z
          C124 57               LD      D,A
          C125 78               LD      A,B
          C126 3001             JR      NC,MULC2
          C128 81               ADD     C
          C129 1F       MULC2:  RRA
          C12A 47               LD      B,A
          C12B 18F3             JR      MULC1   ;8*
          C12D
          C12D          WININC: ;Initialisierung eines Fensters
          C12D F5               PUSH    AF
          C12E FE0A             CP      0AH     ;No.
          C130 302E             JR      NC,WINIE
          C132 7A               LD      A,D     ;Zeilen
          C133 A7               AND     A
          C134 282A             JR      Z,WINIE
          C136 84               ADD     H
          C137 3827             JR      C,WINIE
          C139 FE21             CP      21H
          C13B 3023             JR      NC,WINIE
          C13D 7B               LD      A,E     ;Spalten
          C13E A7               AND     A
          C13F 281F             JR      Z,WINIE
          C141 85               ADD     L
          C142 381C             JR      C,WINIE
          C144 FE29             CP      29H
          C146 3018             JR      NC,WINIE
          C148 F1               POP     AF
          C149 D5               PUSH    DE
          C14A E5               PUSH    HL
          C14B CDBBF6           CALL    WCOPY
          C14E E1               POP     HL
          C14F D1               POP     DE
          C150 229CB7           LD      (WINON),HL
          C153 ED539EB7         LD      (WINLG),DE
          C157 ED43A0B7         LD      (CURSO),BC
          C15B 329BB7           LD      (WINNR),A
          C15E A7               AND     A
          C15F C9               RET
          C160
          C160 F1       WINIE:  POP     AF      ;Fehlerende
          C161 37               SCF
          C162 C9               RET
          C163
          C163          COLRC:  ;Farbe setzen (aus L und E)
          C163 3E1F             LD      A,1FH
          C165 A5               AND     L
          C166 17               RLA
          C167 17               RLA
          C168 17               RLA
          C169 6F               LD      L,A
          C16A 3A81B7           LD      A,(ARGN)
          C16D FE02             CP      2
          C16F 7B               LD      A,E
          C170 3003             JR      NC,COLRC1
          C172 3AA3B7           LD      A,(COLOR)
          C175 E607     COLRC1: AND     7
          C177 B5               OR      L
          C178 32A3B7           LD      (COLOR),A
          C17B C9               RET
          C17C
          C17C          LINEC:  ;Zeichen Linie von
          C17C          ;       (ARG1)/(ARG2) nach (ARG3)/(ARG4)
          C17C 2A84B7           LD      HL,(ARG2) ;YANF
          C17F ED5B88B7         LD      DE,(ARG49);YEND
          C183 D9               EXX
          C184 2A82B7           LD      HL,(ARG1) ;XANF
          C187 ED5B86B7         LD      DE,(ARG3) ;XEND
          C18B AF       LINC1:  XOR     A       ;Bit-Merker=0
          C18C ED52             SBC     HL,DE
          C18E 3007             JR      NC,LINC2;wenn XANF>=XEND
          C190 19               ADD     HL,DE   ;rueckgaengig
          C191 EB               EX      DE,HL
          C192 D9               EXX
          C193 EB               EX      DE,HL
          C194 D9               EXX
          C195 18F4             JR      LINC1   ;HL=XSTEPS
          C197
          C197 D9       LINC2:  EXX
          C198 D5               PUSH    DE      ;YEND retten
          C199 ED52     LINC3:  SBC     HL,DE
          C19B 3006             JR      NC,LINC4;steigende Linie
          C19D 19               ADD     HL,DE   ;rueckgaengig
          C19E EB               EX      DE,HL
          C19F F601             OR      1       ;merken
          C1A1 18F6             JR      LINC3   ;fallende Linie
          C1A3
          C1A3 E5       LINC4:  PUSH    HL      ;YSTEPS retten
          C1A4 D9               EXX             ;HL=XSTEPS
          C1A5 C1               POP     BC      ;BC=YSTEPS
          C1A6 E5               PUSH    HL
          C1A7 ED42             SBC     HL,BC   ;Vergleich
          C1A9 E1               POP     HL
          C1AA C5               PUSH    BC
          C1AB 3003             JR      NC,LINC5;HL>=BC, flache
          C1AD E3               EX      (SP),HL ;HL<BC, steile
          C1AE F602             OR      2       ;Linie merken
          C1B0 E5       LINC5:  PUSH    HL      ;HL=MAX(XSTEPS,
          C1B1 44               LD      B,H     ; YSTEPS)
          C1B2 4D               LD      C,L     ;=Punktezahl-1
          C1B3 D9               EXX
          C1B4 C1               POP     BC      ;BC=MAX(...)
          C1B5 D1               POP     DE      ;DE=MIN(XSTEPS,
          C1B6 60               LD      H,B     ; YSTEPS)
          C1B7 69               LD      L,C
          C1B8 CB3C             SRL     H       ;Slave mit 1/2
          C1BA CB1D             RR      L       ;+Master laden
          C1BC D9               EXX
          C1BD E1               POP     HL
          C1BE EB               EX      DE,HL
          C1BF
          C1BF                  ;Hauptschleife
          C1BF          ;AF Bitregister
          C1BF          ;HL lfd. X-Koordinate   HL' Slave
          C1BF          ;DE lfd. Y-Koordinate   DE' -Master
          C1BF          ;BC Punktezaehler        BC' +Master
          C1BF
          C1BF CDE8F7   LINCS:  CALL    SHLDE   ;Punkt setzen
          C1C2 D9               EXX
          C1C3 A7               AND     A
          C1C4 ED52             SBC     HL,DE   ;-Master subtr.
          C1C6 3001             JR      NC,LINC6;kein Uebertrag-
          C1C8                                  ;kein Sprung!
          C1C8 09               ADD     HL,BC   ;+Master add.
          C1C9                                  ;CY bleibt =1!
          C1C9 D9       LINC6:  EXX
          C1CA CB4F             BIT     1,A     ;steil?
          C1CC 2004             JR      NZ,LINC7
          C1CE 23               INC     HL
          C1CF 300B             JR      NC,LINC9
          C1D1 A7               AND     A
          C1D2 CB47     LINC7:  BIT     0,A     ;fallend?
          C1D4 13               INC     DE
          C1D5 2802             JR      Z,LINC8
          C1D7 1B               DEC     DE
          C1D8 1B               DEC     DE
          C1D9 3001     LINC8:  JR      NC,LINC9
          C1DB 23               INC     HL
          C1DC 08       LINC9:  EX      AF,AF'
          C1DD 78               LD      A,B
          C1DE B1               OR      C       ;letzter Punkt?
          C1DF C8               RET     Z
          C1E0 0B               DEC     BC
          C1E1 08               EX      AF,AF'
          C1E2 18DB             JR      LINCS
          C1E4
          C1E4          PUDEC:  ;Punkt loeschen, PA: A=Farbbyte
          C1E4 E5               PUSH    HL
          C1E5 D5               PUSH    DE
          C1E6 C5               PUSH    BC
          C1E7 2AD3B7           LD      HL,(HOR)
          C1EA 7D               LD      A,L
          C1EB E607             AND     7       ;Bit-Nr
          C1ED CB3C             SRL     H
          C1EF CB1D             RR      L
          C1F1 CB3C             SRL     H
          C1F3 CB1D             RR      L
          C1F5 CB3C             SRL     H
          C1F7 CB1D             RR      L       ;/8
          C1F9 C6F8             ADD     0F8H    ;Position in
          C1FB 4F               LD      C,A     ;BITTAB
          C1FC 06FD             LD      B,0FDH
          C1FE 3AD5B7           LD      A,(VERT)
          C201 2F               CPL             ;unten =0/0
          C202 67               LD      H,A
          C203 0A               LD      A,(BC)  ;Bit
          C204 CD4EE0           CALL    PADR
          C207 3816             JR      C,PUDEC1;ausserhalb
          C209 47               LD      B,A     ;Bit
          C20A 4E               LD      C,M
          C20B 2F               CPL
          C20C A1               AND     C
          C20D 77               LD      M,A     ;loeschen
          C20E DD7E01           LD      A,(IX+1)
          C211 5F               LD      E,A
          C212 EE02             XOR     2
          C214 F3               DI
          C215 D384             OUT     84H
          C217 56               LD      D,M     ;Farbbyte
          C218 7B               LD      A,E
          C219 D384             OUT     84H
          C21B FB               EI
          C21C 78               LD      A,B     ;Z=1: Punkt
          C21D A1               AND     C       ;war geloescht
          C21E 7A               LD      A,D     ;Farbbyte
          C21F C1       PUDEC1: POP     BC
          C220 D1               POP     DE
          C221 E1               POP     HL
          C222 C9               RET
          C223
          C223          DPMEMO: ;Ausgabe einer Displayzeile
          C223                  ;HL=Adr, C=Anzahl Bytes
          C223 CD54F3           CALL    HLHX    ;Adresse
          C226 E5               PUSH    HL
          C227 41               LD      B,C
          C228 CD4AF6   DPME1:  CALL    LDAME   ;Byte holen
          C22B 23               INC     HL
          C22C CD59F3           CALL    AHSPC   ;anzeigen
          C22F 10F7             DJNZ    DPME1   ;C*
          C231 E1               POP     HL
          C232 41               LD      B,C
          C233 3E09             LD      A,9
          C235 CD1DF2           CALL    OCHR    ;CUR
          C238 CD4AF6   DPME2:  CALL    LDAME   ;Byte holen
          C23B 23               INC     HL
          C23C CD2AF6           CALL    CSTBT   ;als ASCII
          C23F 10F7             DJNZ    DPME2   ;C*
          C241 C9               RET
          C242
          C242          DISPC:  ;Anzeige Speicherbereich
          C242                  ;HL=Adr, E=Listblocklaenge
          C242                  ;C=Anzahl Bytes pro Zeile
          C242                  ;A=Anzahl Argumente
          C242 FE03             CP      3
          C244 3008             JR      NC,DISP1
          C246 0E08             LD      C,8     ;default
          C248 FE02             CP      2
          C24A 3002             JR      NC,DISP1
          C24C 1E04             LD      E,4     ;default
          C24E D5       DISP1:  PUSH    DE
          C24F CD23C2   DISP2:  CALL    DPMEMO  ;1 Zeile
          C252 CD6BF3           CALL    CRLF
          C255 CDDEE3           CALL    BRKT
          C258 3806             JR      C,DISP3
          C25A 1D               DEC     E
          C25B 20F2             JR      NZ,DISP2;E*
          C25D CD17F2           CALL    INTB    ;Warten Taste
          C260 D1       DISP3:  POP     DE
          C261 FE03             CP      3       ;BRK?
          C263 C8               RET     Z
          C264 FE13             CP      13H     ;STOP?
          C266 20E6             JR      NZ,DISP1
          C268 1802             JR      MODI1
          C26A
          C26A          MODIC:  ;Anzeige/Veraendern Speicher-
          C26A                  ;bereich, Par. wie DISPC
          C26A 0E01             LD      C,1
          C26C CD23C2   MODI1:  CALL    DPMEMO
          C26F 3E05             LD      A,5
          C271 32A0B7           LD      (CURSO),A
          C274 CD34F3           CALL    INLIN
          C277 E5               PUSH    HL
          C278 CD92F3           CALL    RHEX    ;Adresse
          C27B 7E               LD      A,M
          C27C E1               POP     HL
          C27D 3851             JR      C,MODI9 ;Fehler
          C27F A7               AND     A
          C280 28EA             JR      Z,MODI1
          C282 2A97B7           LD      HL,(NUMVX)
          C285 E5       MODI2:  PUSH    HL
          C286 CD92F3           CALL    RHEX    ;Datenbyte
          C289 7E               LD      A,M
          C28A A7               AND     A       ;kein Zeichen
          C28B 23               INC     HL      ;einlesbar?
          C28C 7E               LD      A,M
          C28D E1               POP     HL
          C28E 2804             JR      Z,MODI4
          C290 CD62F6   MODI3:  CALL    LDMAE   ;eintragen
          C293 23               INC     HL
          C294 1A       MODI4:  LD      A,(DE)
          C295 FE2E             CP      '.'     ;Abschluss?
          C297 C8               RET     Z
          C298 FE2C             CP      ','     ;1 Zeichen?
          C29A 2005             JR      NZ,MODI5
          C29C 13               INC     DE
          C29D 1A               LD      A,(DE)  ;vom Video-RAM
          C29E 13               INC     DE
          C29F 18EF             JR      MODI3   ;eintragen
          C2A1
          C2A1 FE3A     MODI5:  CP      ':'     ;Rueckschritt?
          C2A3 2003             JR      NZ,MODI6
          C2A5 2B               DEC     HL
          C2A6 18C4             JR      MODI1
          C2A8
          C2A8 FE2F     MODI6:  CP      '/'     ;neue Adresse?
          C2AA 200B             JR      NZ,MODI0
          C2AC 13               INC     DE
          C2AD CD92F3           CALL    RHEX
          C2B0 381E             JR      C,MODI9
          C2B2 2A97B7           LD      HL,(NUMVX)
          C2B5 18B5             JR      MODI1
          C2B7
          C2B7 FE27     MODI0:  CP      27H     ;Zeichenkette?
          C2B9 200E             JR      NZ,MODI8
          C2BB 13               INC     DE
          C2BC 1A       MODI7:  LD      A,(DE)  ;Zeichen holen
          C2BD 13               INC     DE
          C2BE A7               AND     A       ;Dummy-Ende?
          C2BF 28AB             JR      Z,MODI1
          C2C1 FE27             CP      27H     ;Ende Kette?
          C2C3 28CF             JR      Z,MODI4
          C2C5 77               LD      M,A     ;PROGRAMMFEHLER
          C2C6 23               INC     HL      ;(richtig LDMAE)
          C2C7 18F3             JR      MODI7
          C2C9
          C2C9 A7       MODI8:  AND     A       ;Ende Zeile?
          C2CA 28A0             JR      Z,MODI1
          C2CC FE20             CP      ' '     ;Leerzeichen?
          C2CE 28B5             JR      Z,MODI2
          C2D0 CD61F3   MODI9:  CALL    ERRM    ;sonst ERROR
          C2D3 1897             JR      MODI1
          C2D5
          C2D5
          C2D5          V24OC:  ;Initialisieren Druckerausgabe
          C2D5                  ;PE: Argumente
          C2D5 2181B7           LD      HL,ARGN
          C2D8 7E               LD      A,M
          C2D9 FE03             CP      3
          C2DB 3024             JR      NC,V24O3;mehr als 2 Arg
          C2DD 0608             LD      B,8     ;ab Platz 8
          C2DF CDB1C3           CALL    V24SU   ;M003 suchen
          C2E2 3856             JR      C,V24O6 ;nicht gef.
          C2E4 21E2F9           LD      HL,HCPGM
          C2E7 2299B7           LD      (HCADR),HL;ShCLR belegen
          C2EA 1106FA           LD      DE,PRINT
          C2ED 21E1B7           LD      HL,HCPZ
          C2F0 CB4E             BIT     1,M     ;UOUT1 oder 2?
          C2F2 2006             JR      NZ,V24O1
          C2F4 ED53BEB7         LD      (UOUT1+1),DE
          C2F8 1804             JR      V24O2
          C2FA
          C2FA ED53C4B7 V24O1:  LD      (UOUT2+1),DE
          C2FE C38FC3   V24O2:  JP      V24O12
          C301
          C301 23       V24O3:  INC     HL
          C302 46               LD      B,M     ;ab Platz (ARG1)
          C303 CDB1C3           CALL    V24SU   ;M003 suchen
          C306 3832             JR      C,V24O6 ;nicht gef.
          C308 23               INC     HL
          C309 23               INC     HL
          C30A 7E               LD      A,M     ;SIO A oder B?
          C30B 3D               DEC     A
          C30C 200A             JR      NZ,V24O4
          C30E 3AE1B7           LD      A,(HCPZ)
          C311 CB97             RES     2,A     ;merken SIOA
          C313 32E1B7           LD      (HCPZ),A
          C316 180B             JR      V24O5
          C318
          C318 3D       V24O4:  DEC     A
          C319 201F             JR      NZ,V24O6;Fehler
          C31B 3AE1B7           LD      A,(HCPZ)
          C31E CBD7             SET     2,A     ;merken SIOB
          C320 32E1B7           LD      (HCPZ),A
          C323 23       V24O5:  INC     HL
          C324 23               INC     HL
          C325 1106FA           LD      DE,PRINT
          C328 7E               LD      A,M     ;USER1 oder 2?
          C329 3D               DEC     A
          C32A 3D               DEC     A
          C32B 200F             JR      NZ,V24O7
          C32D ED53BEB7         LD      (UOUT1+1),DE
          C331 11E1B7           LD      DE,HCPZ
          C334 1A               LD      A,(DE)
          C335 CB8F             RES     1,A     ;merken USER1
          C337 12               LD      (DE),A
          C338 1810             JR      V24O8
          C33A
          C33A 1872     V24O6:  JR      V24O13  ;Fehlersprung
          C33C
          C33C 3D       V24O7:  DEC     A
          C33D 20FB             JR      NZ,V24O6;Fehler
          C33F ED53C4B7         LD      (UOUT2+1),DE
          C343 11E1B7           LD      DE,HCPZ
          C346 1A               LD      A,(DE)
          C347 CBCF             SET     1,A     ;merken USER2
          C349 12               LD      (DE),A
          C34A 3A81B7   V24O8:  LD      A,(ARGN)
          C34D FE04             CP      4
          C34F 23               INC     HL
          C350 23               INC     HL
          C351 383C             JR      C,V24O12;weniger als 4
          C353 7E               LD      A,M
          C354 A7               AND     A       ;keine Fkt von
          C355 281C             JR      Z,V24O11;ShCLR?-ja
          C357 3D               DEC     A       ;Protokoll?
          C358 280A             JR      Z,V24O9
          C35A 3D               DEC     A       ;Hardcopy?
          C35B 2051             JR      NZ,V24O13
          C35D 3AE1B7           LD      A,(HCPZ)
          C360 CBC7             SET     0,A     ;Hcopy merken
          C362 1805             JR      V24O10
          C364
          C364 3AE1B7   V24O9:  LD      A,(HCPZ)
          C367 CB87             RES     0,A     ;Hcopy aus
          C369 32E1B7   V24O10: LD      (HCPZ),A
          C36C 11E2F9           LD      DE,HCPGM
          C36F ED5399B7         LD      (HCADR),DE
          C373 3A81B7   V24O11: LD      A,(ARGN)
          C376 FE05             CP      5       ;5 Argumente?
          C378 2015             JR      NZ,V24O12
          C37A 23               INC     HL
          C37B 23               INC     HL
          C37C 7E               LD      A,M     ;Druckertyp
          C37D CB27             SLA     A
          C37F CB27             SLA     A
          C381 CB27             SLA     A       ;nach obere
          C383 CB27             SLA     A       ;Tetrade
          C385 4F               LD      C,A
          C386 3AE1B7           LD      A,(HCPZ)
          C389 E60F             AND     0FH     ;in (HCPZ)
          C38B B1               OR      C       ;einbauen
          C38C 32E1B7           LD      (HCPZ),A
          C38F CDD4FA   V24O12: CALL    LCSO
          C392 3E0C             LD      A,0CH   ;CTC-Adresse
          C394 C5               PUSH    BC
          C395 81               ADD     C
          C396 0602             LD      B,2     ;2 Steuerbytes
          C398 4F               LD      C,A
          C399 2AE2B7           LD      HL,(INTV1)
          C39C F3               DI
          C39D EDB3             OTIR            ;CTC init.
          C39F C1               POP     BC
          C3A0 3AE4B7           LD      A,(INTV1L)
          C3A3 3D               DEC     A
          C3A4 3D               DEC     A       ;-2
          C3A5 47               LD      B,A
          C3A6 3E0A             LD      A,0AH   ;SIO-Adresse
          C3A8 81               ADD     C
          C3A9 4F               LD      C,A
          C3AA EDB3             OTIR            ;SIO init.
          C3AC FB               EI
          C3AD C9               RET
          C3AE
          C3AE C361F3   V24O13: JP      ERRM
          C3B1
          C3B1          V24SU:  ;Suche 1. V24-Modul
          C3B1 163C             LD      D,3CH   ;Suchbereich
          C3B3 0E80             LD      C,80H
          C3B5 ED78     V24S1:  IN      A,(C)
          C3B7 FEEE             CP      0EEH    ;M003?
          C3B9 2809             JR      Z,V24S2
          C3BB 04               INC     B       ;bloedsinniger-
          C3BC 04               INC     B       ;weise in
          C3BD 04               INC     B       ;Viererschritten
          C3BE 04               INC     B
          C3BF 15               DEC     D
          C3C0 20F3             JR      NZ,V24S1
          C3C2 37               SCF             ;nicht gef.
          C3C3 C9               RET
          C3C4
          C3C4 E5       V24S2:  PUSH    HL
          C3C5 68               LD      L,B
          C3C6 3E02             LD      A,2
          C3C8 1601             LD      D,1
          C3CA CD04E4           CALL    MODU    ;einschalten
          C3CD E1               POP     HL
          C3CE C9               RET
          C3CF
          C3CF          HCPGMC: ;ShCLR-Reaktionsprogramm
          C3CF E5               PUSH    HL
          C3D0 D5               PUSH    DE
          C3D1 3AE1B7           LD      A,(HCPZ)
          C3D4 CB47             BIT     0,A     ;Hardcopy?
          C3D6 C225C4           JP      NZ,COPIES
          C3D9
          C3D9                  ;Protokollfunktion
          C3D9 2AB9B7           LD      HL,(OUTAB)
          C3DC AF               XOR     A
          C3DD B6               OR      M       ;Null?
          C3DE 201A             JR      NZ,PROTO2
          C3E0 1103FA           LD      DE,ECHO
          C3E3 3D               DEC     A       ;PROGRAMMFEHLER
          C3E4 3D               DEC     A       ;(A ist Null!)
          C3E5 2805             JR      Z,PROTO1
          C3E7 21A3FB           LD      HL,ZEI3 ;nein
          C3EA 1818             JR      PROTO3
          C3EC
          C3EC 21A2FB   PROTO1: LD      HL,ZEI2
          C3EF 1819             JR      PROTO4
          C3F1
          C3F1 ED53BEB7         LD      (UOUT1+1),DE;RUDIMENT
          C3F5 21A2FB           LD      HL,ZEI2     ;RUDIMENT
          C3F8 1814             JR      PROTO5      ;RUDIMENT
          C3FA
          C3FA          PROTO2: ;Protokoll deaktivieren
          C3FA 3D               DEC     A
          C3FB 1106FA           LD      DE,PRINT
          C3FE 21A0FB           LD      HL,ZEI0
          C401 3D               DEC     A
          C402 2806             JR      Z,PROTO4
          C404 ED53C4B7 PROTO3: LD      (UOUT2+1),DE;ruecksetzen
          C408 1804             JR      PROTO5
          C40A
          C40A ED53BEB7 PROTO4: LD      (UOUT1+1),DE;ruecksetzen
          C40E 22B9B7   PROTO5: LD      (OUTAB),HL
          C411 D1               POP     DE
          C412 E1               POP     HL
          C413 C9               RET
          C414
          C414                  ;undefinierbarer Rest
          C414 1B               DB      1BH
          C415 5B313161         DB      '-11a-01e'
          C41D 1B               DB      1BH
          C41E 5B373871         DB      '-78qK@'
          C424 02               DB      2
          C425
          C425          COPIES: ;Hard- oder Screencopy
          C425 C5               PUSH    BC
          C426 F5               PUSH    AF
          C427 3AE1B7           LD      A,(HCPZ)
          C42A CB7F             BIT     7,A
          C42C 282A             JR      Z,HCOPYC
          C42E
          C42E                  ;Screencopy
          C42E 2ACBB7           LD      HL,(VRAM)
          C431 0620             LD      B,20H
          C433 0E28     SCOPY1: LD      C,28H
          C435 7E       SCOPY2: LD      A,M
          C436 23               INC     HL
          C437 A7               AND     A
          C438 2002             JR      NZ,SCOPY3
          C43A 3E20             LD      A,' '   ;doppelt
          C43C FE20     SCOPY3: CP      20H
          C43E 3002             JR      NC,SCOPY4
          C440 3E20             LD      A,' '   ;gemoppelt
          C442 CD06FA   SCOPY4: CALL    PRINT
          C445 0D               DEC     C       ;40 Spalten
          C446 20ED             JR      NZ,SCOPY2
          C448 3E0D             LD      A,0DH   ;CRLF
          C44A CD38FA           CALL    PRINT4
          C44D 3E0A             LD      A,0AH
          C44F CD38FA           CALL    PRINT4
          C452 10DF             DJNZ    SCOPY1  ;32 Zeilen
          C454 F1       HCEND:  POP     AF
          C455 C334F2           JP      POP3
          C458
          C458          HCOPYC: ;..nach Typ verzweigen
          C458 E6F0             AND     0F0H
          C45A 2815             JR      Z,K6313 ;EPSON-komp.
          C45C FE10             CP      10H
          C45E 285C             JR      Z,K6314 ;dto. breit
          C460 FE20             CP      20H
          C462 CA32C5           JP      Z,K6311 ;mit ANSI
          C465 FE30             CP      30H
          C467 CAB7C5           JP      Z,K6312 ;dto. breit
          C46A FE50             CP      50H
          C46C CAFAC5           JP      Z,K6304 ;Thermodrucker
          C46F 18E3             JR      HCEND
          C471                  ;K6303 u.a.: keine Hardcopy!
          C471
          C471 2600     K6313:  LD      H,0
          C473 E5       K6313a: PUSH    HL
          C474 2116C6           LD      HL,C6313;Tabelle
          C477 060A             LD      B,10    ;Laenge
          C479 CD0EC6           CALL    PRZK
          C47C E1               POP     HL
          C47D CD8FC4           CALL    HCLINE  ;1 Zeile
          C480 30F1             JR      NC,K6313a ;naechste
          C482 3E0D     HCCRLF: LD      A,0DH
          C484 CD51FA           CALL    OFILT
          C487 3E0A             LD      A,0AH
          C489 CD51FA           CALL    OFILT   ;CRLF
          C48C C354C4           JP      HCEND
          C48F
          C48F 2E00     HCLINE: LD      L,0
          C491 010800   HCLIN1: LD      BC,8
          C494 E5               PUSH    HL
          C495 1100B7           LD      DE,0B700H ;Kassetten-
          C498 CD4EE0           CALL    PADR      ;puffer
          C49B EDB0             LDIR
          C49D 0E08             LD      C,8
          C49F 0608     HCLIN2: LD      B,8
          C4A1 2100B7           LD      HL,0B700H
          C4A4 CB16     HCLIN3: RL      M
          C4A6 17               RLA
          C4A7 23               INC     HL
          C4A8 10FA             DJNZ    HCLIN3
          C4AA CD51FA           CALL    OFILT
          C4AD 0D               DEC     C
          C4AE 20EF             JR      NZ,HCLIN2 ;naechster
          C4B0 E1               POP     HL        ;Cursor
          C4B1 2C               INC     L
          C4B2 3E28             LD      A,28H
          C4B4 BD               CP      L
          C4B5 20DA             JR      NZ,HCLIN1
          C4B7 7C               LD      A,H
          C4B8 C608             ADD     8       ;naechste Zeile
          C4BA 67               LD      H,A
          C4BB C9               RET
          C4BC
          C4BC
          C4BC 2600     K6314:  LD      H,0
          C4BE E5       K6314a: PUSH    HL
          C4BF 2120C6           LD      HL,C6314  ;Tabelle
          C4C2 060A             LD      B,10      ;Laenge
          C4C4 CD0EC6           CALL    PRZK
          C4C7 E1               POP     HL
          C4C8 2E00             LD      L,0
          C4CA 0604     K6314b: LD      B,4
          C4CC E5               PUSH    HL
          C4CD 1100B7           LD      DE,0B700H ;Kasspuff
          C4D0 CD4EE0           CALL    PADR
          C4D3 7E       K6314c: LD      A,M
          C4D4 12               LD      (DE),A
          C4D5 13               INC     DE
          C4D6 12               LD      (DE),A
          C4D7 13               INC     DE
          C4D8 2C               INC     L
          C4D9 10F8             DJNZ    K6314c  ;4*
          C4DB 0E08             LD      C,8
          C4DD 0608     K6314d: LD      B,8
          C4DF 2100B7           LD      HL,0B700H
          C4E2 CB16     K6314e: RL      M
          C4E4 17               RLA
          C4E5 23               INC     HL
          C4E6 10FA             DJNZ    K6314e
          C4E8 CD51FA           CALL    OFILT
          C4EB CD51FA           CALL    OFILT
          C4EE 0D               DEC     C
          C4EF 20EC             JR      NZ,K6314d
          C4F1 E1               POP     HL
          C4F2 2C               INC     L
          C4F3 3E28             LD      A,28H
          C4F5 BD               CP      L
          C4F6 20D2             JR      NZ,K6314b
          C4F8 7C               LD      A,H
          C4F9 C604             ADD     4
          C4FB 67               LD      H,A
          C4FC 30C0             JR      NC,K6314a
          C4FE 1882             JR      HCCRLF
          C500
          C500          CBYTES: ;C Bytes nach Kass-Puffer
          C500 E5               PUSH    HL
          C501 C5               PUSH    BC
          C502 CD4EE0           CALL    PADR
          C505 0600             LD      B,0
          C507 EDB0             LDIR
          C509 C1               POP     BC
          C50A E1               POP     HL
          C50B C9               RET
          C50C
          C50C          SPRS:   ;8* 6-Nadel-Sprosse ausgeben
          C50C E5               PUSH    HL
          C50D C5               PUSH    BC
          C50E 2E80             LD      L,80H
          C510 0600     SPRS1:  LD      B,0
          C512 1100B7           LD      DE,0B700H
          C515 1A       SPRS2:  LD      A,(DE)
          C516 A5               AND     L       ;CY=0
          C517 2801             JR      Z,SPRS3
          C519 37               SCF             ;CY=1
          C51A CB10     SPRS3:  RL      B
          C51C 13               INC     DE
          C51D 3E06             LD      A,6     ;fuer 6 Bit
          C51F BB               CP      E
          C520 20F3             JR      NZ,SPRS2;oberste Nadel
          C522                                  ;war 0
          C522 A7               AND     A       ;unterste Nadel
          C523 CB10             RL      B       ;=0
          C525 78               LD      A,B
          C526 CD51FA           CALL    OFILT
          C529 CB0D             RRC     L
          C52B CB7D             BIT     7,L
          C52D 28E1             JR      Z,SPRS1
          C52F C1               POP     BC
          C530 E1               POP     HL
          C531 C9               RET
          C532
          C532
          C532 212AC6   K6311:  LD      HL,C6311;Tabelle
          C535 060E             LD      B,14    ;Laenge
          C537 CD0EC6           CALL    PRZK
          C53A 062A             LD      B,2AH   ;256/6=42 Rest4
          C53C 210000           LD      HL,0
          C53F 1100B7   K6311a: LD      DE,0B700H ;KassPuff
          C542 0E06             LD      C,6
          C544 CD00C5           CALL    CBYTES
          C547 CD0CC5           CALL    SPRS    ;1 6*8-Feld
          C54A 2C               INC     L       ;ausgeben
          C54B 3E28             LD      A,28H
          C54D BD               CP      L
          C54E 20EF             JR      NZ,K6311a
          C550 3E06             LD      A,6     ;6 Pixel tiefer
          C552 84               ADD     H
          C553 67               LD      H,A
          C554 2E00             LD      L,0
          C556 E5               PUSH    HL
          C557 C5               PUSH    BC
          C558 212AC6           LD      HL,C6311;wieder Tabelle
          C55B 060E             LD      B,14    ;Laenge
          C55D CD0EC6           CALL    PRZK
          C560 C1               POP     BC
          C561 E1               POP     HL
          C562 05               DEC     B
          C563 20DA             JR      NZ,K6311a
          C565 1100B7   K6311b: LD      DE,0B700H ;KassPuff
          C568 0E04             LD      C,4     ;den Rest
          C56A CD00C5           CALL    CBYTES
          C56D AF               XOR     A
          C56E 12               LD      (DE),A  ;letzte beiden
          C56F 13               INC     DE      ;Zeilen leeren
          C570 12               LD      (DE),A
          C571 CD0CC5           CALL    SPRS
          C574 2C               INC     L
          C575 3E28             LD      A,28H
          C577 BD               CP      L
          C578 20EB             JR      NZ,K6311b
          C57A C382C4           JP      HCCRLF
          C57D
          C57D          CBYTS2: ;C Bytes nach Puffer & doppeln
          C57D E5               PUSH    HL
          C57E 1100B7           LD      DE,0B700H ;KassPuff
          C581 CD4EE0           CALL    PADR
          C584 7E       C2BYTL: LD      A,M
          C585 12               LD      (DE),A
          C586 13               INC     DE
          C587 12               LD      (DE),A  ;doppelt
          C588 13               INC     DE
          C589 2C               INC     L
          C58A 0D               DEC     C
          C58B 20F7             JR      NZ,C2BYTL
          C58D E1               POP     HL
          C58E C9               RET
          C58F
          C58F          S2PRS:  ;8* 6-Nadel-Sprosse doppelt out
          C58F E5               PUSH    HL
          C590 C5               PUSH    BC
          C591 2E80             LD      L,80H
          C593 0600     S2PR1:  LD      B,0
          C595 1100B7           LD      DE,0B700H ;KassPuff
          C598 1A       S2PR2:  LD      A,(DE)
          C599 A5               AND     L
          C59A 2801             JR      Z,S2PR3
          C59C 37               SCF
          C59D CB10     S2PR3:  RL      B
          C59F 13               INC     DE
          C5A0 3E06             LD      A,6
          C5A2 BB               CP      E
          C5A3 20F3             JR      NZ,S2PR2
          C5A5 78               LD      A,B
          C5A6 17               RLA             ;untere beiden
          C5A7 17               RLA             ;Nadeln tot
          C5A8 CD51FA           CALL    OFILT
          C5AB CD51FA           CALL    OFILT
          C5AE CB0D             RRC     L
          C5B0 CB7D             BIT     7,L
          C5B2 28DF             JR      Z,S2PR1
          C5B4 C1               POP     BC
          C5B5 E1               POP     HL
          C5B6 C9               RET
          C5B7
          C5B7
          C5B7 2138C6   K6312:  LD      HL,C6312;Tabelle
          C5BA 060E             LD      B,14    ;Laenge
          C5BC CD0EC6           CALL    PRZK
          C5BF 0655             LD      B,55H   ;256/3=85 Rest1
          C5C1 210000           LD      HL,0
          C5C4 0E03     K6312a: LD      C,3
          C5C6 CD7DC5           CALL    CBYTS2
          C5C9 CD8FC5           CALL    S2PRS
          C5CC 2C               INC     L
          C5CD 3E28             LD      A,28H
          C5CF BD               CP      L
          C5D0 20F2             JR      NZ,K6312a
          C5D2 24               INC     H
          C5D3 24               INC     H
          C5D4 24               INC     H
          C5D5 2E00             LD      L,0
          C5D7 E5               PUSH    HL
          C5D8 C5               PUSH    BC
          C5D9 2138C6           LD      HL,C6312
          C5DC 060E             LD      B,14
          C5DE CD0EC6           CALL    PRZK
          C5E1 C1               POP     BC
          C5E2 E1               POP     HL
          C5E3 10DF             DJNZ    K6312a
          C5E5 0E01     K6312b: LD      C,1     ;restliche 1
          C5E7 CD7DC5           CALL    CBYTS2
          C5EA AF               XOR     A
          C5EB 12               LD      (DE),A
          C5EC 13               INC     DE
          C5ED 12               LD      (DE),A
          C5EE CD8FC5           CALL    S2PRS
          C5F1 2C               INC     L
          C5F2 3E28             LD      A,28H
          C5F4 BD               CP      L
          C5F5 20EE             JR      NZ,K6312b
          C5F7 C382C4           JP      HCCRLF
          C5FA
          C5FA
          C5FA 2600     K6304:  LD      H,0
          C5FC E5       K6304a: PUSH    HL
          C5FD 2146C6           LD      HL,C6304;Tabelle
          C600 0609             LD      B,9     ;Laenge
          C602 CD0EC6           CALL    PRZK
          C605 E1               POP     HL
          C606 CD8FC4           CALL    HCLINE  ;1 Zeile
          C609 30F1             JR      NC,K6304a
          C60B C382C4           JP      HCCRLF
          C60E
          C60E          PRZK:   ;Durch (HL) adressierte
          C60E                  ;Zeichenkette ausgeben, B lang
          C60E 7E               LD      A,M
          C60F 23               INC     HL
          C610 CD51FA           CALL    OFILT
          C613 10F9             DJNZ    PRZK
          C615 C9               RET
          C616
          C616                  ;Grafiksteuersequenzen fuer
          C616                  ;die Druckertypen
          C616 0D09     C6313:  DB      0DH,9
          C618 1B4A18           DB      1BH,'J',24
          C61B 1B2A05           DB      1BH,'*',5
          C61E 4001             DW      140H
          C620
          C620 0D09     C6314:  DB      0DH,9
          C622 1B4A18           DB      1BH,'J',24
          C625 1B2A05           DB      1BH,'*',5
          C628 8002             DW      280H
          C62A
          C62A 1B5B3031 C6311:  DB      1BH,'-01e'
          C62F 1B5B3132         DB      1BH,'-12`'
          C634 1B4B             DB      1BH,'K'
          C636 4001             DW      140H
          C638
          C638 1B5B3031 C6312:  DB      1BH,'-01e'
          C63D 1B5B3132         DB      1BH,'-12`'
          C642 1B4B             DB      1BH,'K'
          C644 8002             DW      280H
          C646
          C646 0D09     C6304:  DB      0DH,9
          C648 1B4A18           DB      1BH,'J',24
          C64B 1B4B             DB      1BH,'K'
          C64D 4001             DW      140H
          C64F
          C64F          V24DC:  ;Duplex-Init
          C64F                  ;PE: Argumente
          C64F 3A81B7           LD      A,(ARGN)
          C652 FE03             CP      3
          C654 3829             JR      C,V24DC2;<3 Argumente
          C656 2182B7           LD      HL,ARG1
          C659 46               LD      B,M     ;ab Platz B
          C65A CDB1C3           CALL    V24SU   ;M003 suchen
          C65D DA61F3           JP      C,ERRM
          C660 23               INC     HL
          C661 23               INC     HL
          C662 3AE8B7           LD      A,(HCPZ2)
          C665 CB46             BIT     0,M     ;SIO A oder B?
          C667 CB97             RES     2,A
          C669 2002             JR      NZ,V24DC1
          C66B CBD7             SET     2,A
          C66D 47       V24DC1: LD      B,A
          C66E 23               INC     HL
          C66F 23               INC     HL
          C670 7E               LD      A,M
          C671 D602             SUB     2       ;USER1 oder 2?
          C673 CB88             RES     1,B
          C675 2802             JR      Z,V24DC6
          C677 CBC8             SET     1,B
          C679 78       V24DC6: LD      A,B
          C67A 32E8B7           LD      (HCPZ2),A
          C67D 1806             JR      V24DC3
          C67F
          C67F CDB1C3   V24DC2: CALL    V24SU   ;PROGRAMMFEHLER
          C682 DA61F3           JP      C,ERRM  ;(B nicht def.)
          C685 1178FA   V24DC3: LD      DE,V24OT
          C688 0198FA           LD      BC,V24IN
          C68B 3AE8B7           LD      A,(HCPZ2)
          C68E CB4F             BIT     1,A
          C690 200A             JR      NZ,V24DC4
          C692 ED53BEB7         LD      (UOUT1+1),DE
          C696 ED43C1B7         LD      (UIN1+1),BC
          C69A 1808             JR      V24DC5
          C69C
          C69C ED53C4B7 V24DC4: LD      (UOUT2+1),DE
          C6A0 ED43C7B7         LD      (UIN2+1),BC
          C6A4 CDE1FA   V24DC5: CALL    LCSOD
          C6A7 3E0C             LD      A,0CH
          C6A9 C5               PUSH    BC
          C6AA 81               ADD     C
          C6AB 0602             LD      B,2     ;2 Initbytes
          C6AD 4F               LD      C,A
          C6AE 2AE5B7           LD      HL,(INTV2)
          C6B1 F3               DI
          C6B2 EDB3             OTIR            ;CTC init.
          C6B4 C1               POP     BC
          C6B5 3AE7B7           LD      A,(INTV2L)
          C6B8 3D               DEC     A
          C6B9 3D               DEC     A
          C6BA 47               LD      B,A
          C6BB 3E0A             LD      A,0AH
          C6BD 81               ADD     C
          C6BE 4F               LD      C,A
          C6BF EDB3     UMINI1: OTIR            ;SIO init.
          C6C1 FB               EI
          C6C2 C9               RET
          C6C3
          C6C3          UMINIT: ;SIO B auf Interruptbetrieb
          C6C3 2178FA           LD      HL,V24OT
          C6C6 22C4B7           LD      (UOUT2+1),HL
          C6C9 0E0D             LD      C,0DH
          C6CB 2101C7           LD      HL,V24UMT
          C6CE 0602             LD      B,2     ;2 Initbytes
          C6D0 F3               DI
          C6D1 EDB3             OTIR            ;CTC init.
          C6D3 060B             LD      B,0BH   ;11 Initbytes
          C6D5 0E0B             LD      C,0BH
          C6D7 18E6             JR      UMINI1
          C6D9
          C6D9          V24INI: ;-Tabellen in IRM kopieren
          C6D9                  ;-M003 suchen und einschalten
          C6D9                  ;-M003-Status in A800h merken
          C6D9 21F0C6           LD      HL,V24TAB
          C6DC 1101A8           LD      DE,0A801H
          C6DF 011100           LD      BC,17
          C6E2 EDB0             LDIR
          C6E4 0608             LD      B,8	;ab Steckplatz 8
          C6E6 CDB1C3           CALL    V24SU	;V.24-Moodul suchen
          C6E9 D8               RET     C	;nicht gefunden
          C6EA 3E01             LD      A,1
          C6EC 3200A8           LD      (0A800H),A
          C6EF C9               RET
          C6F0
          C6F0 47       V24TAB: DB      47H     ;fuer IRM
          C6F1 5B               DB      5BH
          C6F2 0404             DB      4,4
          C6F4 0320             DB      3,20H
          C6F6 056A             DB      5,6AH
          C6F8
          C6F8 47               DB      47H
          C6F9 2E               DB      2EH
          C6FA 18               DB      18H
          C6FB 0444             DB      4,44H
          C6FD 03E1             DB      3,0E1H
          C6FF 056A             DB      5,6AH
          C701
          C701 47       V24UMT: DB      47H     ;fuer Interrupt-
          C702 2E               DB      2EH     ;betrieb
          C703 18               DB      18H
          C704 02E2             DB      2,0E2H
          C706 1444             DB      14H,44H
          C708 03E1             DB      3,0E1H
          C70A 05EA             DB      5,0EAH
          C70C 1118             DB      11H,18H
          C70E
          C70E
          C70E          GARGC:  ;bis 10 Argumente erfassen
          C70E 0181B7           LD      BC,ARGN
          C711 AF               XOR     A
          C712 02               LD      (BC),A  ;(ARGN)=0
          C713 CD92F3   GARG1:  CALL    RHEX
          C716 D8               RET     C       ;Fehler
          C717 7E               LD      A,M
          C718 B7               OR      A       ;Ende-Dummy?
          C719 C8               RET     Z
          C71A 23               INC     HL
          C71B 03               INC     BC
          C71C 7E               LD      A,M     ;L(NUMVX)
          C71D 02               LD      (BC),A  ;L(Argument)
          C71E 23               INC     HL
          C71F 03               INC     BC
          C720 7E               LD      A,M     ;H(NUMVX)
          C721 02               LD      (BC),A  ;H(Argument)
          C722 2E81             LD      L,81H   ;HL=ARGN
          C724 34               INC     M
          C725 7E               LD      A,M
          C726 C6F5             ADD     0F5H    ;10 Argumente?
          C728 30E9             JR      NC,GARG1
          C72A C9               RET             ;Fehler: zu viel
          C72B
          C72B
          C72B          MBOC:   ;Byteweise MB-Ausgabe
          C72B 5A               LD      E,D     ;Steuerbyte
          C72C 57               LD      D,A     ;Datenbyte
          C72D D5               PUSH    DE
          C72E C5               PUSH    BC
          C72F CB5B             BIT     3,E
          C731 2829             JR      Z,NOINIT
          C733 DDCB07CE         SET     1,(IX+7);merken INIT
          C737 3ED5             LD      A,'U'+80H
          C739 BE               CP      M
          C73A D5               PUSH    DE
          C73B 11A000           LD      DE,0A0H ;Vortonlaenge
          C73E 2003             JR      NZ,NOHIU;bei 'U'
          C740 110005           LD      DE,500H ;gedehnt
          C743 ED53D8B7 NOHIU:  LD      (VORTN),DE
          C747 1100B7           LD      DE,0B700H
          C74A 010B00           LD      BC,11
          C74D EDB0             LDIR            ;Name
          C74F EB               EX      DE,HL
          C750 D1               POP     DE
          C751 72               LD      M,D     ;1.Byte
          C752 3E74             LD      A,74H   ;noch-Bytes
          C754 CD9CC8   MBOC1:  CALL    SETDT
          C757 C1       MBOCE:  POP     BC
          C758 D1               POP     DE
          C759 CB9B             RES     3,E
          C75B C9               RET
          C75C
          C75C 2ADAB7   NOINIT: LD      HL,(DTADR)
          C75F 72               LD      M,D     ;Byte eintragen
          C760 CB73             BIT     6,E
          C762 2023             JR      NZ,MCLOS
          C764 3ADCB7           LD      A,(DTNR);kein Close
          C767 3D               DEC     A
          C768 20EA             JR      NZ,MBOC1
          C76A DDCB074E         BIT     1,(IX+7);schon Init?
          C76E 2008             JR      NZ,MBOC2;nein
          C770 CD81C8           CALL    MBLO    ;ja-Blockout
          C773 CD95C8           CALL    SETDTN
          C776 18DF             JR      MBOCE
          C778
          C778 DDCB078E MBOC2:  RES     1,(IX+7);ruecksetzen
          C77C CD1CE5           CALL    ISRO    ;Init
          C77F CD88C8           CALL    MBLNR   ;Blocknr.
          C782 CD95C8           CALL    SETDTN
          C785 18D0     JMBOCE: JR      MBOCE
          C787
          C787 DDCB074E MCLOS:  BIT     1,(IX+7);Init?
          C78B 2805             JR      Z,MBOC3
          C78D CD1CE5           CALL    ISRO    ;nein?-aber
          C790                                  ;jetzt!
          C790 1803             JR      MBOC4
          C792
          C792 CD81C8   MBOC3:  CALL    MBLO    ;Blockout m.Nr.
          C795 ED4BD8B7 MBOC4:  LD      BC,(VORTN)
          C799 CDD9E4           CALL    CSRO
          C79C D5       MBOC5:  PUSH    DE
          C79D CDFFF5           CALL    CSRI
          C7A0 DDCB07AE         RES     5,(IX+7);'U'-Merker
          C7A4 D1               POP     DE      ;ruecksetzen
          C7A5 18DE             JR      JMBOCE
          C7A7
          C7A7          MBIC:   ;Byteweise MB-Eingabe
          C7A7 5A               LD      E,D     ;Steuerbyte
          C7A8 57               LD      D,A     ;Datenbyte (PA!)
          C7A9 D5               PUSH    DE
          C7AA C5               PUSH    BC
          C7AB CB73             BIT     6,E     ;Close?
          C7AD 20ED             JR      NZ,MBOC5
          C7AF CB5B             BIT     3,E     ;Init?
          C7B1 2866             JR      Z,MBIU
          C7B3 3E01             LD      A,1     ;erwarteter Blk
          C7B5 DD7703           LD      (IX+3),A
          C7B8 E5               PUSH    HL
          C7B9 CD8EE5           CALL    ISRI
          C7BC E1       MBIC1:  POP     HL
          C7BD DA71C8           JP      C,JBLERR;Fehler: '*'
          C7C0 DD7E02           LD      A,(IX+2);gelesener Blk.
          C7C3 FE01             CP      1
          C7C5 C271C8           JP      NZ,JBLERR ;Fehler: '*'
          C7C8 DDCB07BE         RES     7,(IX+7);Kopfblk geladen
          C7CC DD3403           INC     (IX+3)  ;erw. Block
          C7CF 1100B7           LD      DE,0B700H
          C7D2 060B             LD      B,11
          C7D4 1A               LD      A,(DE)
          C7D5 FED5             CP      'U'+80H ;hohes 'U'?
          C7D7 2004             JR      NZ,MBIC2
          C7D9 DDCB07EE         SET     5,(IX+7);merken zur
          C7DD           ;Blocknummernausgabeunterdrueckung
          C7DD C629     MBIC2:  ADD     29H     ;Geschuetzte
          C7DF 3012             JR      NC,MBIC3;BASIC-
          C7E1 1A               LD      A,(DE)  ;Programme
          C7E2 D604             SUB     4       ;als un-
          C7E4 12               LD      (DE),A  ;geschuetzt
          C7E5 13               INC     DE      ;anzeigen
          C7E6 12               LD      (DE),A  ;und Setzen
          C7E7 13               INC     DE      ;LIST/EDIT/BYE-
          C7E8 12               LD      (DE),A  ;Schutz
          C7E9 325E03           LD      (35EH),A;<=hier
          C7EC DDCB07F6         SET     6,(IX+7);merken
          C7F0 1100B7           LD      DE,0B700H ;(fuer wen?)
          C7F3 1A       MBIC3:  LD      A,(DE)  ;Name
          C7F4 CD29E3           CALL    CRT     ;anzeigen
          C7F7 BE               CP      M       ;stimmt Name?
          C7F8 2804             JR      Z,MBIC4
          C7FA DDCB07FE         SET     7,(IX+7);nein-merken
          C7FE 23       MBIC4:  INC     HL
          C7FF 13               INC     DE
          C800 10F1             DJNZ    MBIC3
          C802 CD6BF3           CALL    CRLF
          C805 DDCB077E         BIT     7,(IX+7)
          C809 C27BF8           JP      NZ,JIOERR ;zu ?IO ERROR
          C80C EB               EX      DE,HL
          C80D 3E75             LD      A,75H   ;noch Bytes
          C80F 56       MBIC5:  LD      D,M     ;auslesen
          C810 CD9CC8           CALL    SETDT
          C813 7A               LD      A,D
          C814 C1               POP     BC
          C815 D1               POP     DE
          C816 CB9B             RES     3,E
          C818 C9               RET
          C819
          C819 2ADAB7   MBIU:   LD      HL,(DTADR)
          C81C 3ADCB7           LD      A,(DTNR)
          C81F 3D               DEC     A
          C820 20ED             JR      NZ,MBIC5
          C822 CD91E5   MBIU1:  CALL    MBI
          C825 3839             JR      C,MERR
          C827 CD95C8           CALL    SETDTN
          C82A 3EFF             LD      A,0FFH
          C82C DDBE02           CP      (IX+2)  ;Block FF?
          C82F 2817             JR      Z,MBIU3
          C831 DD7E03           LD      A,(IX+3)
          C834 DDBE02           CP      (IX+2)  ;erwarteter?
          C837 280F             JR      Z,MBIU3
          C839 3E2A             LD      A,'*'
          C83B CD29E3           CALL    CRT     ;nicht
          C83E CDE8F1           CALL    BNROST  ;erwartet
          C841 1900             DB      19H,0
          C843 CD8EC8   MBIU2:  CALL    JBRKT
          C846 18DA             JR      MBIU1
          C848
          C848 DD3403   MBIU3:  INC     (IX+3)  ;naechsten
          C84B 3D               DEC     A       ;erwarten
          C84C DDCB076E         BIT     5,(IX+7)
          C850 2006             JR      NZ,MBIU4
          C852 CDE8F1           CALL    BNROST  ;Blocknummer
          C855 3E               DB      '>'     ;unter Vorbe-
          C856 1900             DB      19H,0   ;halt ausgeben
          C858 CD95C8   MBIU4:  CALL    SETDTN
          C85B 2ADAB7           LD      HL,(DTADR)
          C85E 18AF             JR      MBIC5
          C860
          C860 CDEEF1   MERR:   CALL    OSTR    ;Fehler im
          C863 09090909         DB      9,9,9,9 ;Block
          C867 3F00             DB      '?',0
          C869 CDE8F1           CALL    BNROST
          C86C 0D0A00           DB      0DH,0AH,0
          C86F 18D2             JR      MBIU2
          C871
          C871 CDEEF1   JBLERR: CALL    OSTR    ;nicht erwarte-
          C874 2A0800           DB      '*',8,0 ;ter 1. Block
          C877 CD8EC8           CALL    JBRKT
          C87A CD91E5           CALL    MBI
          C87D E5               PUSH    HL
          C87E C3BCC7           JP      MBIC1
          C881
          C881 ED4BD8B7 MBLO:   LD      BC,(VORTN)
          C885 CD2BE5           CALL    MBO
          C888 CDE8F1   MBLNR:  CALL    BNROST
          C88B 3E1900           DB      '>',19H,0
          C88E CDDEE3   JBRKT:  CALL    BRKT    ;bei BRK
          C891 D0               RET     NC      ;auch ?IO ERROR
          C892 C37BF8           JP      JIOERR
          C895
          C895          SETDTN: ;Setzen Datenzeiger neu
          C895 3E80             LD      A,80H
          C897 2100B7           LD      HL,0B700H
          C89A 1801             JR      SETD1
          C89C
          C89C          SETDT:  ;Naechsten Datenzeiger setzen
          C89C 23               INC     HL
          C89D 22DAB7   SETD1:  LD      (DTADR),HL
          C8A0 32DCB7           LD      (DTNR),A
          C8A3 C9               RET
          C8A4
          C8A4                  ;Rest frei
          C8A4
          C8A4                  END

        Errors: 0000
        End+1 : C8A4

          0200
          0200          ;**     CAOS 4.2 ROM E          **
          0200
          0200                  ORG     0E000H
          E000
          E000 C3F6F0           JP      BYE     ;Tasten-RESET
          E003 C34FE6           JP      BEXP1   ;BASIC-
          E006 C363E6           JP      BEXP2   ;Expansionen
          E009 C3DBE6           JP      BEXP3
          E00C 08FD             DW      TOKTAB
          E00E C3A7F8   BASIO:  JP      BASPV
          E011
          E011 7F7F             DW      7F7FH
          E013 42415349         DB      'BASIC',0
          E019 CD2FE0           CALL    BASON
          E01C C30DC0           JP      0C00DH
          E01F
          E01F 7F7F             DW      7F7FH
          E021 52454241         DB      'REBASIC',0
          E029 CD2FE0           CALL    BASON
          E02C C38CC0           JP      0C08CH
          E02F
          E02F          BASON:  ;BASIC-ROM auftauen
          E02F DB88             IN      A,88H
          E031 F680             OR      80H	;BASIC-ROM EIN
          E033 D388             OUT     88H
          E035 DD7E04           LD      A,(IX+4)
          E038 F660             OR      60H     ;Segment 3
          E03A D386             OUT     86H
          E03C DD7704           LD      (IX+4),A
          E03F C9               RET
          E040
          E040          ;CRT-Treiber
          E040
          E040 ED5BA0B7 PADR0:  LD      DE,(CURSO)
          E044 2A9CB7   PADR1:  LD      HL,(WINON)
          E047 19               ADD     HL,DE
          E048 CB24             SLA     H
          E04A CB24             SLA     H
          E04C CB24             SLA     H
          E04E                  ;
          E04E F5       PADR:   PUSH    AF              ;**34**
          E04F 7D               LD      A,L     ;Spalte
          E050 6C               LD      L,H     ;Pixelzeile
          E051 FE28             CP      28H
          E053 3006             JR      NC,IAD2 ;zu gross
          E055 F680             OR      80H
          E057 67               LD      H,A     ;HL=Pixeladr.
          E058 F1               POP     AF
          E059 A7               AND     A       ;CY=0
          E05A C9               RET
          E05B                  ;
          E05B F1       IAD2:   POP     AF
          E05C 37               SCF             ;CY=1
          E05D C9               RET
          E05E
          E05E          TCIF:   ;Test Cursor im Fenster  **33**
          E05E 3A9EB7           LD      A,(WINLG)
          E061 3D               DEC     A
          E062 93               SUB     E       ;Cursor-Spalte
          E063 D8               RET     C
          E064 3A9FB7           LD      A,(WINLG+1)
          E067 3D               DEC     A
          E068 92               SUB     D       ;Cursor-Zeile
          E069 C9               RET
          E06A
          E06A F5       DABR:   PUSH    AF              ;**32**
          E06B CD5EE0           CALL    TCIF
          E06E 38EB             JR      C,IAD2
          E070 3A9CB7           LD      A,(WINON)
          E073 83               ADD     E       ;Cursor-Spalte
          E074 D5               PUSH    DE
          E075 5F               LD      E,A     ;absolut
          E076 3A9DB7           LD      A,(WINON+1)
          E079 82               ADD     D       ;Cursor-Zeile
          E07A 87               ADD     A
          E07B 87               ADD     A
          E07C 87               ADD     A       ;*8
          E07D 6F               LD      L,A     ;Pixelzeile
          E07E 2600             LD      H,0
          E080 54               LD      D,H     ;D=0
          E081 29               ADD     HL,HL
          E082 29               ADD     HL,HL   ;*4
          E083 19               ADD     HL,DE   ;*5, zus. *40
          E084 ED5BCBB7         LD      DE,(VRAM)
          E088 5F               LD      E,A
          E089 19               ADD     HL,DE
          E08A D1               POP     DE
          E08B F1               POP     AF
          E08C A7               AND     A
          E08D C9               RET
          E08E
          E08E          ESC81:  ;Farbe compeln (V<=>H)
          E08E F5               PUSH    AF
          E08F E6C0             AND     0C0H
          E091 4F               LD      C,A     ;Bit 6,7
          E092 F1               POP     AF
          E093 F5               PUSH    AF
          E094 E607             AND     7       ;hFarbe
          E096 07               RLCA
          E097 07               RLCA
          E098 07               RLCA
          E099 B1               OR      C
          E09A 4F               LD      C,A
          E09B F1               POP     AF
          E09C 0F               RRCA
          E09D 0F               RRCA
          E09E 0F               RRCA
          E09F E607             AND     7       ;vFarbe
          E0A1 B1               OR      C
          E0A2 C9               RET
          E0A3
          E0A3          WPIX:   ;Zeichen auf Grafikbildschirm
          E0A3                  ;sichtbar machen, PE: DE,A
          E0A3 E5               PUSH    HL
          E0A4 D5               PUSH    DE
          E0A5 C5               PUSH    BC
          E0A6 F5               PUSH    AF
          E0A7 2A9CB7           LD      HL,(WINON)
          E0AA 19               ADD     HL,DE
          E0AB EB               EX      DE,HL   ;DE:Absolut-Curs
          E0AC 21A6B7           LD      HL,CCTL0
          E0AF 87               ADD     A
          E0B0 3002             JR      NC,WPIX1
          E0B2 2EAA             LD      L,0AAH  ;CCTL2
          E0B4 D640     WPIX1:  SUB     40H
          E0B6 3804             JR      C,WPIX2 ;0..1F o.80..9F
          E0B8 FE80             CP      80H
          E0BA 3804             JR      C,WPIX3 ;20.40 o.A0..C0
          E0BC C640     WPIX2:  ADD     40H
          E0BE 2C               INC     L       ;um 1 CCTL
          E0BF 2C               INC     L       ;hoeher
          E0C0 4E       WPIX3:  LD      C,M
          E0C1 2C               INC     L       ;BC=(CCTL)
          E0C2 46               LD      B,M
          E0C3 87               ADD     A       ;*2
          E0C4 6F               LD      L,A
          E0C5 2600             LD      H,0
          E0C7 29               ADD     HL,HL   ;*4
          E0C8 09               ADD     HL,BC   ;*8
          E0C9 7B               LD      A,E     ;Absolutspalte
          E0CA FE28             CP      28H
          E0CC 3056             JR      NC,POPS4;ausserhalb
          E0CE F680             OR      80H
          E0D0 42               LD      B,D
          E0D1 57               LD      D,A
          E0D2 78               LD      A,B     ;A:=:D
          E0D3 87               ADD     A
          E0D4 87               ADD     A
          E0D5 87               ADD     A       ;*8
          E0D6 5F               LD      E,A     ;DE=Pixadr.
          E0D7 3AA2B7           LD      A,(STBT)
          E0DA CB57             BIT     2,A     ;invers?
          E0DC 280F             JR      Z,WPIX5
          E0DE 4F               LD      C,A     ;ja, per
          E0DF 0608             LD      B,8     ;Schleife
          E0E1 D5               PUSH    DE      ;zeichnen
          E0E2 7E       WPIX4:  LD      A,M
          E0E3 2F               CPL             ;(Hier kein
          E0E4 12               LD      (DE),A  ;Test auf
          E0E5 23               INC     HL      ;Schreiben
          E0E6 13               INC     DE      ;Pixel aus!)
          E0E7 10F9             DJNZ    WPIX4   ;8*
          E0E9 79               LD      A,C
          E0EA 0F               RRCA
          E0EB 1814             JR      WPIX6
          E0ED
          E0ED 0F       WPIX5:  RRCA            ;Schreiben Pix?
          E0EE 3812             JR      C,WPIX7
          E0F0 D5               PUSH    DE      ;ja
          E0F1 EDA0             LDI             ;sehr schnell
          E0F3 EDA0             LDI             ;per LDI
          E0F5 EDA0             LDI
          E0F7 EDA0             LDI
          E0F9 EDA0             LDI
          E0FB EDA0             LDI
          E0FD EDA0             LDI
          E0FF EDA0             LDI
          E101 D1       WPIX6:  POP     DE
          E102 0F       WPIX7:  RRCA            ;Schreiben Farb?
          E103 381F             JR      C,POPS4
          E105 DD7E01           LD      A,(IX+1);ja
          E108 67               LD      H,A
          E109 EE02             XOR     2
          E10B F3               DI
          E10C D384             OUT     84H     ;Farbebene
          E10E 3AA3B7           LD      A,(COLOR)
          E111 12               LD      (DE),A  ;sehr schnell
          E112 13               INC     DE      ;ohne Schleife
          E113 12               LD      (DE),A
          E114 13               INC     DE      ;alles im DI
          E115 12               LD      (DE),A
          E116 13               INC     DE
          E117 12               LD      (DE),A
          E118 13               INC     DE
          E119 12               LD      (DE),A
          E11A 13               INC     DE
          E11B 12               LD      (DE),A
          E11C 13               INC     DE
          E11D 12               LD      (DE),A
          E11E 13               INC     DE
          E11F 12               LD      (DE),A
          E120 7C               LD      A,H
          E121 D384             OUT     84H,A
          E123 FB               EI
          E124 F1       POPS4:  POP     AF
          E125 C1               POP     BC
          E126 D1               POP     DE
          E127 E1               POP     HL
          E128 C9               RET
          E129
          E129          MOVELN: ;Rolle Fenster fuer Scrolling
          E129 E5               PUSH    HL
          E12A D5               PUSH    DE
          E12B C5               PUSH    BC
          E12C F5               PUSH    AF
          E12D 08               EX      AF,AF'
          E12E F5               PUSH    AF
          E12F 79               LD      A,C     ;BC:Pixelzeilen
          E130 08               EX      AF,AF'
          E131 3A9EB7           LD      A,(WINLG) ;Spalten
          E134 E5       MOLN1:  PUSH    HL
          E135 D5               PUSH    DE
          E136 EDA0     MOLN2:  LDI             ;zeichenweise
          E138 EDA0             LDI
          E13A EDA0             LDI
          E13C EDA0             LDI
          E13E EDA0             LDI
          E140 EDA0             LDI
          E142 EDA0             LDI
          E144 EDA0             LDI
          E146 EA36E1           JP      PE,MOLN2
          E149 D1               POP     DE
          E14A E1               POP     HL
          E14B 24               INC     H       ;neue Spalte
          E14C 14               INC     D
          E14D 08               EX      AF,AF'
          E14E 4F               LD      C,A
          E14F 08               EX      AF,AF'
          E150 3D               DEC     A       ;Spaltenzaehler
          E151 20E1             JR      NZ,MOLN1
          E153 08               EX      AF,AF'
          E154 F1               POP     AF
          E155 08               EX      AF,AF'
          E156 18CC             JR      POPS4
          E158
          E158          PCHR:   ;CRT-Grundprogramm
          E158 ED5BA0B7         LD      DE,(CURSO)
          E15C 21A2B7           LD      HL,STBT
          E15F CB66             BIT     4,M     ;ESC aktiv?
          E161 2822             JR      Z,PCHR3
          E163 CBA6     CRT1:   RES     4,M
          E165 FE30             CP      '0'
          E167 D8               RET     C
          E168 FE3A             CP      '9'+1
          E16A 3004             JR      NC,PCHR1
          E16C D630             SUB     '0'
          E16E 180A             JR      PCHR2
          E170                  ;
          E170 FE41     PCHR1:  CP      'A'
          E172 D8               RET     C
          E173 CBAF             RES     5,A
          E175 FE5B             CP      'Z'+1
          E177 D0               RET     NC
          E178 D637             SUB     'A'-0AH
          E17A 21DFB7   PCHR2:  LD      HL,L3SIZ;Tabelle
          E17D BE               CP      M       ;lang genug?
          E17E D0               RET     NC
          E17F 87               ADD     A       ;*2
          E180 2ADDB7           LD      HL,(L3TAB) ;klar zum
          E183 180C             JR      PCHR4   ;Ansprung
          E185                  ;
          E185 FE20     PCHR3:  CP      20H     ;Steuerfunktion?
          E187 3019             JR      NC,PCHR5
          E189 CB5E             BIT     3,M     ;darstellen?
          E18B 2015             JR      NZ,PCHR5
          E18D 87               ADD     A       ;*2
          E18E 2AB2B7           LD      HL,(CTAB)
          E191 4F       PCHR4:  LD      C,A
          E192 0600             LD      B,0
          E194 09               ADD     HL,BC
          E195 7E               LD      A,M
          E196 23               INC     HL
          E197 66               LD      H,M
          E198 6F               LD      L,A
          E199 E9       JPHL:   JP      (HL)    ;anspringen
          E19A
          E19A 7B       ESC0:   LD      A,E     ;Tabulator
          E19B E6F8             AND     0F8H    ;8er Step
          E19D C608             ADD     8
          E19F 5F               LD      E,A
          E1A0 1809             JR      CUR1
          E1A2                  ;
          E1A2 CD6AE0   PCHR5:  CALL    DABR
          E1A5 D8               RET     C       ;ausserhalb
          E1A6 77               LD      M,A     ;ASCII eintragen
          E1A7 CDA3E0           CALL    WPIX    ;darstellen
          E1AA 1C       CUR:    INC     E
          E1AB 3A9EB7   CUR1:   LD      A,(WINLG)
          E1AE 3D               DEC     A
          E1AF BB               CP      E
          E1B0 D0               RET     NC
          E1B1 1E00     NL:     LD      E,0     ;NL fuer 1E
          E1B3 14       CUD:    INC     D
          E1B4 3A9FB7           LD      A,(WINLG+1)
          E1B7 BA               CP      D
          E1B8 C0               RET     NZ
          E1B9 2AA4B7           LD      HL,(WEND)
          E1BC E9               JP      (HL)    ;PAGE o. SCROLL
          E1BD
          E1BD 2A99B7   HCOPY:  LD      HL,(HCADR) ;ShCLR
          E1C0 E9               JP      (HL)
          E1C1
          E1C1 7B       CUL:    LD      A,E
          E1C2 A7               AND     A
          E1C3 2802             JR      Z,CUL1
          E1C5 1D               DEC     E
          E1C6 C9               RET
          E1C7
          E1C7 7A       CUL1:   LD      A,D
          E1C8 A7               AND     A
          E1C9 C8               RET     Z
          E1CA 15               DEC     D
          E1CB 3A9EB7   CEL:    LD      A,(WINLG)
          E1CE 3D               DEC     A
          E1CF 5F               LD      E,A
          E1D0 C9               RET
          E1D1
          E1D1 7A       CUU:    LD      A,D
          E1D2 A7               AND     A
          E1D3 C8               RET     Z
          E1D4 15               DEC     D
          E1D5 C9               RET
          E1D6
          E1D6 2145E2   PAGE:   LD      HL,HOMEPG ;ShCUU
          E1D9 22A4B7   WADR:   LD      (WEND),HL
          E1DC C9               RET
          E1DD
          E1DD 2160E2   SCROL:  LD      HL,SCRLPG ;ShCUD
          E1E0 18F7             JR      WADR
          E1E2
          E1E2 CDC1E1   CLR:    CALL    CUL
          E1E5 D5       DEL:    PUSH    DE      ;Cursor retten
          E1E6 CD6AE0           CALL    DABR
          E1E9 7E               LD      A,M
          E1EA A7               AND     A       ;Ende?
          E1EB 2829             JR      Z,POPDE
          E1ED E5               PUSH    HL      ;VRAM
          E1EE D5       DEL1:   PUSH    DE      ;Cursor
          E1EF 1C               INC     E       ;naechste Spalte
          E1F0 CD6AE0           CALL    DABR    ;raus?
          E1F3 3008             JR      NC,DEL2
          E1F5 1E00             LD      E,0     ;ja, wie NL
          E1F7 14               INC     D
          E1F8 CD6AE0           CALL    DABR    ;raus?
          E1FB 3810             JR      C,DEL3  ;ja-wie Ende
          E1FD 7E       DEL2:   LD      A,M
          E1FE A7               AND     A       ;Ende?
          E1FF 280C             JR      Z,DEL3
          E201 42               LD      B,D
          E202 4B               LD      C,E     ;BC:=DE
          E203 D1               POP     DE      ;DE=links davon
          E204 E3               EX      (SP),HL ;HL=VRAM links
          E205 77               LD      M,A     ;eintragen
          E206 CDA3E0           CALL    WPIX    ;zeichnen
          E209 50               LD      D,B
          E20A 59               LD      E,C     ;DE:=BC
          E20B 18E1             JR      DEL1    ;von vorn
          E20D
          E20D D1       DEL3:   POP     DE
          E20E E1               POP     HL
          E20F 3600             LD      M,0
          E211 3E20             LD      A,' '
          E213 CDA3E0           CALL    WPIX
          E216 D1       POPDE:  POP     DE
          E217 C9               RET
          E218
          E218 D5       INS:    PUSH    DE      ;Cursor
          E219 3E20             LD      A,' '
          E21B CD6AE0           CALL    DABR
          E21E 46       INS1:   LD      B,M     ;VRAM
          E21F 77               LD      M,A     ;neues Zeichen
          E220 CDA3E0           CALL    WPIX    ;zeichnen
          E223 78               LD      A,B
          E224 A7               AND     A       ;Dummy?
          E225 280E             JR      Z,INS2
          E227 1C               INC     E       ;CUR
          E228 CD6AE0           CALL    DABR    ;raus?
          E22B 30F1             JR      NC,INS1
          E22D 1E00             LD      E,0     ;wie NL
          E22F 14               INC     D
          E230 CD6AE0           CALL    DABR    ;raus?
          E233 30E9             JR      NC,INS1
          E235 D1       INS2:   POP     DE      ;wenn ja Schluss
          E236 C9               RET
          E237
          E237 3A9FB7   CLS:    LD      A,(WINLG+1) ;ShHOME
          E23A 1600             LD      D,0
          E23C F5       CLS1:   PUSH    AF
          E23D CDAAE2           CALL    CLLN
          E240 F1               POP     AF
          E241 14               INC     D
          E242 3D               DEC     A
          E243 20F7             JR      NZ,CLS1 ;A Zeilen
          E245 1600     HOMEPG: LD      D,0
          E247 1E00     CBL:    LD      E,0
          E249 C9               RET
          E24A
          E24A          CLLINE: ;Loeschen einer Zeile
          E24A                  ;HL: Adr. C: Laenge, A: Byte
          E24A 41               LD      B,C
          E24B 55       CLL1:   LD      D,L     ;L retten
          E24C 77               LD      M,A     ;zeichenweise
          E24D 2C               INC     L       ;ohne Schleife
          E24E 77               LD      M,A
          E24F 2C               INC     L
          E250 77               LD      M,A
          E251 2C               INC     L
          E252 77               LD      M,A
          E253 2C               INC     L
          E254 77               LD      M,A
          E255 2C               INC     L
          E256 77               LD      M,A
          E257 2C               INC     L
          E258 77               LD      M,A
          E259 2C               INC     L
          E25A 77               LD      M,A
          E25B 6A               LD      L,D     ;L holen
          E25C 24               INC     H
          E25D 10EC             DJNZ    CLL1
          E25F C9               RET
          E260
          E260 3A9EB7   SCRLPG: LD      A,(WINLG) ;Spalten
          E263 4F               LD      C,A
          E264 0600             LD      B,0
          E266 3A9FB7           LD      A,(WINLG+1) ;Zeilen
          E269 3D               DEC     A       ;nur 1 Zeile?
          E26A 283D             JR      Z,SCRL3 ;nur CLLN
          E26C D5               PUSH    DE
          E26D F5               PUSH    AF
          E26E 110000           LD      DE,0    ;Cursor li/oben
          E271 CD6AE0           CALL    DABR
          E274 EB               EX      DE,HL
          E275 212800   SCRL1:  LD      HL,40   ;1 Zeile tiefer
          E278 19               ADD     HL,DE
          E279 E5               PUSH    HL
          E27A C5               PUSH    BC
          E27B EDB0             LDIR            ;im VRAM eine
          E27D C1               POP     BC      ;Zeile rollen
          E27E D1               POP     DE
          E27F 3D               DEC     A
          E280 20F3             JR      NZ,SCRL1;A*
          E282 F1               POP     AF
          E283 87               ADD     A
          E284 87               ADD     A
          E285 87               ADD     A       ;*8: Pixelzeile
          E286 4F               LD      C,A
          E287 110000           LD      DE,0
          E28A 42               LD      B,D
          E28B CD44E0           CALL    PADR1
          E28E EB               EX      DE,HL   ;DE=PixAdr.
          E28F 2E08             LD      L,8     ;H war 0
          E291 19               ADD     HL,DE
          E292 3AA2B7           LD      A,(STBT)
          E295 1F               RRA
          E296 1F               RRA             ;Schreiben Farb?
          E297 380B             JR      C,SCRL2
          E299 F5               PUSH    AF
          E29A CDDEE2           CALL    FARBEA
          E29D CD29E1           CALL    MOVELN
          E2A0 CDDEE2           CALL    FARBEA
          E2A3 F1               POP     AF
          E2A4 17       SCRL2:  RLA             ;Schreiben Pix?
          E2A5 D429E1           CALL    NC,MOVELN
          E2A8 D1               POP     DE
          E2A9 15       SCRL3:  DEC     D
          E2AA                  ;
          E2AA 1E00     CLLN:   LD      E,0     ;ShDEL
          E2AC CD6AE0           CALL    DABR    ;Ausserhalb?
          E2AF D8               RET     C       ;(Selbstschutz)
          E2B0 3A9EB7           LD      A,(WINLG)
          E2B3 47               LD      B,A     ;Spalten
          E2B4 4F               LD      C,A
          E2B5 AF               XOR     A
          E2B6 77       CLLN1:  LD      M,A     ;VRAM loeschen
          E2B7 23               INC     HL
          E2B8 10FC             DJNZ    CLLN1
          E2BA CD44E0           CALL    PADR1
          E2BD D8               RET     C
          E2BE D5               PUSH    DE
          E2BF 3AA2B7           LD      A,(STBT)
          E2C2 0F               RRCA            ;Schreiben Pix?
          E2C3 5F               LD      E,A     ;nach E merken
          E2C4 3806             JR      C,CLLN2
          E2C6 AF               XOR     A
          E2C7 E5               PUSH    HL
          E2C8 CD4AE2           CALL    CLLINE  ;Pixel
          E2CB E1               POP     HL
          E2CC CB0B     CLLN2:  RRC     E       ;Schreiben Farb?
          E2CE 380C             JR      C,CLLN3
          E2D0 CDDEE2           CALL    FARBEA
          E2D3 3AA3B7           LD      A,(COLOR)
          E2D6 CD4AE2           CALL    CLLINE  ;Farbe
          E2D9 CDDEE2           CALL    FARBEA
          E2DC D1       CLLN3:  POP     DE
          E2DD C9               RET
          E2DE
          E2DE DD7E01   FARBEA: LD      A,(IX+1);wie ESC9 - nur mit DI/EI
          E2E1 EE02             XOR     2
          E2E3 F3               DI
          E2E4 DD7701           LD      (IX+1),A
          E2E7 D384             OUT     84H
          E2E9 FB               EI
          E2EA C9               RET
          E2EB
          E2EB 010F0A   BEEP:   LD      BC,0A0FH;CHR(7)
          E2EE 213000           LD      HL,30H
          E2F1 D5               PUSH    DE
          E2F2 5C               LD      E,H     ;E=0
          E2F3 CD2EF9           CALL    TON2
          E2F6 3E1E             LD      A,1EH
          E2F8 CDE0F1           CALL    WAIT
          E2FB 3E03             LD      A,3
          E2FD D38C             OUT     8CH
          E2FF 3E10             LD      A,10H
          E301 D1               POP     DE
          E302 C3E0F1           JP      WAIT
          E305
          E305 213000   CLIK:   LD      HL,30H
          E308 D5               PUSH    DE
          E309 5C               LD      E,H     ;E=0
          E30A CD2EF9           CALL    TON2
          E30D D1               POP     DE
          E30E C9               RET
          E30F
          E30F 21A3B7   ESC8:   LD      HL,COLOR;Farbtausch
          E312 7E               LD      A,M
          E313 CD8EE0           CALL    ESC81
          E316 77       LDMA:   LD      M,A             ;**28**
          E317 C9               RET
          E318
          E318 7E       LDAM:   LD      A,M             ;**29**
          E319 C9               RET
          E31A
          E31A DD7E08   CLICK:  LD      A,(IX+8);ShINS
          E31D EE20             XOR     20H
          E31F DD7708           LD      (IX+8),A
          E322 C9       NOT:    RET
          E323
          E323 21A2B7   ESC:    LD      HL,STBT ;ShSTOP
          E326 CBE6             SET     4,M
          E328 C9               RET
          E329
          E329 E5       CRT:    PUSH    HL              ;**00**
          E32A D5               PUSH    DE
          E32B C5               PUSH    BC
          E32C F5               PUSH    AF
          E32D CD58E1           CALL    PCHR
          E330 ED53A0B7         LD      (CURSO),DE
          E334 F1               POP     AF
          E335 C1               POP     BC
          E336 D1               POP     DE
          E337 E1               POP     HL
          E338 C9               RET
          E339
          E339          ;KBD-Treiber
          E339
          E339          ISRC3:  ;ISR CTC Kanal 3 (Tastatur)
          E339 FB               EI
          E33A F5               PUSH    AF
          E33B 3E23             LD      A,23H   ;DI,ZG256,Res
          E33D D38F             OUT     8FH     ;CTC K3
          E33F DD360D00         LD      (IX+13),0 ;Zeichen tot
          E343 185E             JR      TST4
          E345
          E345          ISRPB:  ;ISR PIO Kanal B (Tastatur)
          E345 F5               PUSH    AF
          E346 DB8F             IN      A,8FH   ;gemessene
          E348 F5               PUSH    AF      ;Zeit retten
          E349 3EA7             LD      A,0A7H  ;EI,ZG256,Res
          E34B D38F             OUT     8FH,A
          E34D 3E8F             LD      A,8FH   ;Zeitkonstante
          E34F D38F             OUT     8FH
          E351 F1               POP     AF
          E352 FB               EI
          E353 B7               OR      A       ;doppelt
          E354 284D             JR      Z,TST4
          E356 FE14             CP      14H     ;gemoppelt
          E358 3849             JR      C,TST4
          E35A FE78             CP      78H     ;zu kurz
          E35C 3045             JR      NC,TST4 ;(z.B.Stoerung)
          E35E FE65             CP      65H     ;Diskriminator
          E360 303D             JR      NC,TST3
          E362 C6BE             ADD     0BEH    ;Stop-Bit?
          E364 3839             JR      C,TST3
          E366 E5               PUSH    HL
          E367 D5               PUSH    DE
          E368 DD7E0C           LD      A,(IX+12)
          E36B 1F               RRA             ;7bit-Scancode
          E36C EE01             XOR     1       ;Startbit neg.
          E36E DD6E0E           LD      L,(IX+14)
          E371 DD660F           LD      H,(IX+15)
          E374 1600             LD      D,0
          E376 5F               LD      E,A
          E377 19               ADD     HL,DE   ;Pos. in KTAB
          E378 7E               LD      A,M     ;ASCII holen
          E379 D1               POP     DE
          E37A E1               POP     HL
          E37B DDCB087E         BIT     7,(IX+8);CAPS aktiv?
          E37F 200A             JR      NZ,TST2 ;1=nein
          E381 FE40             CP      40H
          E383 3806             JR      C,TST2
          E385 FE80             CP      80H
          E387 3002             JR      NC,TST2
          E389 EE20             XOR     20H     ;Klein<=>Gross
          E38B DDBE0D   TST2:   CP      (IX+13) ;= letzter Code?
          E38E 201D             JR      NZ,TST6
          E390 F5               PUSH    AF      ;ja
          E391 3AE0B7           LD      A,(COUNT)
          E394 DDBE0A           CP      (IX+10) ;FastRepeat?
          E397 3811             JR      C,TST5  ;ja
          E399 F1               POP     AF      ;nein
          E39A DD340A           INC     (IX+10) ;Zeit abwarten
          E39D 1804             JR      TST4
          E39F
          E39F DDCB0C1E TST3:   RR      (IX+12) ;Bit rechts
          E3A3 DB89     TST4:   IN      A,89H   ;einschieben
          E3A5 D389             OUT     89H     ;und PIO-Logik
          E3A7 F1               POP     AF      ;freigeben
          E3A8 ED4D             RETI
          E3AA
          E3AA F1       TST5:   POP     AF
          E3AB 1808             JR      TST7
          E3AD
          E3AD DD360A00 TST6:   LD      (IX+10),0 ;neuer Code
          E3B1 FE16             CP      16H     ;CAPS?
          E3B3 2809             JR      Z,TST8
          E3B5 DD770D   TST7:   LD      (IX+13),A ;eintragen
          E3B8 DDCB08C6         SET     0,(IX+8);gueltig machen
          E3BC 18E5             JR      TST4
          E3BE
          E3BE DD7E08   TST8:   LD      A,(IX+8);CAPS-Programm
          E3C1 EE80             XOR     80H
          E3C3 DD7708           LD      (IX+8),A
          E3C6 3E16             LD      A,16H
          E3C8 18EB             JR      TST7
          E3CA
          E3CA          KBDS:   ;Abfrage ohne Quittung   **0C**
          E3CA B7               OR      A
          E3CB DDCB0846         BIT     0,(IX+8);Code gueltig?
          E3CF C8               RET     Z
          E3D0 DD7E0D           LD      A,(IX+13)
          E3D3 37               SCF             ;wenn ja
          E3D4 C9               RET
          E3D5
          E3D5          KBDZ:   ;Abfrage mit Quittung    **0E**
          E3D5 CDCAE3           CALL    KBDS
          E3D8 D0               RET     NC
          E3D9 DDCB0886         RES     0,(IX+8)
          E3DD C9               RET
          E3DE
          E3DE          BRKT:   ;Test auf BRK-Anforderung**2A**
          E3DE CDCAE3           CALL    KBDS
          E3E1 D0               RET     NC
          E3E2 FE03             CP      3
          E3E4 37               SCF
          E3E5 C8               RET     Z
          E3E6 A7               AND     A
          E3E7 C9               RET
          E3E8
          E3E8          ;SWITCH und JUMP
          E3E8
          E3E8 7F7F             DW      7F7FH
          E3EA 53574954         DB      'SWITCH',1
          E3F1 53               LD      D,E
          E3F2 CD04E4           CALL    MODU
          E3F5 7D               LD      A,L
          E3F6 CD59F3           CALL    AHSPC   ;Platz
          E3F9 7C               LD      A,H
          E3FA CD59F3           CALL    AHSPC   ;Kennbyte
          E3FD 7A               LD      A,D
          E3FE CD76F3           CALL    AHEX    ;Steuerbyte
          E401 C36BF3           JP      CRLF
          E404
          E404          MODU:   ;Lesen und Schalten      **26**
          E404 26B8             LD      H,0B8H  ;H(ModulStSp)
          E406 0E80             LD      C,80H   ;I/O-Adr.
          E408 45               LD      B,L
          E409 FE02             CP      2       ;Parameter?
          E40B 3004             JR      NC,MODU1
          E40D 56               LD      D,M     ;Nur lesen
          E40E ED60     RSTRB:  IN      H,(C)
          E410 C9               RET
          E411
          E411 72       MODU1:  LD      M,D     ;eintragen
          E412 7D               LD      A,L
          E413 FE05             CP      5       ;interne Module?
          E415 3814             JR      C,MODU2
          E417 ED51             OUT     (C),D   ;Senden Steuerb.
          E419 18F3             JR      RSTRB
          E41B
          E41B E6F5     MODU6:  AND     0F5H    ;fuer RAM0
          E41D CB42             BIT     0,D
          E41F 285C             JR      Z,OUT88
          E421 CBCF             SET     1,A
          E423 CB4A             BIT     1,D
          E425 2856             JR      Z,OUT88
          E427 CBDF             SET     3,A
          E429 1852             JR      OUT88
          E42B
          E42B FE04     MODU2:  CP      4       ;RAM4?
          E42D 3818             JR      C,MODU3
          E42F DD7E04           LD      A,(IX+4)
          E432 E6FC             AND     0FCH
          E434 CB42             BIT     0,D
          E436 2808             JR      Z,SRAM4
          E438 CBC7             SET     0,A
          E43A CB4A             BIT     1,D
          E43C 2802             JR      Z,SRAM4
          E43E CBCF             SET     1,A
          E440 DD7704   SRAM4:  LD      (IX+4),A
          E443 D386             OUT     86H
          E445 1838             JR      STBFF
          E447
          E447 FE03     MODU3:  CP      3       ;RAM8?
          E449 3824             JR      C,MODU4
          E44B DB89             IN      A,89H	;PIO-A
          E44D E69F             AND     9FH
          E44F CB42             BIT     0,D
          E451 2808             JR      Z,SRAM8 ;RAM8 aus
          E453 CBEF             SET     5,A     ;RAM8 ein
          E455 CB4A             BIT     1,D     ;Schreibschutz?
          E457 2802             JR      Z,SRAM8
          E459 CBF7             SET     6,A     ;aus
          E45B D389     SRAM8:  OUT     89H	;PIO-A
          E45D DD7E01           LD      A,(IX+1)
          E460 F610             OR      10H
          E462 CB52             BIT     2,D     ;RAM8-Segment?
          E464 2002             JR      NZ,SSEG8
          E466 EE10             XOR     10H     ;(nicht vorbe-
          E468 D384     SSEG8:  OUT     84H     ;reitet fuer
          E46A DD7701           LD      (IX+1),A;256k-Variante)
          E46D 1810             JR      STBFF
          E46F
          E46F FE02     MODU4:  CP      2       ;BASIC-ROMC?
          E471 380F             JR      C,MODU5
          E473 DB88             IN      A,88H   ;(keine Ebenen-
          E475 CB42             BIT     0,D     ;Umschaltung!)
          E477 CBBF             RES     7,A     ;aus
          E479 2802             JR      Z,OUT88
          E47B CBFF             SET     7,A     ;ein
          E47D D388     OUT88:  OUT     88H
          E47F 26FF     STBFF:  LD      H,0FFH  ;Kennbyte
          E481 C9               RET
          E482
          E482 FE01     MODU5:  CP      1       ;IRM?
          E484 DB88             IN      A,88H
          E486 DA1BE4           JP      C,MODU6 ;RAM0
          E489 CB42             BIT     0,D
          E48B CB97             RES     2,A
          E48D 28EE             JR      Z,OUT88
          E48F CBD7             SET     2,A
          E491 18EA             JR      OUT88
          E493
          E493 7F7F             DW      7F7FH
          E495 4A554D50         DB      'JUMP',1
          E49A 7D               LD      A,L
          E49B 47       JUMP:   LD      B,A             ;**27**
          E49C 0E80             LD      C,80H
          E49E ED78             IN      A,(C)
          E4A0 3C               INC     A       ;Kennbyte FF?
          E4A1 CA61F3           JP      Z,ERRM  ;ja-Fehler
          E4A4 3EFF             LD      A,0FFH  ;Ausgabe FF
          E4A6 26B8             LD      H,0B8H
          E4A8 68               LD      L,B
          E4A9 77               LD      M,A     ;Eintrag
          E4AA F3               DI
          E4AB ED79             OUT     (C),A
          E4AD DB88             IN      A,88H
          E4AF E67E             AND     7EH
          E4B1 C3B4B7           JP      BJUMP   ;in IRM
          E4B4
          E4B4
          E4B4          ;TAPE-Treiber
          E4B4
          E4B4 F3       ISRI1:  DI
          E4B5 DB88             IN      A,88H
          E4B7 F640             OR      40H     ;Motor ein
          E4B9 E6DF             AND     0DFH    ;LED aus
          E4BB D388     ISRO1:  OUT     88H
          E4BD FB               EI
          E4BE 2AA4B7           LD      HL,(WEND)
          E4C1 22CFB7           LD      (ZWEND),HL
          E4C4 CDFDF1           CALL    NOUT    ;kein Drucker!
          E4C7 22CDB7           LD      (ZOTAB),HL
          E4CA CDD6E1           CALL    PAGE    ;Page Mode
          E4CD 3E03     TOFF:   LD      A,3     ;Ton aus
          E4CF D38C             OUT     8CH     ;CTC0
          E4D1 D38D             OUT     8DH     ;CTC1
          E4D3 DDCB088E         RES     1,(IX+8)
          E4D7 1828             JR      CSRO2
          E4D9
          E4D9          CSRO:   ;Abschluss Bandausgabe    **09**
          E4D9 DD3602FE         LD      (IX+2),0FEH
          E4DD CD2BE5           CALL    MBO
          E4E0 2ACDB7   CSROI:  LD      HL,(ZOTAB) ;intern
          E4E3 22B9B7           LD      (OUTAB),HL
          E4E6 2ACFB7           LD      HL,(ZWEND) ;grosses
          E4E9 22A4B7           LD      (WEND),HL  ;Ruecksetzen
          E4EC 2180B7           LD      HL,0B780H
          E4EF AF               XOR     A
          E4F0 2D       CSRO1:  DEC     L       ;KassPuff
          E4F1 77               LD      M,A     ;loeschen
          E4F2 20FC             JR      NZ,CSRO1
          E4F4 DB88             IN      A,88H
          E4F6 E69F             AND     9FH     ;Motor,LED aus
          E4F8 D388             OUT     88H
          E4FA CD6BF3           CALL    CRLF
          E4FD DDCB0886         RES     0,(IX+8)
          E501 DDCB015E CSRO2:  BIT     3,(IX+1);HiRes?
          E505 2806             JR      Z,CSRO3
          E507 DB89             IN      A,89H   ;nein-
          E509 CBFF             SET     7,A     ;Blinken ein
          E50B D389             OUT     89H
          E50D DDCB084E CSRO3:  BIT     1,(IX+8);neuer Ton?
          E511 20FA             JR      NZ,CSRO3;Ende abwarten
          E513 3E47             LD      A,47H   ;CTC2 auf
          E515 D38E             OUT     8EH     ;Blinken
          E517 3E0C             LD      A,0CH   ;stellen
          E519 D38E             OUT     8EH
          E51B C9               RET
          E51C
          E51C          ISRO:   ;Init. Bandausgabe       **08**
          E51C F3               DI
          E51D DB88             IN      A,88H
          E51F F660             OR      60H     ;Motor,LED ein
          E521 CDBBE4           CALL    ISRO1
          E524 DD360200         LD      (IX+2),0
          E528 010010           LD      BC,1000H
          E52B                  ;
          E52B          MBO:    ;Ausgabe 1 Block         **01**
          E52B DD3402           INC     (IX+2)
          E52E F3               DI
          E52F 3E87             LD      A,87H   ;EI,ZG16,Res
          E531 D38D             OUT     8DH
          E533 3E2F             LD      A,2FH   ;Vorton
          E535 D38D             OUT     8DH
          E537 FB               EI
          E538 57               LD      D,A     ;D=2Fh
          E539 5F               LD      E,A     ;E=2Fh
          E53A CD80E5   MBO1:   CALL    BITOUT
          E53D EDA1             CPI
          E53F EA3AE5           JP      PE,MBO1 ;BC mal
          E542 CD7EE5           CALL    ZTON    ;Trennzeichen
          E545 DD7E02           LD      A,(IX+2)
          E548 CD6BE5           CALL    BYTOT   ;Blocknummer
          E54B DD6E05           LD      L,(IX+5)
          E54E DD6606           LD      H,(IX+6)
          E551 0680             LD      B,80H
          E553 7E       BLKOT:  LD      A,M
          E554 CD6BE5           CALL    BYTOT   ;Datenbyte
          E557 79               LD      A,C
          E558 86               ADD     M       ;Pruefsumme
          E559 4F               LD      C,A     ;nebenher
          E55A 23               INC     HL
          E55B 10F6             DJNZ    BLKOT
          E55D CD6BE5           CALL    BYTOT   ;und ausgeben
          E560 7A               LD      A,D
          E561 CD83E5           CALL    HBITOT  ;noch ein
          E564 5D               LD      E,L     ;Knacks
          E565 54               LD      D,H
          E566 3E03             LD      A,3     ;CTC stoppen
          E568 D38D             OUT     8DH
          E56A C9               RET
          E56B
          E56B          BYTOT:  ;Ausgabe eines Bytes
          E56B C5               PUSH    BC
          E56C 4F               LD      C,A
          E56D 0608             LD      B,8
          E56F CB09     BYTOUT: RRC     C       ;mit Bit0
          E571 1E17             LD      E,17H   ;beginnend
          E573 D480E5           CALL    NC,BITOUT
          E576 1E2F             LD      E,2FH   ;Zeitkonstanten
          E578 DC80E5           CALL    C,BITOUT
          E57B 10F2             DJNZ    BYTOUT  ;8*
          E57D C1               POP     BC
          E57E 1E5D     ZTON:   LD      E,5DH   ;ZK Trennz.
          E580 CD83E5   BITOUT: CALL    HBITOT  ;Aufrufen und
          E583 DD7200   HBITOT: LD      (IX),D  ;reinlaufen
          E586 DD7E00   HBIT1:  LD      A,(IX)  ;Warten auf
          E589 A7               AND     A       ;Interrupt
          E58A 20FA             JR      NZ,HBIT1
          E58C 53               LD      D,E
          E58D C9               RET
          E58E
          E58E          ISRI:   ;Init. Bandeingabe       **0A**
          E58E CDB4E4           CALL    ISRI1
          E591                  ;
          E591          MBI:    ;Einlesen 1 Block        **05**
          E591 3E83             LD      A,83H   ;EI
          E593 D38A             OUT     8AH     ;an PIO A
          E595 E5               PUSH    HL
          E596 D5               PUSH    DE
          E597 0616     MBI1:   LD      B,16H
          E599 DD360D00         LD      (IX+13),0 ;Pruefsumme=0
          E59D CD1AE6   MBI2:   CALL    STOP1
          E5A0 38F5             JR      C,MBI1
          E5A2 FEBA             CP      0BAH
          E5A4 CDEDE5           CALL    LEDOO
          E5A7 38EE             JR      C,MBI1  ;16h korrekte
          E5A9 10F2             DJNZ    MBI2    ;Schwingungen
          E5AB 0602     MBI3:   LD      B,2     ;erkennen
          E5AD AF       MBI4:   XOR     A
          E5AE 4F               LD      C,A
          E5AF DD7700           LD      (IX),A
          E5B2 CD2DE6           CALL    STOP21  ;2 halbe Trenn-
          E5B5 FE5D             CP      5DH     ;zeichen er-
          E5B7 30F2             JR      NC,MBI3 ;kennen
          E5B9 10F2             DJNZ    MBI4
          E5BB CD39E6           CALL    BYTIN   ;Blocknummer
          E5BE 3825             JR      C,MBI5  ;Stoerung
          E5C0 DD7702           LD      (IX+2),A
          E5C3 0680             LD      B,80H
          E5C5 DD6E05           LD      L,(IX+5)
          E5C8 DD6606           LD      H,(IX+6)
          E5CB CD39E6   BLKIN:  CALL    BYTIN   ;Datenbyte
          E5CE 3815             JR      C,MBI5  ;Stoerung
          E5D0 77               LD      M,A
          E5D1 DD7E0D           LD      A,(IX+13)
          E5D4 86               ADD     M       ;aufsummieren
          E5D5 DD770D           LD      (IX+13),A
          E5D8 23               INC     HL
          E5D9 10F0             DJNZ    BLKIN
          E5DB CD39E6           CALL    BYTIN   ;Pruefsumme
          E5DE 3805             JR      C,MBI5  ;Stoerung
          E5E0 DD960D           SUB     (IX+13) ;gleich?
          E5E3 C6FF             ADD     0FFH    ;CY:=/Z
          E5E5 D1       MBI5:   POP     DE
          E5E6 E1               POP     HL
          E5E7 F3               DI
          E5E8 3E03             LD      A,3     ;DI an PIO A
          E5EA D38A             OUT     8AH
          E5EC FB               EI
          E5ED DB88     LEDOO:  IN      A,88H   ;LED ein/aus
          E5EF CBEF             SET     5,A     ;je nach CY
          E5F1 3002             JR      NC,MBI6
          E5F3 CBAF             RES     5,A
          E5F5 D388     MBI6:   OUT     88H
          E5F7 C9               RET
          E5F8
          E5F8          ISRC1:  ;ISR CTC Kanal 1 (Kassette-Out)
          E5F8 F5               PUSH    AF
          E5F9 3E87             LD      A,87H
          E5FB D38D             OUT     8DH
          E5FD DD7E00           LD      A,(IX)  ;Uergabezelle
          E600 D38D             OUT     8DH
          E602 DD360000         LD      (IX),0  ;Quittierung
          E606 180E             JR      ISR1E
          E608
          E608          ISRPA:  ;ISR PIO Kanal A (Kassette-In)
          E608 F5               PUSH    AF
          E609 DB8E             IN      A,8EH
          E60B DD7700           LD      (IX),A  ;Uebergabezelle
          E60E 3E07             LD      A,7
          E610 D38E             OUT     8EH
          E612 3EA3             LD      A,0A3H
          E614 D38E             OUT     8EH
          E616 F1       ISR1E:  POP     AF
          E617 FB       INTEND: EI
          E618 ED4D             RETI
          E61A
          E61A DD360000 STOP1:  LD      (IX),0  ;1 Bit einlesen
          E61E DB88     STOP11: IN      A,88H   ;PIO-Logik
          E620 D388             OUT     88H     ;freigeben
          E622 DD7E00           LD      A,(IX)  ;Warten auf
          E625 B7               OR      A       ;Interrupt
          E626 28F6             JR      Z,STOP11
          E628 4F               LD      C,A
          E629 DD360000         LD      (IX),0
          E62D DB88     STOP21: IN      A,88H   ;dto.
          E62F D388             OUT     88H,A
          E631 DD7E00           LD      A,(IX)
          E634 B7               OR      A
          E635 28F6             JR      Z,STOP21
          E637 81               ADD     C       ;beide 'Zeiten'
          E638 C9               RET             ;addieren
          E639
          E639          BYTIN:  ;Einlesen eines Bytes
          E639                  ;PA: A:Byte, CY=1: Stoerung
          E639 110008           LD      DE,800H
          E63C CD1AE6   TRN1:   CALL    STOP1
          E63F 3803             JR      C,TRN2
          E641 FEBA             CP      0BAH    ;zu intolerant
          E643 D8               RET     C
          E644 3F       TRN2:   CCF
          E645 CB1B             RR      E       ;Bit einschieben
          E647 15               DEC     D
          E648 20F2             JR      NZ,TRN1 ;8*
          E64A CD1AE6           CALL    STOP1   ;Trennzeichen
          E64D 7B               LD      A,E     ;mit CY-
          E64E C9               RET             ;Rueckmeldung
          E64F
          E64F          ;BASIC:
          E64F
          E64F          BEXP1:  ;BASIC-Exp 1
          E64F 78               LD      A,B
          E650 D609             SUB     9
          E652 384F             JR      C,SNERR1
          E654 FE1B             CP      27
          E656 304B             JR      NC,SNERR1       ;>26
          E658 07               RLCA            ;*2
          E659 4F               LD      C,A
          E65A 0600             LD      B,0
          E65C EB               EX      DE,HL
          E65D 21BAFD           LD      HL,TOKJP+8
          E660 C3B7C8           JP      0C8B7H  ;Ruecksprung
          E663
          E663          BEXP2:  ;BASIC-Exp 2
          E663 7E               LD      A,M
          E664 FEDF             CP      0DFH
          E666 D8               RET     C               ;<DFH
          E667 FEE3             CP      0E3H
          E669 D0               RET     NC              ;>E2H
          E66A FEE1             CP      0E1H    ;AT?
          E66C CA97EA           JP      Z,PRAT
          E66F 3AFD03           LD      A,(3FDH)
          E672 A7               AND     A       ;PRINT-Erw.?
          E673 202E             JR      NZ,SNERR1
          E675 3C               INC     A
          E676 32FD03           LD      (3FDH),A
          E679 E5       PREX1:  PUSH    HL
          E67A 21A3B7           LD      HL,COLOR
          E67D CD95EC           CALL    IRMRD
          E680 E1               POP     HL
          E681 327E03           LD      (37EH),A ;Farbe merken
          E684 7E               LD      A,M
          E685 FEDF             CP      0DFH    ;INK?
          E687 281D             JR      Z,PRINK
          E689 FEE2             CP      0E2H    ;COLOR?
          E68B CA9BE6           JP      Z,PRCOL
          E68E CDBDC8           CALL    0C8BDH
          E691 CD14EB           CALL    PAPER
          E694 7E       PREX2:  LD      A,M
          E695 FE3B             CP      ';'
          E697 283D             JR      Z,PREX5
          E699 1808             JR      SNERR1
          E69B
          E69B CDBDC8   PRCOL:  CALL    0C8BDH
          E69E CD30EB           CALL    BCOLOR
          E6A1 18F1             JR      PREX2
          E6A3
          E6A3 C348C3   SNERR1: JP      0C348H  ;SN-ERROR
          E6A6
          E6A6 CDBDC8   PRINK:  CALL    0C8BDH
          E6A9 CDFAEA           CALL    INK
          E6AC 7E               LD      A,M
          E6AD FE3B             CP      ';'
          E6AF 2825             JR      Z,PREX5
          E6B1 CDCCC8           CALL    0C8CCH  ;Komma?
          E6B4 2C               DB      ','
          E6B5 FEE0             CP      0E0H    ;PAPER?
          E6B7 20EA             JR      NZ,SNERR1
          E6B9 CDBDC8           CALL    0C8BDH
          E6BC CD14EB           CALL    PAPER
          E6BF CDCCC8           CALL    0C8CCH
          E6C2 3B               DB      ';'
          E6C3 CD03CB   PREX3:  CALL    0CB03H
          E6C6 3A7E03           LD      A,(37EH)  ;Farbe
          E6C9 E5               PUSH    HL
          E6CA 21A3B7           LD      HL,COLOR
          E6CD CD91EC           CALL    IRMWR     ;eintragen
          E6D0 E1               POP     HL
          E6D1 C1               POP     BC
          E6D2 C9               RET
          E6D3 C5       PREX4:  PUSH    BC
          E6D4 18A3             JR      PREX1
          E6D6 CDBDC8   PREX5:  CALL    0C8BDH
          E6D9 18E8             JR      PREX3
          E6DB
          E6DB          BEXP3:  ;BASIC-Exp 3
          E6DB 79               LD      A,C
          E6DC FE62             CP      62H
          E6DE CA4BEA           JP      Z,VPEEK
          E6E1 FE6E             CP      6EH
          E6E3 CAC3EC           JP      Z,PTEST
          E6E6 FE7C             CP      7CH
          E6E8 CAA1ED           JP      Z,CSRLN
          E6EB FE76             CP      76H
          E6ED CAC4ED           JP      Z,VGET
          E6F0 D63E             SUB     3EH
          E6F2 38AF             JR      C,SNERR1
          E6F4 FE07             CP      7
          E6F6 30AB             JR      NC,SNERR1
          E6F8 EB               EX      DE,HL
          E6F9 01B2FD           LD      BC,TOKJP ;Tokentab.
          E6FC E1               POP     HL
          E6FD 6F               LD      L,A
          E6FE 09               ADD     HL,BC
          E6FF 4E               LD      C,M
          E700 23               INC     HL
          E701 66               LD      H,M
          E702 69               LD      L,C
          E703 E5               PUSH    HL      ;Routine
          E704 EB               EX      DE,HL   ;anspringen
          E705 C9               RET
          E706
          E706          STRING: ;String vervielfaeltigen
          E706 CDCCC8           CALL    0C8CCH
          E709 28               DB      '('     ;Klammer auf?
          E70A CD21D4           CALL    0D421H
          E70D F5               PUSH    AF
          E70E CDD6C8           CALL    0C8D6H  ;Komma?
          E711 CD3ACD           CALL    0CD3AH
          E714 CDDBC8           CALL    0C8DBH  ;Klammer zu?
          E717 F1               POP     AF
          E718 E5               PUSH    HL
          E719 F5               PUSH    AF
          E71A CD30D3           CALL    0D330H
          E71D 23               INC     HL
          E71E 23               INC     HL
          E71F 5E               LD      E,M
          E720 23               INC     HL
          E721 56               LD      D,M
          E722 C1               POP     BC
          E723 C5               PUSH    BC
          E724 F5               PUSH    AF
          E725 D5               PUSH    DE
          E726 4F               LD      C,A
          E727 AF               XOR     A
          E728 B9               CP      C
          E729 280C             JR      Z,STR2
          E72B B8               CP      B
          E72C 2809             JR      Z,STR2
          E72E 79               LD      A,C
          E72F 05               DEC     B
          E730 2805             JR      Z,STR2
          E732 81       STR1:   ADD     C
          E733 382B             JR      C,STR5
          E735 10FB             DJNZ    STR1
          E737 47       STR2:   LD      B,A
          E738 0E00             LD      C,0
          E73A C5               PUSH    BC
          E73B CDE1D1           CALL    0D1E1H  ;Str.-Arithm.
          E73E C1               POP     BC
          E73F C1               POP     BC
          E740 C5               PUSH    BC
          E741 CD7ED1           CALL    0D17EH
          E744 E1               POP     HL
          E745 E3               EX      (SP),HL
          E746 7C               LD      A,H
          E747 E1               POP     HL
          E748 E3               EX      (SP),HL
          E749 6F               LD      L,A
          E74A 24               INC     H
          E74B 25       STR3:   DEC     H
          E74C E5               PUSH    HL
          E74D C5               PUSH    BC
          E74E 2807             JR      Z,STR4
          E750 CDF2D2           CALL    0D2F2H
          E753 C1               POP     BC
          E754 E1               POP     HL
          E755 18F4             JR      STR3
          E757 C1       STR4:   POP     BC
          E758 E1               POP     HL
          E759 D1               POP     DE
          E75A CD02D3           CALL    0D302H
          E75D C3A9D1           JP      0D1A9H
          E760 1E1C     STR5:   LD      E,1CH   ;ST-
          E762 C356C3           JP      0C356H  ;ERROR
          E765
          E765          RENUM:  ;neu nummerieren
          E765 E5               PUSH    HL
          E766 210A00           LD      HL,10
          E769 225403           LD      (354H),HL       ;DISTAN
          E76C 2A5F03           LD      HL,(35FH)       ;Start
          E76F F5               PUSH    AF
          E770 E5               PUSH    HL
          E771 23               INC     HL
          E772 23               INC     HL
          E773 7E               LD      A,M
          E774 23               INC     HL
          E775 66               LD      H,M
          E776 6F               LD      L,A
          E777 224E03           LD      (34EH),HL       ;ZL-Nr
          E77A 225203           LD      (352H),HL       ;NANF
          E77D ED5BD703         LD      DE,(3D7H)       ;Ende
          E781 1B               DEC     DE
          E782 1B               DEC     DE
          E783 E1       REN1:   POP     HL
          E784 E5               PUSH    HL
          E785 7E               LD      A,M
          E786 23               INC     HL
          E787 66               LD      H,M
          E788 6F               LD      L,A
          E789 CD89C6           CALL    0C689H
          E78C E3               EX      (SP),HL
          E78D 20F4             JR      NZ,REN1
          E78F D1               POP     DE
          E790 23               INC     HL
          E791 23               INC     HL
          E792 7E               LD      A,M
          E793 23               INC     HL
          E794 66               LD      H,M
          E795 6F               LD      L,A
          E796 225003           LD      (350H),HL ;ZL-Abst.
          E799 0604             LD      B,4
          E79B F1               POP     AF
          E79C 214E03           LD      HL,34EH
          E79F E3               EX      (SP),HL
          E7A0 2820     REN2:   JR      Z,REN5
          E7A2 CD86C9           CALL    0C986H
          E7A5 F5               PUSH    AF
          E7A6 7A               LD      A,D
          E7A7 B3               OR      E
          E7A8 CA67C9   REN3:   JP      Z,0C967H  ;FC-ERROR
          E7AB F1               POP     AF
          E7AC E3               EX      (SP),HL
          E7AD 73               LD      M,E
          E7AE 23               INC     HL
          E7AF 72               LD      M,D
          E7B0 23               INC     HL
          E7B1 280F             JR      Z,REN5
          E7B3 F5               PUSH    AF
          E7B4 05               DEC     B
          E7B5 2807             JR      Z,REN4
          E7B7 F1               POP     AF
          E7B8 E3               EX      (SP),HL
          E7B9 CDD6C8           CALL    0C8D6H  ;Komma?
          E7BC 18E2             JR      REN2
          E7BE F1       REN4:   POP     AF
          E7BF C269EA           JP      NZ,SNERR2
          E7C2 2A5003   REN5:   LD      HL,(350H)
          E7C5 ED5B4E03         LD      DE,(34EH)
          E7C9 CD89C6           CALL    0C689H
          E7CC DA67C9   REN6:   JP      C,0C967H
          E7CF 2A5F03           LD      HL,(35FH)
          E7D2 CDBEC4   REN7:   CALL    0C4BEH
          E7D5 3804             JR      C,REN8
          E7D7 28CF             JR      Z,REN3
          E7D9 18F7             JR      REN7
          E7DB E1       REN8:   POP     HL
          E7DC C5               PUSH    BC
          E7DD ED5B5003         LD      DE,(350H)
          E7E1 210000           LD      HL,0
          E7E4 225003           LD      (350H),HL
          E7E7 60       REN9:   LD      H,B
          E7E8 69               LD      L,C
          E7E9 4E               LD      C,M
          E7EA 23               INC     HL
          E7EB 46               LD      B,M
          E7EC 78               LD      A,B
          E7ED B1               OR      C
          E7EE 28B8             JR      Z,REN3
          E7F0 23               INC     HL
          E7F1 7E               LD      A,M
          E7F2 23               INC     HL
          E7F3 66               LD      H,M
          E7F4 6F               LD      L,A
          E7F5 CD89C6           CALL    0C689H
          E7F8 2A5003           LD      HL,(350H)
          E7FB 23               INC     HL
          E7FC 225003           LD      (350H),HL
          E7FF 20E6             JR      NZ,REN9
          E801 23               INC     HL
          E802 23               INC     HL
          E803 29               ADD     HL,HL
          E804 23               INC     HL
          E805 ED5BD703         LD      DE,(3D7H)
          E809 19               ADD     HL,DE
          E80A 38C0             JR      C,REN6
          E80C CD27C3           CALL    0C327H  ;genug RAM?
          E80F 22D703           LD      (3D7H),HL
          E812 AF               XOR     A
          E813 2B               DEC     HL
          E814 77               LD      M,A
          E815 2B               DEC     HL
          E816 77               LD      M,A
          E817 1B               DEC     DE
          E818 1B               DEC     DE
          E819 EB               EX      DE,HL
          E81A 73               LD      M,E
          E81B 23               INC     HL
          E81C 72               LD      M,D
          E81D 23               INC     HL
          E81E 3D               DEC     A
          E81F 77               LD      M,A
          E820 23               INC     HL
          E821 77               LD      M,A
          E822 23               INC     HL
          E823 EB               EX      DE,HL
          E824 2A5203           LD      HL,(352H)
          E827 224E03           LD      (34EH),HL
          E82A E1       REN10:  POP     HL
          E82B 4E               LD      C,M
          E82C 23               INC     HL
          E82D 46               LD      B,M
          E82E 23               INC     HL
          E82F C5               PUSH    BC
          E830 014E03           LD      BC,34EH
          E833 7E               LD      A,M
          E834 12               LD      (DE),A
          E835 0A               LD      A,(BC)
          E836 77               LD      M,A
          E837 23               INC     HL
          E838 13               INC     DE
          E839 03               INC     BC
          E83A 7E               LD      A,M
          E83B 12               LD      (DE),A
          E83C 0A               LD      A,(BC)
          E83D 77               LD      M,A
          E83E 13               INC     DE
          E83F 2A4E03           LD      HL,(34EH)
          E842 ED4B5403         LD      BC,(354H)
          E846 09               ADD     HL,BC
          E847 224E03           LD      (34EH),HL
          E84A 2A5003           LD      HL,(350H)
          E84D 2B               DEC     HL
          E84E 7C               LD      A,H
          E84F B5               OR      L
          E850 225003           LD      (350H),HL
          E853 20D5             JR      NZ,REN10
          E855 12               LD      (DE),A
          E856 E1               POP     HL
          E857 2A5F03           LD      HL,(35FH)
          E85A E5               PUSH    HL
          E85B E1       REN11:  POP     HL
          E85C 4E               LD      C,M
          E85D 23               INC     HL
          E85E 46               LD      B,M
          E85F 23               INC     HL
          E860 C5               PUSH    BC
          E861 7E               LD      A,M
          E862 23               INC     HL
          E863 A6               AND     M
          E864 3C               INC     A
          E865 2826             JR      Z,REN15
          E867 23       REN12:  INC     HL
          E868 7E       REN13:  LD      A,M
          E869 B7               OR      A
          E86A 28EF             JR      Z,REN11
          E86C FE88             CP      88H     ;GOTO
          E86E 282A             JR      Z,REN16
          E870 FE8C             CP      8CH     ;GOSUB
          E872 2826             JR      Z,REN16
          E874 FE8B             CP      8BH     ;RESTORE
          E876 2808             JR      Z,REN14
          E878 FED4             CP      0D4H    ;ELSE
          E87A 2804             JR      Z,REN14
          E87C FEA9             CP      0A9H    ;THEN
          E87E 20E7             JR      NZ,REN12
          E880 CD87C9   REN14:  CALL    0C987H
          E883 7B               LD      A,E
          E884 B2               OR      D
          E885 C4AEE8           CALL    NZ,RENUP1
          E888 C4E0E8           CALL    NZ,RENUP2
          E88B 18DB             JR      REN13
          E88D 2B       REN15:  DEC     HL
          E88E 22D703           LD      (3D7H),HL
          E891 2B               DEC     HL
          E892 77               LD      M,A
          E893 2B               DEC     HL
          E894 77               LD      M,A
          E895 E1               POP     HL
          E896 E1               POP     HL
          E897 C38AC4           JP      0C48AH
          E89A CD87C9   REN16:  CALL    0C987H
          E89D 7B               LD      A,E
          E89E B2               OR      D
          E89F 28C7             JR      Z,REN13
          E8A1 CDAEE8           CALL    RENUP1
          E8A4 C4E0E8           CALL    NZ,RENUP2
          E8A7 7E               LD      A,M
          E8A8 FE2C             CP      2CH
          E8AA 20BC             JR      NZ,REN13
          E8AC 18EC             JR      REN16
          E8AE
          E8AE E5       RENUP1: PUSH    HL
          E8AF D5               PUSH    DE
          E8B0 11FFFF           LD      DE,-1
          E8B3 CDBBC4           CALL    0C4BBH  ;naechste Zeile
          E8B6 D1               POP     DE
          E8B7 03               INC     BC
          E8B8 03               INC     BC
          E8B9 03               INC     BC
          E8BA 03               INC     BC
          E8BB 60               LD      H,B
          E8BC 69               LD      L,C
          E8BD ED4B5203         LD      BC,(352H)
          E8C1 7E       RUP11:  LD      A,M
          E8C2 23               INC     HL
          E8C3 E5               PUSH    HL
          E8C4 B6               OR      M
          E8C5 2816             JR      Z,RUP13
          E8C7 7E               LD      A,M
          E8C8 2B               DEC     HL
          E8C9 6E               LD      L,M
          E8CA 67               LD      H,A
          E8CB CD89C6           CALL    0C689H
          E8CE 280A             JR      Z,RUP12
          E8D0 2A5403           LD      HL,(354H)
          E8D3 09               ADD     HL,BC
          E8D4 44               LD      B,H
          E8D5 4D               LD      C,L
          E8D6 E1               POP     HL
          E8D7 23               INC     HL
          E8D8 18E7             JR      RUP11
          E8DA 3EFF     RUP12:  LD      A,0FFH
          E8DC B7               OR      A
          E8DD E1       RUP13:  POP     HL
          E8DE E1               POP     HL
          E8DF C9               RET
          E8E0
          E8E0 C5       RENUP2: PUSH    BC
          E8E1 EB               EX      DE,HL
          E8E2 2AD703           LD      HL,(3D7H)
          E8E5 ED52             SBC     HL,DE
          E8E7 E5               PUSH    HL
          E8E8 C1       RUP21:  POP     BC
          E8E9 62               LD      H,D
          E8EA 6B               LD      L,E
          E8EB 1B               DEC     DE
          E8EC 1A               LD      A,(DE)
          E8ED FE2C             CP      ','
          E8EF 280B             JR      Z,RUP22
          E8F1 FE3A             CP      ':'
          E8F3 3007             JR      NC,RUP22
          E8F5 C5               PUSH    BC
          E8F6 D5               PUSH    DE
          E8F7 EDB0             LDIR
          E8F9 D1               POP     DE
          E8FA 18EC             JR      RUP21
          E8FC EB       RUP22:  EX      DE,HL
          E8FD D1               POP     DE
          E8FE E5               PUSH    HL
          E8FF C5               PUSH    BC
          E900 AF               XOR     A
          E901 0698             LD      B,98H
          E903 CDAED6           CALL    0D6AEH
          E906 CD34D8           CALL    0D834H
          E909 C1               POP     BC
          E90A D1               POP     DE
          E90B 23               INC     HL
          E90C 13               INC     DE
          E90D 7E       RUP23:  LD      A,M
          E90E B7               OR      A
          E90F 280F             JR      Z,RUP24
          E911 C5               PUSH    BC
          E912 E5               PUSH    HL
          E913 EB               EX      DE,HL
          E914 09               ADD     HL,BC
          E915 54               LD      D,H
          E916 5D               LD      E,L
          E917 2B               DEC     HL
          E918 EDB8             LDDR
          E91A E1               POP     HL
          E91B EDA0             LDI
          E91D C1               POP     BC
          E91E 18ED             JR      RUP23
          E920 D5       RUP24:  PUSH    DE
          E921 ED5B5F03         LD      DE,(35FH)
          E925 CD93C4           CALL    0C493H
          E928 23       RUP25:  INC     HL
          E929 7E               LD      A,M
          E92A 23               INC     HL
          E92B B6               OR      M
          E92C 20FA             JR      NZ,RUP25
          E92E EB               EX      DE,HL
          E92F 73               LD      M,E
          E930 23               INC     HL
          E931 72               LD      M,D
          E932 13               INC     DE
          E933 13               INC     DE
          E934 ED53D703         LD      (3D7H),DE
          E938 E1               POP     HL
          E939 54               LD      D,H
          E93A 5D               LD      E,L
          E93B 7E       RUP26:  LD      A,M
          E93C B7               OR      A
          E93D 23               INC     HL
          E93E 20FB             JR      NZ,RUP26
          E940 C1               POP     BC
          E941 E3               EX      (SP),HL
          E942 C5               PUSH    BC
          E943 EB               EX      DE,HL
          E944 C9               RET
          E945
          E945          DELETE: ;Zeile(n) loeschen
          E945 C8               RET     Z
          E946 CD86C9           CALL    0C986H
          E949 CA42C4           JP      Z,0C442H
          E94C CDD6C8           CALL    0C8D6H
          E94F D5               PUSH    DE
          E950 CD86C9           CALL    0C986H
          E953 E1               POP     HL
          E954 C0               RET     NZ
          E955 EB               EX      DE,HL
          E956 E5               PUSH    HL
          E957 CDBBC4           CALL    0C4BBH  ;naechste Zeile
          E95A D24DC4           JP      NC,0C44DH ;UL-ERROR
          E95D D1               POP     DE
          E95E F5               PUSH    AF
          E95F C5               PUSH    BC
          E960 CDBEC4           CALL    0C4BEH
          E963 D24DC4           JP      NC,0C44DH ;UL-ERROR
          E966 C1               POP     BC
          E967 C350C4           JP      0C450H  ;einsortieren
          E96A
          E96A          PAUSE:  ;Programm unterbrechen
          E96A CDBEC8           CALL    0C8BEH
          E96D 200F             JR      NZ,PAUS2
          E96F CDCAE3   PAUS1:  CALL    KBDS
          E972 30FB             JR      NC,PAUS1
          E974 FE03             CP      3       ;BRK?
          E976 C8               RET     Z
          E977 FE0A             CP      0AH     ;CUU?
          E979 20F4             JR      NZ,PAUS1
          E97B C3E4DD           JP      0DDE4H  ;Eingabe ASCII
          E97E CD21D4   PAUS2:  CALL    0D421H
          E981 4F               LD      C,A
          E982 3E10     PAUS3:  LD      A,10H   ;96 sek.
          E984 1E14             LD      E,14H   ;WAIT
          E986 CD15F0           CALL    0F015H  ;PV5
          E989 C5               PUSH    BC
          E98A CDCAE3           CALL    KBDS
          E98D C1               POP     BC
          E98E 300A             JR      NC,PAUS4
          E990 FE03             CP      3       ;BRK?
          E992 C8               RET     Z
          E993 FE0A             CP      0AH     ;CUU?
          E995 2003             JR      NZ,PAUS4
          E997 C3E4DD           JP      0DDE4H  ;Eingabe ASCII
          E99A 0D       PAUS4:  DEC     C
          E99B 20E5             JR      NZ,PAUS3
          E99D C9               RET
          E99E
          E99E          BBEEP:  ;Signalton
          E99E 0601             LD      B,1     ;ohne Angabe 1x
          E9A0 CDBEC8           CALL    0C8BEH
          E9A3 2804             JR      Z,BBP1
          E9A5 CD21D4           CALL    0D421H
          E9A8 47               LD      B,A     ;Anzahl
          E9A9 3E07     BBP1:   LD      A,7     ;Beep
          E9AB 1E00             LD      E,0     ;CRT
          E9AD CD15F0           CALL    0F015H  ;PV5
          E9B0 10F7             DJNZ    BBP1
          E9B2 C9               RET
          E9B3
          E9B3          WINDOW: ;Fenster einstellen
          E9B3 CDBEC8           CALL    0C8BEH
          E9B6 2865             JR      Z,WINDOW1
          E9B8 E5               PUSH    HL
          E9B9 CD21D4           CALL    0D421H
          E9BC E3               EX      (SP),HL     ;in
          E9BD 21F6B9           LD      HL,WNDFN+90 ;Fenster 9
          E9C0 CD91EC           CALL    IRMWR       ;erstellen
          E9C3 23               INC     HL
          E9C4 E3               EX      (SP),HL
          E9C5 CDD6C8           CALL    0C8D6H
          E9C8 CD21D4           CALL    0D421H
          E9CB E3               EX      (SP),HL
          E9CC CD91EC           CALL    IRMWR
          E9CF 23               INC     HL
          E9D0 E3               EX      (SP),HL
          E9D1 CDD6C8           CALL    0C8D6H
          E9D4 CD21D4           CALL    0D421H
          E9D7 E3               EX      (SP),HL
          E9D8 CD91EC           CALL    IRMWR
          E9DB E3               EX      (SP),HL
          E9DC CDD6C8           CALL    0C8D6H
          E9DF CD21D4           CALL    0D421H
          E9E2 E3               EX      (SP),HL
          E9E3 57               LD      D,A
          E9E4 CD18F0           CALL    0F018H  ;IRMON
          E9E7 FE28             CP      28H
          E9E9 304D             JR      NC,WINERR
          E9EB 3AF8B9           LD      A,(WNDFN+92)
          E9EE 5F               LD      E,A
          E9EF FE28             CP      28H
          E9F1 3045             JR      NC,WINERR
          E9F3 7A               LD      A,D
          E9F4 93               SUB     E
          E9F5 3841             JR      C,WINERR
          E9F7 3C               INC     A
          E9F8 329EB7           LD      (WINLG),A
          E9FB 7B               LD      A,E
          E9FC 329CB7           LD      (WINON),A
          E9FF 3AF7B9           LD      A,(WNDFN+91)
          EA02 FE20             CP      20H
          EA04 3032             JR      NC,WINERR
          EA06 57               LD      D,A
          EA07 3AF6B9           LD      A,(WNDFN+90)
          EA0A FE20             CP      20H
          EA0C 302A             JR      NC,WINERR
          EA0E 5F               LD      E,A
          EA0F 7A               LD      A,D
          EA10 93               SUB     E
          EA11 3825             JR      C,WINERR
          EA13 3C               INC     A
          EA14 329FB7           LD      (WINLG+1),A
          EA17 7B               LD      A,E
          EA18 329DB7           LD      (WINON+1),A
          EA1B 1810             JR      WINDOW2
          EA1D E5       WINDOW1 PUSH    HL
          EA1E CD18F0           CALL    0F018H  ;IRMON
          EA21 210001           LD      HL,100H
          EA24 229CB7           LD      (WINON),HL
          EA27 21281E           LD      HL,1E28H
          EA2A 229EB7           LD      (WINLG),HL
          EA2D 210000   WINDOW2 LD      HL,0
          EA30 22A0B7           LD      (CURSO),HL
          EA33 CD1BF0           CALL    0F01BH  ;IRMOF
          EA36 E1               POP     HL
          EA37 C9               RET
          EA38 CD1BF0   WINERR: CALL    0F01BH  ;IRMOF
          EA3B 182C             JR      SNERR2
          EA3D
          EA3D          BLOAD:  ;MC-Programm laden
          EA3D E5               PUSH    HL
          EA3E 2181B7           LD      HL,ARGN
          EA41 AF               XOR     A
          EA42 CD91EC           CALL    IRMWR   ;ARGN=0
          EA45 E1               POP     HL
          EA46 1E10             LD      E,10H   ;LOAD
          EA48 C315F0           JP      0F015H  ;PV5
          EA4B
          EA4B CDE1CD   VPEEK:  CALL    0CDE1H
          EA4E E3               EX      (SP),HL
          EA4F 11F3CD           LD      DE,0CDF3H ;RET-Adr.
          EA52 D5               PUSH    DE
          EA53 CD6FC9           CALL    0C96FH
          EA56 E5               PUSH    HL
          EA57 210080           LD      HL,8000H;IRM-Offset
          EA5A 19               ADD     HL,DE
          EA5B 3803             JR      C,VPK   ;Error
          EA5D 3EBF             LD      A,0BFH
          EA5F BC               CP      H
          EA60 3807     VPK:    JR      C,SNERR2
          EA62 CD95EC           CALL    IRMRD
          EA65 E1               POP     HL
          EA66 C3E9D3           JP      0D3E9H
          EA69
          EA69 C348C3   SNERR2: JP      0C348H  ;SN-ERROR
          EA6C
          EA6C          VPOKE:  ;in IRM schreiben
          EA6C CD6CC9           CALL    0C96CH
          EA6F D5               PUSH    DE
          EA70 CDD6C8           CALL    0C8D6H
          EA73 CD21D4           CALL    0D421H
          EA76 E3               EX      (SP),HL
          EA77 110080           LD      DE,8000H;IRM-Offset
          EA7A 19               ADD     HL,DE
          EA7B 38E3             JR      C,VPK   ;Error
          EA7D 57               LD      D,A
          EA7E 3EBF             LD      A,0BFH
          EA80 BC               CP      H
          EA81 38DD             JR      C,VPK   ;nur bis BFFFH
          EA83 7A               LD      A,D
          EA84 CD91EC           CALL    IRMWR   ;schreiben
          EA87 E1               POP     HL
          EA88 C9               RET
          EA89
          EA89          BORDER: ;schaltet RAM-8!
          EA89 CD21D4           CALL    0D421H
          EA8C 0F               RRCA
          EA8D 0F               RRCA
          EA8E 0F               RRCA
          EA8F E660             AND     60H     ;Auswahl
          EA91 4F               LD      C,A
          EA92 069F             LD      B,9FH   ;Maske
          EA94 C353F9           JP      TONB
          EA97
          EA97          PRAT:   ;PRINT AT
          EA97 3AFD03           LD      A,(3FDH)
          EA9A CB4F             BIT     1,A
          EA9C CBCF             SET     1,A
          EA9E 32FD03           LD      (3FDH),A
          EAA1 20C6             JR      NZ,SNERR2
          EAA3 D5               PUSH    DE
          EAA4 E5               PUSH    HL
          EAA5 CD18F0           CALL    0F018H  ;IRMON
          EAA8 219CB7           LD      HL,WINON
          EAAB 22F6B9           LD      (WNDFN+90),HL
          EAAE 11ECB9           LD      DE,WNDFN+80
          EAB1 010600           LD      BC,6    ;Fenster
          EAB4 EDB0             LDIR            ;retten
          EAB6 210000           LD      HL,0    ;Fenster gross
          EAB9 229CB7           LD      (WINON),HL
          EABC 212820           LD      HL,2028H
          EABF 229EB7           LD      (WINLG),HL
          EAC2 CD1BF0           CALL    0F01BH  ;IRMOF
          EAC5 E1               POP     HL
          EAC6 CD42EB           CALL    LOCAT
          EAC9 CDDBC8           CALL    0C8DBH
          EACC CDCCC8           CALL    0C8CCH
          EACF 3B               DB      ';'
          EAD0 7E               LD      A,M
          EAD1 FEDF             CP      0DFH
          EAD3 381D             JR      C,PRAT2 ;<DFH
          EAD5 FEE3             CP      0E3H
          EAD7 3019             JR      NC,PRAT2;>E2H
          EAD9 CDD3E6           CALL    PREX4   ;INK,PAPER,COLOR
          EADC E5       PRAT1:  PUSH    HL
          EADD CD18F0           CALL    0F018H  ;IRMON
          EAE0 21ECB9           LD      HL,WNDFN+80
          EAE3 119CB7           LD      DE,WINON
          EAE6 010600           LD      BC,6    ;Fenster
          EAE9 EDB0             LDIR            ;regenerieren
          EAEB CD1BF0           CALL    0F01BH  ;IRMOF
          EAEE E1               POP     HL
          EAEF D1               POP     DE
          EAF0 C1               POP     BC
          EAF1 C9               RET
          EAF2 CD03CB   PRAT2:  CALL    0CB03H
          EAF5 18E5             JR      PRAT1
          EAF7
          EAF7 C348C3   SNERR3: JP      0C348H  ;SN-ERROR
          EAFA
          EAFA CD21D4   INK:    CALL    0D421H
          EAFD FE20             CP      32
          EAFF 30F6             JR      NC,SNERR3
          EB01 CB27             SLA     A
          EB03 CB27             SLA     A
          EB05 CB27             SLA     A
          EB07 57               LD      D,A
          EB08 E5               PUSH    HL
          EB09 21A3B7           LD      HL,COLOR
          EB0C CD95EC           CALL    IRMRD
          EB0F E1               POP     HL
          EB10 E607             AND     7
          EB12 1812             JR      COL2
          EB14
          EB14 CD21D4   PAPER:  CALL    0D421H
          EB17 FE08     COL1:   CP      8
          EB19 30DC             JR      NC,SNERR3
          EB1B 57               LD      D,A
          EB1C E5               PUSH    HL
          EB1D 21A3B7           LD      HL,COLOR
          EB20 CD95EC           CALL    IRMRD
          EB23 E1               POP     HL
          EB24 E6F8             AND     0F8H
          EB26 B2       COL2:   OR      D
          EB27 E5               PUSH    HL
          EB28 21A3B7           LD      HL,COLOR
          EB2B CD91EC           CALL    IRMWR   ;neuer Farbwert
          EB2E E1               POP     HL
          EB2F C9               RET
          EB30
          EB30 CDBEC8   BCOLOR: CALL    0C8BEH
          EB33 28C2             JR      Z,SNERR3
          EB35 CDFAEA           CALL    INK     ;Vordergrund
          EB38 CDBEC8           CALL    0C8BEH
          EB3B C8               RET     Z
          EB3C CDD6C8           CALL    0C8D6H
          EB3F 18D3             JR      PAPER   ;Hintergrund
          EB41 C9               RET
          EB42
          EB42          LOCAT:  ;Cursor positionieren
          EB42 CDBDC8           CALL    0C8BDH
          EB45 CDCCC8           CALL    0C8CCH
          EB48 28               DB      '('
          EB49 CD21D4   LOCATE: CALL    0D421H
          EB4C 57               LD      D,A
          EB4D E5               PUSH    HL
          EB4E 219FB7           LD      HL,WINLG+1
          EB51 CD95EC           CALL    IRMRD
          EB54 E1               POP     HL
          EB55 3D               DEC     A
          EB56 BA               CP      D
          EB57 389E             JR      C,SNERR3
          EB59 CDD6C8           CALL    0C8D6H
          EB5C D5               PUSH    DE
          EB5D CD21D4           CALL    0D421H
          EB60 D1               POP     DE
          EB61 4F               LD      C,A
          EB62 E5               PUSH    HL
          EB63 219EB7           LD      HL,WINLG
          EB66 CD95EC           CALL    IRMRD
          EB69 E1               POP     HL
          EB6A 3D               DEC     A
          EB6B B9               CP      C
          EB6C 3889             JR      C,SNERR3
          EB6E 79               LD      A,C
          EB6F E5               PUSH    HL
          EB70 21A0B7           LD      HL,CURSO
          EB73 CD91EC           CALL    IRMWR
          EB76 7A               LD      A,D
          EB77 23               INC     HL
          EB78 CD91EC   LOC1:   CALL    IRMWR
          EB7B E1               POP     HL
          EB7C C9               RET
          EB7D
          EB7D          INKEY:  ;Eingabe ein Zeichen
          EB7D E5               PUSH    HL
          EB7E CDCAE3           CALL    KBDS
          EB81 300F             JR      NC,INKEY3
          EB83 3E01             LD      A,1
          EB85 CD7BD1           CALL    0D17BH
          EB88 CDE4DD           CALL    0DDE4H  ;Eingabe ASCII
          EB8B 2AC203   INKEY1: LD      HL,(3C2H)
          EB8E 77               LD      M,A
          EB8F C3A9D1   INKEY2: JP      0D1A9H
          EB92 AF       INKEY3: XOR     A
          EB93 CD7BD1           CALL    0D17BH
          EB96 18F7             JR      INKEY2
          EB98
          EB98          SOUND:  ;Tonausgabe
          EB98 CD21D4           CALL    0D421H
          EB9B E5               PUSH    HL
          EB9C 2182B7           LD      HL,ARG1
          EB9F 0604             LD      B,4     ;4 Argumente
          EBA1 CD91EC   SOUND1: CALL    IRMWR
          EBA4 23               INC     HL
          EBA5 E3               EX      (SP),HL
          EBA6 05               DEC     B
          EBA7 280B             JR      Z,SOUND2
          EBA9 C5               PUSH    BC
          EBAA CDD6C8           CALL    0C8D6H
          EBAD CD21D4           CALL    0D421H
          EBB0 C1               POP     BC
          EBB1 E3               EX      (SP),HL
          EBB2 18ED             JR      SOUND1
          EBB4 CDBEC8   SOUND2: CALL    0C8BEH
          EBB7 281C             JR      Z,SOUND3
          EBB9 CDD6C8           CALL    0C8D6H
          EBBC CD21D4           CALL    0D421H
          EBBF E3               EX      (SP),HL
          EBC0 CD91EC           CALL    IRMWR
          EBC3 23               INC     HL
          EBC4 E3               EX      (SP),HL
          EBC5 CDBEC8           CALL    0C8BEH
          EBC8 280B             JR      Z,SOUND3
          EBCA CDD6C8           CALL    0C8D6H
          EBCD CD21D4           CALL    0D421H
          EBD0 E3               EX      (SP),HL
          EBD1 CD91EC           CALL    IRMWR
          EBD4 E3               EX      (SP),HL
          EBD5 1E35     SOUND3: LD      E,35H   ;TON
          EBD7 C1               POP     BC
          EBD8 C315F0           JP      0F015H  ;PV5
          EBDB
          EBDB          PSET:   ;Punkt setzen
          EBDB 0601             LD      B,1     ;setzen
          EBDD C5       POINT:  PUSH    BC
          EBDE CD6CC9           CALL    0C96CH	;Parameter erfassen
          EBE1 E5               PUSH    HL	;Adresszeiger
          EBE2 7B               LD      A,E
          EBE3 21D3B7           LD      HL,HOR
          EBE6 CD91EC           CALL    IRMWR	;X-Koordinate (low)
          EBE9 7A               LD      A,D
          EBEA 23               INC     HL
          EBEB CD91EC           CALL    IRMWR	;X-Koordinate (high)
          EBEE E3               EX      (SP),HL
          EBEF CDD6C8           CALL    0C8D6H
          EBF2 CD21D4           CALL    0D421H
          EBF5 E3               EX      (SP),HL
          EBF6 23               INC     HL	;HL=VERT
          EBF7 CD91EC           CALL    IRMWR	;Y-Koordinate
          EBFA E1               POP     HL
          EBFB CD10EC           CALL    GFARB	;optional Grafikfarbe
          EBFE 1E30             LD      E,30H   ;PUSE
          EC00 C1               POP     BC
          EC01 05               DEC     B
          EC02 2801             JR      Z,POINT2
          EC04 1D               DEC     E       ;PUDE
          EC05 CD15F0   POINT2: CALL    0F015H  ;PV1
          EC08 DA69EA           JP      C,SNERR2
          EC0B C9               RET
          EC0C
          EC0C          PRESET: ;Punkt loeschen
          EC0C 0600             LD      B,0     ;loeschen
          EC0E 18CD             JR      POINT
          EC10
          EC10 CDBEC8   GFARB:  CALL    0C8BEH
          EC13 C8               RET     Z
          EC14 CDD6C8           CALL    0C8D6H
          EC17 CD21D4           CALL    0D421H
          EC1A E5               PUSH    HL
          EC1B 21D6B7           LD      HL,FARB ;Grafik-Farbe
          EC1E 17               RLA
          EC1F 17               RLA
          EC20 17               RLA
          EC21 C378EB           JP      LOC1    ;in IRM schreib.
          EC24
          EC24          INSTR:  ;String1 in String2 suchen
          EC24 CD36CD           CALL    0CD36H  ;Klammer auf?
          EC27 CDD6C8           CALL    0C8D6H
          EC2A E5               PUSH    HL
          EC2B CD30D3           CALL    0D330H
          EC2E 2838             JR      Z,INSTR4
          EC30 47               LD      B,A
          EC31 23               INC     HL
          EC32 23               INC     HL
          EC33 5E               LD      E,M
          EC34 23               INC     HL
          EC35 56               LD      D,M
          EC36 E1               POP     HL
          EC37 D5               PUSH    DE
          EC38 C5               PUSH    BC
          EC39 CD3ACD           CALL    0CD3AH
          EC3C CDDBC8           CALL    0C8DBH  ;Klammer zu?
          EC3F C1               POP     BC
          EC40 D1               POP     DE
          EC41 E5               PUSH    HL
          EC42 D5               PUSH    DE
          EC43 C5               PUSH    BC
          EC44 CD30D3           CALL    0D330H
          EC47 281F             JR      Z,INSTR4
          EC49 23               INC     HL
          EC4A 23               INC     HL
          EC4B 4E               LD      C,M
          EC4C 23               INC     HL
          EC4D 66               LD      H,M
          EC4E 69               LD      L,C
          EC4F C1               POP     BC
          EC50 4F               LD      C,A
          EC51 D1               POP     DE
          EC52 E5               PUSH    HL
          EC53 C5       INSTR0: PUSH    BC
          EC54 D5               PUSH    DE
          EC55 1A               LD      A,(DE)
          EC56 BE       INSTR1: CP      M
          EC57 2812             JR      Z,INSTR5
          EC59 23               INC     HL
          EC5A 0D               DEC     C
          EC5B 20F9             JR      NZ,INSTR1
          EC5D AF       INSTR2: XOR     A
          EC5E E1               POP     HL
          EC5F E1               POP     HL
          EC60 E1               POP     HL
          EC61 11F3CD   INSTR3: LD      DE,0CDF3H ;RET-Adr.
          EC64 D5               PUSH    DE
          EC65 C3C0D0           JP      0D0C0H
          EC68 C367C9   INSTR4: JP      0C967H  ;FC-ERROR
          EC6B 23       INSTR5: INC     HL
          EC6C E5               PUSH    HL
          EC6D 2B               DEC     HL
          EC6E 23       INSTR6: INC     HL
          EC6F 0D               DEC     C
          EC70 280E             JR      Z,INSTR7
          EC72 13               INC     DE
          EC73 05               DEC     B
          EC74 2811             JR      Z,INSTR8
          EC76 1A               LD      A,(DE)
          EC77 BE               CP      M
          EC78 28F4             JR      Z,INSTR6
          EC7A E1               POP     HL
          EC7B D1               POP     DE
          EC7C C1               POP     BC
          EC7D 0D               DEC     C
          EC7E 18D3             JR      INSTR0
          EC80 13       INSTR7: INC     DE
          EC81 05               DEC     B
          EC82 E1               POP     HL
          EC83 20D8             JR      NZ,INSTR2
          EC85 1801             JR      INSTR9
          EC87 E1       INSTR8: POP     HL
          EC88 D1       INSTR9: POP     DE
          EC89 D1               POP     DE
          EC8A D1               POP     DE
          EC8B A7               AND     A
          EC8C ED52             SBC     HL,DE
          EC8E 7D               LD      A,L
          EC8F 18D0             JR      INSTR3
          EC91
          EC91 1E28     IRMWR:  LD      E,28H   ;LDMA
          EC93 1810             JR      JPV5
          EC95
          EC95 1E29     IRMRD:  LD      E,29H   ;LDAM
          EC97 180C             JR      JPV5
          EC99
          EC99          BKEY:   ;F-Taste belegen
          EC99 CD21D4           CALL    0D421H
          EC9C A7               AND     A
          EC9D 2856             JR      Z,SNERR4
          EC9F FE0D             CP      0DH     ;F1...F12
          ECA1 3052             JR      NC,SNERR4
          ECA3 1E39             LD      E,39H   ;KEY
          ECA5 C315F0   JPV5:   JP      0F015H  ;PV5
          ECA8
          ECA8          KEYLIST: ;F-Tasten auflisten
          ECA8 1E3A             LD      E,3AH   ;KEYLI
          ECAA 18F9             JR      JPV5
          ECAC
          ECAC          SWITCH: ;Module schalten
          ECAC CD21D4           CALL    0D421H
          ECAF F5               PUSH    AF
          ECB0 CDD6C8           CALL    0C8D6H
          ECB3 CD21D4           CALL    0D421H
          ECB6 57               LD      D,A     ;Steuerbyte
          ECB7 F1               POP     AF
          ECB8 E5               PUSH    HL
          ECB9 6F               LD      L,A     ;Steckplatz
          ECBA 3E02             LD      A,2     ;schalten
          ECBC 1E26             LD      E,26H   ;MODU
          ECBE CD15F0           CALL    0F015H  ;PV5
          ECC1 E1               POP     HL
          ECC2 C9               RET
          ECC3
          ECC3 CDE1CD   PTEST:  CALL    0CDE1H
          ECC6 E3               EX      (SP),HL
          ECC7 11F3CD           LD      DE,0CDF3H ;RET-Adr.
          ECCA D5               PUSH    DE
          ECCB CD6FC9           CALL    0C96FH
          ECCE E5               PUSH    HL
          ECCF 7B               LD      A,E     ;nur
          ECD0 21D3B7           LD      HL,HOR  ;X-Koordinate
          ECD3 CD91EC           CALL    IRMWR   ;eintragen
          ECD6 7A               LD      A,D
          ECD7 23               INC     HL
          ECD8 CD91EC           CALL    IRMWR
          ECDB 1E2F             LD      E,2FH   ;PUDE
          ECDD CD15F0           CALL    0F015H  ;PV5
          ECE0 0600             LD      B,0
          ECE2 280C             JR      Z,PTST1 ;war geloescht
          ECE4 23               INC     HL
          ECE5 23               INC     HL
          ECE6 CD91EC           CALL    IRMWR
          ECE9 1E30             LD      E,30H   ;PUSE
          ECEB CD15F0           CALL    0F015H  ;PV5
          ECEE 0601             LD      B,1
          ECF0 78       PTST1:  LD      A,B     ;Rueckgabewert
          ECF1 E1               POP     HL
          ECF2 C3E9D3           JP      0D3E9H
          ECF5
          ECF5 C348C3   SNERR4: JP      0C348H  ;SN-ERROR
          ECF8
          ECF8          CLOSE:  ;Kanal schliessen
          ECF8 0E00             LD      C,0
          ECFA 7E               LD      A,M
          ECFB FE49             CP      'I'     ;Eingabe?
          ECFD 2805             JR      Z,CLOS1
          ECFF 0C               INC     C
          ED00 FE4F             CP      'O'     ;Ausgabe?
          ED02 20F1             JR      NZ,SNERR4
          ED04 C5       CLOS1:  PUSH    BC
          ED05 23               INC     HL
          ED06 7E               LD      A,M
          ED07 FE23             CP      '#'
          ED09 20EA     CLOS2:  JR      NZ,SNERR4
          ED0B 23               INC     HL
          ED0C CD21D4           CALL    0D421H
          ED0F E603             AND     3       ;4 Geraete
          ED11 C1               POP     BC
          ED12 C8               RET     Z       ;Console
          ED13 E5               PUSH    HL
          ED14 17               RLA             ;*2
          ED15 81               ADD     C       ;Ein-/Ausgabe
          ED16 F5               PUSH    AF
          ED17 3D               DEC     A
          ED18 0600             LD      B,0
          ED1A 37               SCF
          ED1B CB10     CLOS3:  RL      B       ;Bit platzieren
          ED1D 3D               DEC     A
          ED1E 20FB             JR      NZ,CLOS3
          ED20 210703           LD      HL,307H ;E/A-Flag
          ED23 7E               LD      A,M
          ED24 A8               XOR     B       ;negieren
          ED25 77               LD      M,A
          ED26 F1               POP     AF
          ED27 E1               POP     HL
          ED28 CBF7             SET     6,A     ;close
          ED2A D5               PUSH    DE
          ED2B 5F               LD      E,A
          ED2C 1603             LD      D,3
          ED2E CD0EE0           CALL    BASIO
          ED31 D1               POP     DE
          ED32 C9               RET
          ED33
          ED33          RANDOM: ;Zufallsgenerator
          ED33 ED5F             LD      A,R
          ED35 321D03           LD      (31DH),A
          ED38 C9               RET
          ED39
          ED39          OPEN:   ;Kanal oeffnen
          ED39 7E               LD      A,M
          ED3A 23               INC     HL
          ED3B FE49             CP      'I'     ;Eingabe?
          ED3D 2819             JR      Z,OPEN1
          ED3F FE4F             CP      'O'     ;Ausgabe?
          ED41 20C6             JR      NZ,CLOS2
          ED43 CD25DE           CALL    0DE25H
          ED46 CDC8DD           CALL    0DDC8H
          ED49 C8               RET     Z
          ED4A 3ED5             LD      A,0D5H
          ED4C CDB2DC           CALL    0DCB2H
          ED4F 21EA03           LD      HL,3EAH ;Druckpuffer
          ED52 AF               XOR     A
          ED53 CDD5DD           CALL    0DDD5H
          ED56 E1               POP     HL
          ED57 C9               RET
          ED58 CD5FDE   OPEN1:  CALL    0DE5FH  ;Eingabe
          ED5B 3A0903           LD      A,(309H);IN-Index
          ED5E E603             AND     3
          ED60 C8               RET     Z
          ED61 3ED5             LD      A,0D5H
          ED63 CDB2DC           CALL    0DCB2H
          ED66 21EA03           LD      HL,3EAH ;Druckuffer
          ED69 CDE4DD           CALL    0DDE4H  ;Eingabe ASCII
          ED6C E1               POP     HL
          ED6D C9               RET
          ED6E
          ED6E          BLINE:  ;Linie zeichnen
          ED6E 013E04           LD      BC,43EH ;4 Par.,LINE
          ED71 1803             JR      GRAPH
          ED73
          ED73          CIRCLE: ;Kreis zeichnen
          ED73 013F03           LD      BC,33FH ;3 Par.,CIRCLE
          ED76 C5       GRAPH:  PUSH    BC
          ED77 CD6CC9           CALL    0C96CH
          ED7A C1               POP     BC
          ED7B C5               PUSH    BC
          ED7C E5               PUSH    HL
          ED7D 2182B7           LD      HL,ARG1
          ED80 7B       GRAPH1: LD      A,E
          ED81 CD91EC           CALL    IRMWR
          ED84 23               INC     HL
          ED85 7A               LD      A,D
          ED86 CD91EC           CALL    IRMWR
          ED89 23               INC     HL
          ED8A 05               DEC     B
          ED8B 280C             JR      Z,GRAPH2
          ED8D E3               EX      (SP),HL
          ED8E C5               PUSH    BC
          ED8F CDD6C8           CALL    0C8D6H
          ED92 CD6CC9           CALL    0C96CH
          ED95 C1               POP     BC
          ED96 E3               EX      (SP),HL
          ED97 18E7             JR      GRAPH1
          ED99 E1       GRAPH2: POP     HL
          ED9A CD10EC           CALL    GFARB
          ED9D D1               POP     DE
          ED9E C315F0           JP      0F015H  ;PV5
          EDA1
          EDA1          CSRLN:  ;akt. Zeile holen
          EDA1 CDE1CD           CALL    0CDE1H
          EDA4 E3               EX      (SP),HL
          EDA5 11F3CD           LD      DE,0CDF3H ;RET-Adr.
          EDA8 D5               PUSH    DE
          EDA9 CD24D4           CALL    0D424H
          EDAC E5               PUSH    HL
          EDAD A7               AND     A
          EDAE 3E00             LD      A,0
          EDB0 2006             JR      NZ,CSRLN1
          EDB2 219DB7           LD      HL,WINON+1
          EDB5 CD95EC           CALL    IRMRD
          EDB8 47       CSRLN1: LD      B,A
          EDB9 21A1B7           LD      HL,CURSO+1
          EDBC CD95EC           CALL    IRMRD
          EDBF 80               ADD     B       ;akt. Zeile
          EDC0 E1               POP     HL
          EDC1 C3E9D3           JP      0D3E9H
          EDC4
          EDC4          VGET:   ;Zeichen von Bildschirm lesen
          EDC4 E3               EX      (SP),HL
          EDC5 3E01             LD      A,1
          EDC7 CD7BD1           CALL    0D17BH
          EDCA CD18F0           CALL    0F018H  ;IRMON
          EDCD ED5BA0B7         LD      DE,(CURSO)
          EDD1 CD6AE0           CALL    DABR
          EDD4 7E               LD      A,M
          EDD5 CD1BF0           CALL    0F01BH  ;IRMOF
          EDD8 C38BEB           JP      INKEY1  ;als Zeichen
          EDDB                                  ;zurueckgeben
          EDDB
          EDDB          ESCTAB: ;ESC-Tabelle
          EDDB 9AE1             DW      ESC0    ;Tabulator
          EDDD 6EF9             DW      ESC1    ;Anz0   Zugr0
          EDDF 7FF9             DW      ESC2    ;1      1
          EDE1 8CF9             DW      ESC3    ;0      1
          EDE3 9BF9             DW      ESC4    ;1      0
          EDE5 8DF8             DW      ESC5    ;MODUL
          EDE7 9FF8             DW      ESC6    ;SYSTEM
          EDE9 AAF9             DW      ESC7    ;PixInvers o/o
          EDEB 0FE3             DW      ESC8    ;ColSwap o/o
          EDED B2F9             DW      ESC9    ;Farbebene o/o
          EDEF B9F9             DW      ESCA    ;HiRes o/o
          EDF1
          EDF1 00000000         DS      0FH     ;frei
          EE00
          EE00                  END

        Errors: 0000
        End+1 : EE00

          0200
          0200          ;**     CAOS 4.2 ROM F          **
          0200
          0200                  ORG     0F000H
          F000
          F000 C3BFF0           JP      PWRON
          F003 C347F0           JP      PV1     ;m. DEFB nr
          F006 C363F0           JP      PV2     ;(ARGC)=nr
          F009 C377F0           JP      PV3     ;E=nr
          F00C C333F0           JP      PV4     ;E=nr, IRM e/a
          F00F C3B0F0           JP      RCALL   ;m. DEFW offset
          F012 C3F6F0           JP      BYE     ;JUMP-Einsprung
          F015 C327F0           JP      PV5     ;E=nr
          F018 C37AF0           JP      IRMON
          F01B C399F0           JP      IRMOF
          F01E C5               PUSH    BC      ;PV6, (ARGC)=nr
          F01F CD7AF0           CALL    IRMON
          F022 CD63F0           CALL    PV2
          F025 1807             JR      PV51
          F027
          F027 C5       PV5:    PUSH    BC
          F028 CD7AF0           CALL    IRMON
          F02B CD77F0           CALL    PV3
          F02E CD99F0   PV51:   CALL    IRMOF
          F031 C1               POP     BC
          F032 C9               RET
          F033
          F033 F5       PV4:    PUSH    AF
          F034 DB88             IN      A,88H
          F036 CBD7             SET     2,A
          F038 D388             OUT     88H     ;IRM ein
          F03A F1               POP     AF
          F03B CD77F0           CALL    PV3
          F03E F5       SCROFF: PUSH    AF
          F03F DB88             IN      A,88H
          F041 CB97             RES     2,A
          F043 D388             OUT     88H     ;IRM aus
          F045 F1               POP     AF
          F046 C9               RET
          F047
          F047 F3       PV1:    DI
          F048 E5               PUSH    HL
          F049 E1               POP     HL
          F04A E1               POP     HL
          F04B 23               INC     HL      ;nr uebergehen
          F04C E5               PUSH    HL
          F04D 2B               DEC     HL      ;(HL)=nr
          F04E 3B               DEC     SP
          F04F 3B               DEC     SP
          F050 FB               EI
          F051 F5               PUSH    AF
          F052 D5               PUSH    DE
          F053 5E               LD      E,M
          F054 1600     PV22:   LD      D,0
          F056 2AB0B7           LD      HL,(SUTAB)
          F059 19               ADD     HL,DE
          F05A 19               ADD     HL,DE   ;HL=Pos. in Tab
          F05B 5E               LD      E,M
          F05C 23               INC     HL
          F05D 56               LD      D,M
          F05E EB               EX      DE,HL
          F05F D1               POP     DE
          F060 F1               POP     AF
          F061 E3       EXRT:   EX      (SP),HL
          F062 C9               RET             ;UP anspringen
          F063
          F063 A7       PV2:    AND     A       ;VR: F
          F064 E5       PV21:   PUSH    HL
          F065 D5               PUSH    DE
          F066 C5               PUSH    BC
          F067 E5               PUSH    HL
          F068 21BBF0           LD      HL,POPS3;Returnadresse
          F06B E3               EX      (SP),HL ;kellern
          F06C E5               PUSH    HL
          F06D F5               PUSH    AF
          F06E D5               PUSH    DE
          F06F 38E3             JR      C,PV22  ;falls PV3
          F071 3A80B7           LD      A,(ARGC);sonst E
          F074 5F               LD      E,A     ;beschaffen
          F075 18DD             JR      PV22
          F077
          F077 37       PV3:    SCF             ;VR: F
          F078 18EA             JR      PV21
          F07A
          F07A C1       IRMON:  POP     BC      ;Rueckkehradr.
          F07B FDE5             PUSH    IY
          F07D FD210000         LD      IY,0    ;SP in IY merken
          F081 FD39             ADD     IY,SP   ;(Kein UP ver-
          F083 F3               DI              ;aendert IY!)
          F084 DD770B           LD      (IX+11),A
          F087 DB88             IN      A,88H
          F089 CBD7             SET     2,A     ;IRM ein
          F08B CBEF             SET     5,A     ;LED ein
          F08D D388             OUT     88H
          F08F ED7BAEB7         LD      SP,(SYSP)
          F093 FB               EI
          F094 DD7E0B           LD      A,(IX+11)
          F097 C5               PUSH    BC
          F098 C9               RET             ;wie JP (BC)
          F099
          F099 C1       IRMOF:  POP     BC      ;analog IRMON
          F09A DD770B           LD      (IX+11),A
          F09D DB88             IN      A,88H
          F09F CB97             RES     2,A
          F0A1 CBAF             RES     5,A
          F0A3 F3               DI
          F0A4 D388             OUT     88H
          F0A6 FDF9             LD      SP,IY
          F0A8 FB               EI
          F0A9 DD7E0B           LD      A,(IX+11)
          F0AC FDE1             POP     IY
          F0AE C5               PUSH    BC
          F0AF C9               RET
          F0B0
          F0B0          RCALL:  ;Relativer UP-Aufruf
          F0B0 E3               EX      (SP),HL ;VR: DE
          F0B1 5E               LD      E,M
          F0B2 23               INC     HL
          F0B3 56               LD      D,M
          F0B4 23               INC     HL      ;DE=offset
          F0B5 EB               EX      DE,HL
          F0B6 19               ADD     HL,DE   ;zur Absolut-
          F0B7 EB               EX      DE,HL   ;adr. addieren
          F0B8 E3               EX      (SP),HL
          F0B9 D5               PUSH    DE
          F0BA C9               RET             ;wie JP (DE)
          F0BB
          F0BB C1       POPS3:  POP     BC      ;fuer PV2..6
          F0BC D1               POP     DE
          F0BD E1               POP     HL
          F0BE C9               RET
          F0BF
          F0BF          PWRON:  ;Einschalt-Init
          F0BF 31C401           LD      SP,1C4H
          F0C2 AF               XOR     A
          F0C3 47               LD      B,A
          F0C4 4F               LD      C,A
          F0C5 02       PWR1:   LD      (BC),A  ;Speicher
          F0C6 0D               DEC     C       ;loeschen
          F0C7 20FC             JR      NZ,PWR1
          F0C9 10FA             DJNZ    PWR1
          F0CB 0E80             LD      C,80H   ;Module
          F0CD ED79     PWR2:   OUT     (C),A   ;abschalten
          F0CF 10FC             DJNZ    PWR2
          F0D1 CDD0F3           CALL    SYSI    ;IRM-Init usw.
          F0D4 AF               XOR     A
          F0D5 329BB7   PWR3:   LD      (WINNR),A
          F0D8 CDBBF6           CALL    WCOPY   ;Fenstervektor-
          F0DB 3C               INC     A       ;speicher init.
          F0DC FE0A             CP      0AH
          F0DE 38F5             JR      C,PWR3
          F0E0 CD8CF9           CALL    ESC3
          F0E3 3E0C             LD      A,0CH   ;Zweitbild
          F0E5 CD29E3           CALL    CRT     ;loeschen
          F0E8 CD6EF9           CALL    ESC1
          F0EB CD61FB           CALL    CON     ;M003 suchen,
          F0EE CDD9C6           CALL    V24INI  ;einschalten,
          F0F1 CD6DFB           CALL    COFF    ;Tab. kopieren
          F0F4 1806             JR      PWR4
          F0F6
          F0F6          BYE:    ;Tasten-RESET und JUMP-Einsprung
          F0F6                  ;M003 wird bei RESET nicht
          F0F6                  ;erneut gesucht!
          F0F6
          F0F6 31C401           LD      SP,1C4H
          F0F9 CDD0F3           CALL    SYSI    ;IRM-Init usw.
          F0FC                  ;
          F0FC 3A00A8   PWR4:   LD      A,(0A800H)
          F0FF 3D               DEC     A       ;M003 vorh.?
          F100 200C             JR      NZ,PWR5
          F102 CD61FB           CALL    CON
          F105 CDD5C2           CALL    V24OC   ;Druckerinit
          F108 CDC3C6           CALL    UMINIT  ;SIO B fuer
          F10B CD6DFB           CALL    COFF    ;Interrupt
          F10E 018008   PWR5:   LD      BC,880H ;ROM-Modul mit
          F111 ED78             IN      A,(C)   ;Strukturbyte
          F113 3D               DEC     A       ;01?
          F114 201C             JR      NZ,MEN0 ;nein
          F116 3E43             LD      A,43H
          F118 ED79             OUT     (C),A   ;ein ab 4000H
          F11A 3208B8           LD      (0B808H),A
          F11D DD7E04           LD      A,(IX+4)
          F120 E6FC             AND     0FCH    ;RAM4 aus
          F122 DD7704           LD      (IX+4),A
          F125 D386             OUT     86H
          F127 C30040           JP      4000H   ;anspringen
          F12A
          F12A          ;
          F12A 7F7F             DW      7F7FH
          F12C 4D454E55         DB      'MENU',1
          F131 E1               POP     HL      ;Stack clear
          F132 CDEEF1   MEN0:   CALL    OSTR
          F135 0C0A             DB      0CH,0AH ;CLS,CUD
          F137 2A204B43         DB      '* KC-CAOS 4.2 *',0
          F147 2100C0   MENU:   LD      HL,0C000H       ;**46**
          F14A 4D               LD      C,L
          F14B 45               LD      B,L     ;BC=0
          F14C CD6BF3   MEN1:   CALL    CRLF
          F14F CDEEF1   MEN2:   CALL    OSTR
          F152 022500           DB      2,'%',0 ;CLLN,Prompt
          F155 CDDEE3           CALL    BRKT
          F158 3829             JR      C,LOOP3
          F15A DD7E09           LD      A,(IX+9)
          F15D EDB1     MEN3:   CPIR
          F15F E283F1           JP      PO,LOOP3;ausgesucht.
          F162 EDA1             CPI             ;2tes Mal?
          F164 20F7             JR      NZ,MEN3
          F166 7E       MEN4:   LD      A,M
          F167 FE02             CP      2       ;Epilog?
          F169 38E1             JR      C,MEN1
          F16B FE30             CP      30H     ;<30h?
          F16D 38E0             JR      C,MEN2
          F16F FE60             CP      60H     ;>60h, Kleinb.?
          F171 30DC             JR      NC,MEN2
          F173 CD1DF2           CALL    OCHR
          F176 23               INC     HL
          F177 0B               DEC     BC
          F178 18EC             JR      MEN4
          F17A
          F17A E1       LOOP1:  POP     HL
          F17B CD61F3   LOOP2:  CALL    ERRM
          F17E CDEEF1   LOOP:   CALL    OSTR            ;**12**
          F181 2500             DB      '%',0   ;Prompt
          F183 CD34F3   LOOP3:  CALL    INLIN
          F186 13               INC     DE      ;Zeichen danach
          F187 1A               LD      A,(DE)
          F188 FE20             CP      ' '
          F18A 28F2             JR      Z,LOOP
          F18C A7               AND     A
          F18D 28EF             JR      Z,LOOP
          F18F CDA9F1           CALL    MSUCH
          F192 30E7             JR      NC,LOOP2;nicht gef.
          F194 E5               PUSH    HL
          F195 CDC7F3           CALL    GARG    ;Argumente
          F198 38E0             JR      C,LOOP1
          F19A 217EF1           LD      HL,LOOP ;Rueckkehradr.
          F19D E3               EX      (SP),HL ;kellern
          F19E 7E               LD      A,M     ;A=Epilog
          F19F 23               INC     HL      ;uebergehen
          F1A0 E5               PUSH    HL
          F1A1 A7               AND     A
          F1A2 CDEBF4           CALL    LARG
          F1A5 C0               RET     NZ      ;A=1: nach (HL)
          F1A6 C33EF0           JP      SCROFF  ;A=0: IRM aus,
          F1A9                                  ;dann nach (HL)
          F1A9
          F1A9 2100C0   MSUCH:  LD      HL,0C000H
          F1AC 45               LD      B,L
          F1AD 4D               LD      C,L     ;BC=0
          F1AE DD7E09           LD      A,(IX+9)
          F1B1 EDB1     ZSUCH:  CPIR                    ;**1D**
          F1B3 37               SCF
          F1B4 3F               CCF
          F1B5 E0               RET     PO      ;nicht gef.
          F1B6 EDA1             CPI
          F1B8 20F7             JR      NZ,ZSUCH
          F1BA F5               PUSH    AF
          F1BB D5               PUSH    DE
          F1BC 1A       ZS1:    LD      A,(DE)
          F1BD 13               INC     DE
          F1BE FE21             CP      '!'     ;keine SPC und
          F1C0 3808             JR      C,ZS3   ;Steuerzeichen
          F1C2 EDA1             CPI
          F1C4 28F6             JR      Z,ZS1
          F1C6 D1       ZS2:    POP     DE
          F1C7 F1               POP     AF
          F1C8 18E7             JR      ZSUCH
          F1CA                  ;
          F1CA 7E       ZS3:    LD      A,M
          F1CB FE02             CP      2       ;Epilog?
          F1CD 3807             JR      C,ZS4
          F1CF FE20             CP      ' '
          F1D1 38F3             JR      C,ZS2
          F1D3 23               INC     HL
          F1D4 18F4             JR      ZS3
          F1D6                  ;
          F1D6 F1       ZS4:    POP     AF
          F1D7 F1               POP     AF
          F1D8 37               SCF
          F1D9 C9               RET             ;gefunden
          F1DA
          F1DA 3D       WTUP:   DEC     A       ;UP fuer WAIT
          F1DB C8               RET     Z
          F1DC F5               PUSH    AF
          F1DD F1               POP     AF
          F1DE 18FA             JR      WTUP
          F1E0
          F1E0 47       WAIT:   LD      B,A             ;**14**
          F1E1 AF               XOR     A
          F1E2 CDDAF1   WAIT1:  CALL    WTUP
          F1E5 10FB             DJNZ    WAIT1
          F1E7 C9               RET
          F1E8
          F1E8 DD7E02   BNROST: LD      A,(IX+2);Blocknummer u.
          F1EB CD76F3   AHOSTR: CALL    AHEX    ;RG A und folg.
          F1EE E3       OSTR:   EX      (SP),HL ;ZK      **23**
          F1EF 7E       OSTR1:  LD      A,M     ;ausgeben
          F1F0 23               INC     HL
          F1F1 A7               AND     A       ;bis 00-Byte
          F1F2 CA61F0           JP      Z,EXRT
          F1F5 CD1DF2           CALL    OCHR
          F1F8 18F5             JR      OSTR1
          F1FA
          F1FA CD0AF2   NORM:   CALL    NIN             ;**13**
          F1FD 21A0FB   NOUT:   LD      HL,ZEI0         ;**20**
          F200 E5       SOUT:   PUSH    HL              ;**1E**
          F201 2AB9B7           LD      HL,(OUTAB)
          F204 E3               EX      (SP),HL
          F205 22B9B7           LD      (OUTAB),HL
          F208 E1               POP     HL
          F209 C9               RET
          F20A
          F20A 21A4FB   NIN:    LD      HL,ZEI4         ;**21**
          F20D E5       SIN:    PUSH    HL              ;**1F**
          F20E 2ABBB7           LD      HL,(INTAB)
          F211 E3               EX      (SP),HL
          F212 22BBB7           LD      (INTAB),HL
          F215 E1               POP     HL
          F216 C9               RET
          F217
          F217 E5       INTB:   PUSH    HL              ;**16**
          F218 2ABBB7           LD      HL,(INTAB)
          F21B 1804             JR      INTA1
          F21D E5       OCHR:   PUSH    HL              ;**24**
          F21E 2AB9B7           LD      HL,(OUTAB)
          F221 D5       INTA1:  PUSH    DE      ;s.a. PV1
          F222 C5               PUSH    BC      ;(sehr aehnlich)
          F223 5E               LD      E,M
          F224 1600             LD      D,0
          F226 2AB0B7           LD      HL,(SUTAB)
          F229 F5               PUSH    AF
          F22A 19               ADD     HL,DE
          F22B 19               ADD     HL,DE
          F22C F1               POP     AF
          F22D 5E               LD      E,M
          F22E 23               INC     HL
          F22F 56               LD      D,M
          F230 EB               EX      DE,HL
          F231 CD99E1           CALL    JPHL
          F234 C1       POP3:   POP     BC
          F235 D1               POP     DE
          F236 E1               POP     HL
          F237 C9               RET
          F238
          F238 E5       KBD:    PUSH    HL              ;**04**
          F239 D5               PUSH    DE
          F23A C5               PUSH    BC
          F23B DDCB0876 KBD1:   BIT     6,(IX+8);F-Taste aktiv?
          F23F 2076             JR      NZ,KBD12;ja
          F241 ED5BA0B7 KBD2:   LD      DE,(CURSO)
          F245 CD6AE0           CALL    DABR
          F248 AF               XOR     A       ;Dummy
          F249 BE               CP      M       ;hinter Cursor?
          F24A 2813             JR      Z,KBD5  ;ja-Strich
          F24C 5F               LD      E,A     ;nein-Klotz,E=0
          F24D CD4AF7   KBD3:   CALL    CUCP    ;blinken
          F250 1C               INC     E       ;Klotz e/a-Merk
          F251 060F             LD      B,0FH   ;F00h mal
          F253 CDD5E3   KBD4:   CALL    KBDZ    ;abfragen
          F256 381B             JR      C,KBD7
          F258 0B               DEC     BC
          F259 78               LD      A,B
          F25A B1               OR      C
          F25B 20F6             JR      NZ,KBD4
          F25D 18EE             JR      KBD3    ;dann Cursor
          F25F                                  ;wieder weg usw
          F25F CD40E0   KBD5:   CALL    PADR0
          F262 CBCD             SET     1,L     ;vorletzte
          F264 CBD5             SET     2,L     ;Cursorzeile
          F266 7E               LD      A,M
          F267 47               LD      B,A     ;merken
          F268 EE7F             XOR     7FH
          F26A 77               LD      M,A
          F26B CDD5E3   KBD6:   CALL    KBDZ    ;abfragen
          F26E 30FB             JR      NC,KBD6
          F270 70               LD      M,B     ;ruecksetzen
          F271 1805             JR      KBD8
          F273
          F273 CB43     KBD7:   BIT     0,E     ;Klotz gerade
          F275                                  ;ein?
          F275 C44AF7           CALL    NZ,CUCP ;ja - wegnehmen
          F278 57       KBD8:   LD      D,A
          F279 DDCB086E         BIT     5,(IX+8);Click ein?
          F27D 010703           LD      BC,307H
          F280 C405E3           CALL    NZ,CLIK
          F283 7A               LD      A,D
          F284 21A2B7           LD      HL,STBT
          F287 CB66             BIT     4,M     ;ESC aktiv?
          F289 280D             JR      Z,KBD9
          F28B ED5BA0B7         LD      DE,(CURSO)
          F28F CD63E1           CALL    CRT1
          F292 ED53A0B7         LD      (CURSO),DE
          F296 18A9             JR      KBD2
          F298
          F298 FE1B     KBD9:   CP      1BH     ;ESC?
          F29A 2004             JR      NZ,KBD10
          F29C CBE6             SET     4,M     ;ja
          F29E 18A1             JR      KBD2
          F2A0
          F2A0 FEF1     KBD10:  CP      0F1H    ;F-Taste?
          F2A2 3890             JR      C,POP3
          F2A4 DDCB08F6         SET     6,(IX+8);ja - merken
          F2A8 E60F             AND     0FH
          F2AA 47               LD      B,A
          F2AB 2100B9           LD      HL,0B900H
          F2AE 7E       KBD11:  LD      A,M     ;Pos. in F-
          F2AF A7               AND     A       ;Puffer best.
          F2B0 23               INC     HL
          F2B1 20FB             JR      NZ,KBD11
          F2B3 10F9             DJNZ    KBD11
          F2B5 1808             JR      KBD13
          F2B7
          F2B7 CDDEE3   KBD12:  CALL    BRKT    ;Abbruch?
          F2BA 381B             JR      C,KBD15
          F2BC 2AD1B7           LD      HL,(FTAST);Zeiger auf
          F2BF 7E       KBD13:  LD      A,M     ;naechstes CHR
          F2C0 FE1B             CP      1BH     ;ESC?
          F2C2 200C             JR      NZ,KBD14
          F2C4 23               INC     HL
          F2C5 22D1B7           LD      (FTAST),HL
          F2C8 21A2B7           LD      HL,STBT
          F2CB CBE6             SET     4,M     ;ESC merken
          F2CD C33BF2           JP      KBD1
          F2D0
          F2D0 23       KBD14:  INC     HL
          F2D1 22D1B7           LD      (FTAST),HL;Zeiger rett.
          F2D4 A7               AND     A       ;Null-Ende?
          F2D5 2007             JR      NZ,KBD16
          F2D7 DDCB08B6 KBD15:  RES     6,(IX+8);ja - inaktiv
          F2DB C341F2           JP      KBD2
          F2DE
          F2DE 21A2B7   KBD16:  LD      HL,STBT
          F2E1 CB66             BIT     4,M
          F2E3 CA34F2           JP      Z,POP3
          F2E6 ED5BA0B7         LD      DE,(CURSO)
          F2EA CD63E1           CALL    CRT1    ;ESC-Seq. ausf.
          F2ED ED53A0B7         LD      (CURSO),DE
          F2F1 C33BF2           JP      KBD1
          F2F4
          F2F4          KCTAB:  ;IRM-Defaulttabelle
          F2F4 22E3             DW      NOT     ;Hardcopy
          F2F6 00               DB      0       ;WINNR
          F2F7 0000             DW      0       ;WINON
          F2F9 2820             DW      2028H   ;WINLG
          F2FB 0000             DW      0       ;CURSO
          F2FD 00               DB      0       ;STBT
          F2FE 39               DB      39H     ;COLOR
          F2FF 60E2             DW      SCRLPG  ;WEND
          F301 00EE             DW      0EE00H  ;CCTL0
          F303 00FE             DW      0FE00H  ;1
          F305 00EE             DW      0EE00H  ;2
          F307 00FE             DW      0FE00H  ;3
          F309 C401             DW      1C4H    ;SYSP
          F30B A8FB             DW      SUTB    ;SUTAB
          F30D C8FC             DW      CRTTAB  ;CTAB
          F30F D388             OUT     88H     ;BJUMP
          F311 C312F0           JP      0F012H
          F314 A0FB             DW      ZEI0    ;OUTAB
          F316 A4FB             DW      ZEI4    ;INTAB
          F318 C353F3           JP      NOOP    ;UOUT1
          F31B C353F3           JP      NOOP    ;UIN1
          F31E C353F3           JP      NOOP    ;UOUT2
          F321 C353F3           JP      NOOP    ;UIN2
          F324 82DC             DW      0DC82H  ;IOERR (BASIC)
          F326 00B2             DW      0B200H  ;VRAM
          F328
          F328 DBED             DW      ESCTAB  ;L3TAB
          F32A 0B               DB      11      ;L3SIZ
          F32B 05               DB      5       ;COUNT
          F32C 00               DB      0       ;HCPZ
          F32D 01A8             DW      0A801H  ;INTV1
          F32F 08               DB      8       ;INTV1L
          F330 09A8             DW      0A809H  ;INTV2
          F332 09               DB      9       ;INTV2L
          F333 06               DB      6       ;HCPZ2
          F334
          F334 CD17F2   INLIN:  CALL    INTB            ;**17**
          F337 CD1DF2           CALL    OCHR
          F33A FE0D             CP      0DH     ;ENTER?
          F33C 20F6             JR      NZ,INLIN
          F33E CD6BF3           CALL    CRLF    ;PA: A=0
          F341 ED5BA0B7         LD      DE,(CURSO)
          F345 BA               CP      D       ;1 Zeile durch
          F346                                  ;PAGE-Mode?
          F346 2004             JR      NZ,INLI1
          F348 3A9FB7           LD      A,(WINLG+1)
          F34B 57               LD      D,A     ;D korrigieren
          F34C 15       INLI1:  DEC     D       ;Zeile drueber
          F34D E5               PUSH    HL
          F34E CD6AE0           CALL    DABR
          F351 EB               EX      DE,HL
          F352 E1               POP     HL      ;PA: DE
          F353 C9       NOOP:   RET
          F354
          F354 7C       HLHX:   LD      A,H             ;**1A**
          F355 CD76F3           CALL    AHEX
          F358 7D               LD      A,L
          F359 CD76F3   AHSPC:  CALL    AHEX
          F35C 3E20     SPACE:  LD      A,20H           ;**2B**
          F35E C31DF2   SPAC0:  JP      OCHR
          F361
          F361 CDEEF1   ERRM:   CALL    OSTR            ;**17**
          F364 4552524F         DB      'ERROR',7,0
          F36B                  ;
          F36B CDEEF1   CRLF:   CALL    OSTR            ;**2C**
          F36E 0D0A00           DB      0DH,0AH,0
          F371 C9               RET
          F372
          F372 3E10     HOME:   LD      A,10H           ;**2D**
          F374 18E8             JR      SPAC0
          F376
          F376 F5       AHEX:   PUSH    AF              ;**1C**
          F377 1F               RRA             ;Tetradentausch
          F378 1F               RRA
          F379 1F               RRA
          F37A 1F               RRA
          F37B CD7FF3           CALL    AHEX0   ;erst rufen,
          F37E F1               POP     AF      ;dann hinein-
          F37F                                  ;laufen
          F37F E60F     AHEX0:  AND     0FH     ;Maske
          F381 C690             ADD     90H     ;_bliche
          F383 27               DAA             ;Routine
          F384 CE40             ADC     40H     ;fuer die
          F386 27               DAA             ;Hexausgabe
          F387 18D5             JR      SPAC0
          F389
          F389 CD8CF3   HLDE:   CALL    HLDE1           ;**1B**
          F38C CD54F3   HLDE1:  CALL    HLHX
          F38F EB               EX      DE,HL
          F390 C9               RET
          F391
          F391 13       RHEX0:  INC     DE
          F392 1A       RHEX:   LD      A,(DE)          ;**18**
          F393 FE20             CP      ' '     ;Trennzeichen
          F395 28FA             JR      Z,RHEX0 ;uebergehen
          F397 AF               XOR     A
          F398 2198B7           LD      HL,NUMVX+1
          F39B 77               LD      M,A
          F39C 2B               DEC     HL      ;HL=NUMVX
          F39D 77               LD      M,A
          F39E 2B               DEC     HL      ;HL=NUMNX
          F39F 77               LD      M,A     ;alles nullsetz
          F3A0 1A       RH1:    LD      A,(DE)
          F3A1 B7               OR      A       ;Ende-Dummy?
          F3A2 C8               RET     Z
          F3A3 FE20             CP      ' '     ;Ende-Space?
          F3A5 C8               RET     Z
          F3A6 D630             SUB     '0'
          F3A8 D8               RET     C
          F3A9 FE0A             CP      0AH
          F3AB 380B             JR      C,RH2
          F3AD D607             SUB     7
          F3AF E6DF             AND     0DFH    ;Klein>Gross
          F3B1 FE0A             CP      0AH
          F3B3 D8               RET     C
          F3B4 FE10             CP      10H
          F3B6 3F               CCF
          F3B7 D8               RET     C
          F3B8 13       RH2:    INC     DE
          F3B9 34               INC     M       ;NUMNX erhoehen
          F3BA 23               INC     HL
          F3BB ED6F             RLD             ;Tetrade
          F3BD 23               INC     HL      ;durchschieben
          F3BE ED6F             RLD
          F3C0 2B               DEC     HL
          F3C1 2B               DEC     HL      ;RLD setzt auch
          F3C2 28DC             JR      Z,RH1   ;Z-Flag!
          F3C4 1B               DEC     DE      ;Fehler: Zahl
          F3C5 37               SCF             ;zu gross
          F3C6 C9               RET
          F3C7
          F3C7 CD61FB   GARG:   CALL    CON             ;**22**
          F3CA CD0EC7           CALL    GARGC
          F3CD C36DFB           JP      COFF
          F3D0
          F3D0 1199B7   SYSI:   LD      DE,HCADR
          F3D3 21F4F2           LD      HL,KCTAB
          F3D6 013400           LD      BC,34H
          F3D9 EDB0             LDIR            ;1.Stueck
          F3DB 0E0C             LD      C,0CH
          F3DD 1EDD             LD      E,L3TAB
          F3DF EDB0             LDIR            ;2.Stueck
          F3E1 210301           LD      HL,103H ;RAM0,IRM,
          F3E4 2200B8           LD      (0B800H),HL
          F3E7 210003           LD      HL,300H ;ROMC,RAM8,
          F3EA 2202B8           LD      (0B802H),HL
          F3ED 3E03             LD      A,3     ;RAM4
          F3EF 3204B8           LD      (0B804H),A
          F3F2 F3               DI              ;korrekt
          F3F3                                  ;anmelden
          F3F3 ED5E             IM      2
          F3F5 1607             LD      D,7
          F3F7 2163F4           LD      HL,IOTAB;Kanaele init.
          F3FA CD5AF4           CALL    INIME   ;PIO, Ports
          F3FD DD21F001         LD      IX,1F0H
          F401 DD360128         LD      (IX+1),28H;OUT84-Merker
          F405 DD360463         LD      (IX+4),63H;OUT86-Merker
          F409 3E01             LD      A,1
          F40B                  ;
          F40B 21BAFC   SIXD:   LD      HL,ISRTAB       ;**31**
          F40E 32D7B7           LD      (MIXIT),A
          F411 1EE2             LD      E,0E2H
          F413 57               LD      D,A
          F414 010E00           LD      BC,0EH  ;Interrupttab.
          F417 EDB0             LDIR            ;kopieren
          F419 DD6601           LD      H,(IX+1);alte Merker
          F41C DD6E04           LD      L,(IX+4);mitnehmen
          F41F D5               PUSH    DE
          F420 DDE1             POP     IX
          F422 DD360888         LD      (IX+8),88H
          F426 DD7401           LD      (IX+1),H;und eintragen
          F429 DD7504           LD      (IX+4),L
          F42C DD360E3A         LD      (IX+14),KTAB;=L(KTAB)
          F430 DD360FFC         LD      (IX+15),0FCH;=H(KTAB)
          F434 DD36097F         LD      (IX+9),7FH
          F438 F3               DI
          F439 ED5E             IM      2
          F43B 3AD7B7           LD      A,(MIXIT)
          F43E ED47             LD      I,A
          F440 1604             LD      D,4
          F442 217BF4           LD      HL,IOTAB2
          F445 CD5AF4           CALL    INIME   ;Kanaele init.
          F448                  ;
          F448 DD360500 KPUFF:  LD      (IX+5H),0
          F44C DD3606B7         LD      (IX+6H),0B7H
          F450 C9               RET
          F451
          F451 C5       INIEA:  PUSH    BC              ;**43**
          F452 4E               LD      C,M     ;1.Byte=Adr.
          F453 23               INC     HL
          F454 46               LD      B,M     ;2.Byte=Anz.
          F455 23               INC     HL
          F456 EDB3             OTIR
          F458 C1               POP     BC
          F459 C9               RET
          F45A
          F45A F3       INIME:  DI                      ;**44**
          F45B CD51F4   INIME1: CALL    INIEA
          F45E 15               DEC     D       ;D Kanaele
          F45F 20FA             JR      NZ,INIME1
          F461 FB               EI
          F462 C9               RET
          F463
          F463 8A       IOTAB:  DB      8AH     ;PIO-A-Steuerw.
          F464 01                DB     1
          F465 E4                 DB    0E4H    ;Int-Vektor
          F466 88               DB      88H     ;PIO-A-Daten
          F467 01                DB     1
          F468 0F                 DB    0FH     ;IRM ein...
          F469 8A               DB      8AH     ;PIO-A-Steuerw.
          F46A 02                DB     2
          F46B 0F                 DB    0FH     ;Byte-Out
          F46C 03                 DB    3       ;DI
          F46D 8B               DB      8BH     ;PIO-B-Steuerw.
          F46E 03                DB     3
          F46F E6                 DB    0E6H    ;Int-Vektor
          F470 0F                 DB    0FH     ;Byte-Out
          F471 83                 DB    83H     ;EI
          F472 89               DB      89H     ;PIO-B-Daten
          F473 01                DB     1
          F474 FF                 DB    0FFH    ;Daten
          F475 84               DB      84H     ;Port 84H
          F476 01                DB     1
          F477 28                 DB    28H     ;Ausgabebyte
          F478 86               DB      86H     ;Port 86H
          F479 01                DB     1
          F47A 63                 DB    63H     ;Ausgabebyte
          F47B 8A       IOTAB2: DB      8AH     ;PIO-A-Steuerw.
          F47C 01                DB     1
          F47D E4                 DB    0E4H    ;Int-Vektor
          F47E 8B               DB      8BH     ;PIO-B-Steuerw.
          F47F 01                DB     1
          F480 E6                 DB    0E6H    ;Int-Vektor
          F481 8C               DB      8CH     ;CTC0
          F482 01                DB     1
          F483 E8                 DB    0E8H    ;Int-Vektor CTC
          F484 8E               DB      8EH     ;CTC2 (blinken)
          F485 02                DB     2
          F486 47                 DB    47H     ;DI,Zaehler,RES
          F487 0C                 DB    0CH     ;Zeitkonstante
          F488          ;
          F488 7F7F             DW      7F7FH
          F48A 53415645         DB      'SAVE',1
          F48F FE02             CP      2       ;mind. 2 Arg.
          F491 DA61F3           JP      C,ERRM
          F494 CDEEF1           CALL    OSTR
          F497 4E414D45         DB      'NAME :',0
          F49E CD34F3           CALL    INLIN
          F4A1 210600           LD      HL,6    ;'NAME :'
          F4A4 19               ADD     HL,DE   ;uebergehen
          F4A5                  ;
          F4A5 1100B7   SAVE:   LD      DE,0B700H       ;**36**
          F4A8 010B00           LD      BC,11   ;name nach
          F4AB EDB0             LDIR            ;Puffer
          F4AD AF               XOR     A
          F4AE 12               LD      (DE),A
          F4AF 2181B7           LD      HL,ARGN ;alle Arg.
          F4B2 1E10             LD      E,10H   ;mit ARGN
          F4B4 0E15             LD      C,15H
          F4B6 EDB0             LDIR            ;nach Puffer
          F4B8 CD48F4           CALL    KPUFF   ;Standard setz
          F4BB CD1CE5           CALL    ISRO
          F4BE 2A82B7           LD      HL,(ARG1)
          F4C1 DD7505   SAV1:   LD      (IX+5),L
          F4C4 DD7406           LD      (IX+6),H
          F4C7 CDEEF1           CALL    OSTR
          F4CA 0200             DB      2,0     ;CLLN
          F4CC CDE8F1           CALL    BNROST  ;Blocknummer
          F4CF 00               NOP
          F4D0 01A000           LD      BC,0A0H
          F4D3 CDDEE3           CALL    BRKT
          F4D6 DAE0E4           JP      C,CSROI
          F4D9 118000           LD      DE,80H
          F4DC 19               ADD     HL,DE
          F4DD ED5B84B7         LD      DE,(ARG2)
          F4E1 ED52             SBC     HL,DE   ;Ende erreicht?
          F4E3 D2D9E4           JP      NC,CSRO
          F4E6 CD2BE5           CALL    MBO
          F4E9 18D6             JR      SAV1
          F4EB
          F4EB ED4B86B7 LARG:   LD      BC,(ARG3)       ;**15**
          F4EF ED5B84B7         LD      DE,(ARG2)
          F4F3 2A82B7           LD      HL,(ARG1)
          F4F6 3A81B7           LD      A,(ARGN)
          F4F9 C9               RET
          F4FA
          F4FA          LUP:    ;LOAD-Unterprogramm
          F4FA                  ;PA: CY=1 BRK gedrueckt
          F4FA DD3403           INC     (IX+3)  ;erwarteter Blk
          F4FD CD91E5   LUP1:   CALL    MBI
          F500 3020             JR      NC,LUP3
          F502 CDEEF1           CALL    OSTR
          F505 09090920         DB      9,9,9,' ',0
          F50A CDE8F1           CALL    BNROST
          F50D 203F             DB      ' ?'    ;fehlerhaft
          F50F 1E00             DB      1EH,0
          F511 DD7E03           LD      A,(IX+3)
          F514 3D               DEC     A       ;Block 01 erw.?
          F515 28E6             JR      Z,LUP1
          F517 CD38F2           CALL    KBD     ;nein
          F51A FE03             CP      3       ;BRK?
          F51C 37               SCF
          F51D C8               RET     Z
          F51E FE0A             CP      0AH     ;CUD?
          F520 20DB             JR      NZ,LUP1
          F522 DD7E02   LUP3:   LD      A,(IX+2)
          F525 DD4603           LD      B,(IX+3)
          F528 05               DEC     B       ;Block 01 erw.?
          F529 2817             JR      Z,LUP6
          F52B 04               INC     B       ;richtige
          F52C B8               CP      B       ;Blocknummer?
          F52D 280B             JR      Z,LUP5
          F52F 3C               INC     A       ;Block FF?
          F530 2808             JR      Z,LUP5
          F532 CDE8F1   LUP4:   CALL    BNROST
          F535 2A               DB      '*'     ;falsche Nr.
          F536 1900             DB      19H,0
          F538 18C3             JR      LUP1
          F53A
          F53A CDE8F1   LUP5:   CALL    BNROST
          F53D 3E20             DB      '> '    ;korrekter Blk.
          F53F 1900             DB      19H,0
          F541 C9               RET
          F542
          F542 3D       LUP6:   DEC     A       ;Block 01?
          F543 20ED             JR      NZ,LUP4
          F545 CD6BF3           CALL    CRLF    ;keine Nr,
          F548 2100B7           LD      HL,0B700H
          F54B 060B             LD      B,11    ;sondern Name
          F54D 7E       LUP7:   LD      A,M     ;ausgeben
          F54E 23               INC     HL
          F54F CD29E3           CALL    CRT
          F552 10F9             DJNZ    LUP7
          F554 C35CF3           JP      SPACE
          F557
          F557 CDEEF1   NOMC:   CALL    OSTR    ;wenn kein MC
          F55A 3F3F3F00         DB      '???',0
          F55E C3E0E4   CLJP:   JP      CSROI
          F561          ;
          F561 7F7F             DW      7F7FH
          F563 56455249         DB      'VERIFY',1
          F56A DDCB0786 VERIF:  RES     0,(IX+7)        ;**11**
          F56E 180B             JR      LOAD0
          F570          ;
          F570 7F7F             DW      7F7FH
          F572 4C4F4144         DB      'LOAD',1
          F577 DDCB07C6 LOAD:   SET     0,(IX+7)        ;**10**
          F57B CDB4E4   LOAD0:  CALL    ISRI1
          F57E CD48F4           CALL    KPUFF   ;Standard setz
          F581 DD360300         LD      (IX+3),0
          F585 CDFAF4           CALL    LUP
          F588 38D4     LOAD1:  JR      C,CLJP  ;bei BRK
          F58A DDCB0746         BIT     0,(IX+7)
          F58E 2849             JR      Z,LOAD4
          F590 2E10             LD      L,10H
          F592 DD7E07           LD      A,(IX+7)
          F595 E6E3             AND     0E3H    ;Bits 2..4 Null
          F597 DD7707           LD      (IX+7),A
          F59A 7E               LD      A,M     ;Anzahl Arg.
          F59B CB27             SLA     A
          F59D CB27             SLA     A       ;2* schieben
          F59F E61C             AND     1CH     ;Maske
          F5A1 DDB607           OR      (IX+7)
          F5A4 DD7707           LD      (IX+7),A
          F5A7 7E               LD      A,M     ;Anzahl Arg.
          F5A8 D602             SUB     2
          F5AA FE09             CP      9       ;MC?
          F5AC 30A9             JR      NC,NOMC
          F5AE ED4B15B7         LD      BC,(0B715H)
          F5B2 ED5B13B7         LD      DE,(0B713H)
          F5B6 2A11B7           LD      HL,(0B711H)
          F5B9 3A81B7           LD      A,(ARGN)
          F5BC A7               AND     A       ;Ladeoffset?
          F5BD 2813             JR      Z,LOAD3
          F5BF C5               PUSH    BC
          F5C0 ED4B82B7         LD      BC,(ARG1)
          F5C4 09               ADD     HL,BC   ;AAdr,Eadr
          F5C5 EB               EX      DE,HL   ;umrechnen
          F5C6 09               ADD     HL,BC
          F5C7 EB               EX      DE,HL
          F5C8 DDCB0766         BIT     4,(IX+7);4..7 Args?
          F5CC 2003             JR      NZ,LOAD2
          F5CE E3               EX      (SP),HL ;nein
          F5CF 09               ADD     HL,BC   ;SAdr umrechnen
          F5D0 E3               EX      (SP),HL
          F5D1 C1       LOAD2:  POP     BC      ;SAdr merken
          F5D2 ED4384B7 LOAD3:  LD      (ARG2),BC
          F5D6 CD89F3           CALL    HLDE    ;AAdr,EAdr ausg
          F5D9 CD6BF3   LOAD4:  CALL    CRLF
          F5DC EB               EX      DE,HL
          F5DD                  ;Load-Hauptschleife
          F5DD CDFAF4   LOAD5:  CALL    LUP
          F5E0 38A6             JR      C,LOAD1 ;BRK
          F5E2 DDCB0746         BIT     0,(IX+7)
          F5E6 2812             JR      Z,LOAD7 ;wenn VERIFY
          F5E8 E5               PUSH    HL
          F5E9 ED52             SBC     HL,DE
          F5EB 018000           LD      BC,80H
          F5EE ED42             SBC     HL,BC
          F5F0 09               ADD     HL,BC
          F5F1 3001             JR      NC,LOAD6
          F5F3 4D               LD      C,L
          F5F4 2100B7   LOAD6:  LD      HL,0B700H;MC in Spei-
          F5F7 EDB0             LDIR            ;cher kopieren
          F5F9 E1               POP     HL
          F5FA DD3402   LOAD7:  INC     (IX+2)  ;Blocknr. FF?
          F5FD 20DE             JR      NZ,LOAD5
          F5FF                  ;
          F5FF CDE0E4   CSRI:   CALL    CSROI           ;**0B**
          F602 DD7E07           LD      A,(IX+7);kein Autostart
          F605 E603             AND     3       ;wenn VERIFY,
          F607 3D               DEC     A       ;Bit 1(IX+7)=1
          F608 C0               RET     NZ
          F609 DD7E07           LD      A,(IX+7)
          F60C E61C             AND     1CH     ;und bei nur 2
          F60E FE0C             CP      0CH     ;Ladeargumenten
          F610 DD360700         LD      (IX+7),0
          F614 D8               RET     C
          F615 2A84B7           LD      HL,(ARG2)
          F618 E9               JP      (HL)    ;Ansprung
          F619          ;
          F619 7F7F             DW      7F7FH
          F61B 434F4C4F         DB      'COLOR',1
          F621 CD61FB   COLR:   CALL    CON             ;**0F**
          F624 CD63C1           CALL    COLRC
          F627 C36DFB           JP      COFF
          F62A
          F62A E5       CSTBT:  PUSH    HL              ;**42**
          F62B 21A2B7           LD      HL,STBT
          F62E CBDE             SET     3,M
          F630 CD1DF2           CALL    OCHR    ;Steuerzeichen
          F633 CB9E             RES     3,M     ;darstellen
          F635 E1               POP     HL
          F636 C9               RET
          F637          ;
          F637 7F7F             DW      7F7FH
          F639 44495350         DB      'DISPLAY',1
          F641 CD61FB   DISP:   CALL    CON             ;**3B**
          F644 CD42C2           CALL    DISPC
          F647 C36DFB   JCOFF:  JP      COFF
          F64A
          F64A CD6DFB   LDAME:  CALL    COFF    ;fuer DISPC
          F64D 7E               LD      A,M     ;und MODIC
          F64E C361FB   JCON:   JP      CON
          F651          ;
          F651 7F7F             DW      7F7FH
          F653 4D4F4449         DB      'MODIFY',1
          F65A CD61FB   MODI:   CALL    CON             ;**2E**
          F65D CD6AC2           CALL    MODIC
          F660 18E5             JR      JCOFF
          F662
          F662 CD6DFB   LDMAE:  CALL    COFF    ;fuer MODIC
          F665 77               LD      M,A
          F666 18E6             JR      JCON
          F668          ;
          F668 7F7F             DW      7F7FH
          F66A 57494E44         DB      'WINDOW',1
          F671 A7               AND     A       ;Kein Arg?
          F672 282A             JR      Z,WINAK ;Aufruf No.0
          F674 3D               DEC     A       ;1 Arg?
          F675 2826             JR      Z,WINAKI;Aufruf No.L
          F677 65               LD      H,L
          F678 69               LD      L,C
          F679 53               LD      D,E
          F67A 3A88B7           LD      A,(ARG49)
          F67D 5F               LD      E,A
          F67E 3A81B7           LD      A,(ARGN)
          F681 FE04             CP      4
          F683 2005             JR      NZ,WIN1 ;PROGRAMMFEHLER
          F685 3809             JR      C,WIN3  ;(vertauscht!)
          F687 AF               XOR     A
          F688 1803             JR      WIN2
          F68A
          F68A 3A8AB7   WIN1:   LD      A,(ARG49+2);Init No.A
          F68D CD94F6   WIN2:   CALL    WININ
          F690 DA61F3   WIN3:   JP      C,ERRM
          F693 C9               RET
          F694
          F694 CD61FB   WININ:  CALL    CON             ;**3C**
          F697 CD2DC1           CALL    WININC
          F69A C36DFB           JP      COFF
          F69D
          F69D 7D       WINAKI: LD      A,L
          F69E CDBBF6   WINAK:  CALL    WCOPY           ;**3D**
          F6A1 329BB7           LD      (WINNR),A
          F6A4 CDAEF6           CALL    PART    ;Fenster A
          F6A7 D8               RET     C       ;holen
          F6A8 EB               EX      DE,HL
          F6A9 119CB7           LD      DE,WINON
          F6AC 181B             JR      WCOP1
          F6AE
          F6AE          PART:   ;Testet A und berechnet Pos.
          F6AE                  ;in Fenstervektorspeicher =DE
          F6AE C6F6             ADD     0F6H
          F6B0 D8               RET     C
          F6B1 87               ADD     A
          F6B2 5F               LD      E,A
          F6B3 87               ADD     A
          F6B4 87               ADD     A
          F6B5 83               ADD     E
          F6B6 5F               LD      E,A
          F6B7 16B9             LD      D,0B9H
          F6B9 A7               AND     A
          F6BA C9               RET
          F6BB
          F6BB          WCOPY:  ;Fenster (WINNR) retten
          F6BB F5               PUSH    AF
          F6BC 3A9BB7           LD      A,(WINNR)
          F6BF CDAEF6           CALL    PART
          F6C2 DA5BE0           JP      C,IAD2
          F6C5 F1               POP     AF
          F6C6 219CB7           LD      HL,WINON
          F6C9 010A00   WCOP1:  LD      BC,10
          F6CC EDB0             LDIR
          F6CE C9               RET
          F6CF
          F6CF 23       NCHAR:  INC     HL
          F6D0 7E       KEYUP:  LD      A,M     ;fuer KEY
          F6D1 A7               AND     A
          F6D2 C8               RET     Z
          F6D3 CD2AF6           CALL    CSTBT
          F6D6 18F7             JR      NCHAR
          F6D8          ;
          F6D8 7F7F             DW      7F7FH
          F6DA 4B455901         DB      'KEY',1
          F6DE FE01             CP      1
          F6E0 C0               RET     NZ
          F6E1 7D               LD      A,L
          F6E2 A7       KEY:    AND     A               ;**3A**
          F6E3 C8               RET     Z       ;KEY 0
          F6E4 FE0D             CP      0DH     ;nur F-Tasten
          F6E6 D0               RET     NC      ;1..C
          F6E7 47               LD      B,A
          F6E8 2100B9           LD      HL,0B900H
          F6EB 7E       KEY1:   LD      A,M     ;B Dummys
          F6EC 23               INC     HL      ;auszaehlen
          F6ED A7               AND     A
          F6EE 20FB             JR      NZ,KEY1
          F6F0 10F9             DJNZ    KEY1
          F6F2 CDD0F6           CALL    KEYUP   ;Belegung
          F6F5                                  ;praesentieren
          F6F5 F5       KEY2:   PUSH    AF
          F6F6 2B               DEC     HL
          F6F7 F1       KEY3:   POP     AF
          F6F8 CD17F2   KEY4:   CALL    INTB
          F6FB FE13             CP      13H     ;STOP-Ende
          F6FD CA6BF3           JP      Z,CRLF
          F700 F5               PUSH    AF
          F701 0600             LD      B,0
          F703 3D               DEC     A       ;CLR?
          F704 2015             JR      NZ,KEY5
          F706 7E               LD      A,M     ;Leere Belegung
          F707 A7               AND     A       ;nicht loeschen!
          F708 28ED             JR      Z,KEY3
          F70A 54               LD      D,H     ;DE=Ziel
          F70B 5D               LD      E,L
          F70C E5               PUSH    HL
          F70D 23               INC     HL      ;HL=Quelle
          F70E 3E9C             LD      A,9CH
          F710 95               SUB     L       ;Laenge, B=0
          F711 4F               LD      C,A     ;Pufferrest
          F712 EDB0             LDIR            ;vorziehen
          F714 E1               POP     HL
          F715 F1               POP     AF
          F716 CD1DF2           CALL    OCHR
          F719 18DA             JR      KEY2
          F71B
          F71B 3A9AB9   KEY5:   LD      A,(0B99AH);vorletztes
          F71E A7               AND     A       ;Zeichen<>0?
          F71F 20D6             JR      NZ,KEY3 ;ja-voll!
          F721 E5               PUSH    HL
          F722 3E9B             LD      A,9BH
          F724 95               SUB     L
          F725 4F               LD      C,A     ;Laenge, B=0
          F726 219AB9           LD      HL,0B99AH
          F729 119BB9           LD      DE,0B99BH;Pufferrest
          F72C EDB8             LDDR            ;hinterziehen
          F72E E1               POP     HL
          F72F F1               POP     AF
          F730 23               INC     HL      ;Zeichen
          F731 77               LD      M,A     ;eintragen
          F732 CD2AF6           CALL    CSTBT   ;& anzeigen
          F735 18C1             JR      KEY4
          F737
          F737          ;
          F737 7F7F             DW      7F7FH
          F739 4B45594C         DB      'KEYLIST',1
          F741 CD61FB   KEYLI:  CALL    CON             ;**39**
          F744 CDF7C0           CALL    KEYLIC
          F747 C36DFB           JP      COFF
          F74A
          F74A          CUCP:   ;nur fuer Klotz-Cursor!
          F74A D5               PUSH    DE              ;**25**
          F74B F5               PUSH    AF
          F74C E5               PUSH    HL
          F74D CD40E0           CALL    PADR0
          F750 380A             JR      C,CUCP2 ;ausserhalb
          F752 C5               PUSH    BC
          F753 0608             LD      B,8
          F755 7E       CUCP1:  LD      A,M
          F756 2F               CPL             ;compeln
          F757 77               LD      M,A
          F758 2C               INC     L
          F759 10FA             DJNZ    CUCP1   ;8*
          F75B C1               POP     BC
          F75C E1       CUCP2:  POP     HL
          F75D F1               POP     AF
          F75E D1               POP     DE
          F75F C9               RET
          F760
          F760 E5       PUSE:   PUSH    HL              ;**30**
          F761 D5               PUSH    DE
          F762 C5               PUSH    BC
          F763 A7               AND     A       ;Kennung CY=0
          F764 F5               PUSH    AF
          F765 2AD3B7           LD      HL,(HOR)
          F768 ED5BD5B7         LD      DE,(VERT)
          F76C 1600             LD      D,0
          F76E C3ECF7           JP      PUSEJ
          F771
          F771 CD61FB   PUDE:   CALL    CON             ;**2F**
          F774 CDE4C1           CALL    PUDEC
          F777 C36DFB           JP      COFF
          F77A
          F77A 3A86B7   CIRCL:  LD      A,(ARG3)        ;**3F**
          F77D 4F               LD      C,A
          F77E 69               LD      L,C
          F77F AF               XOR     A
          F780 0608             LD      B,8
          F782 CB1D             RR      L
          F784 3001     CIR1:   JR      NC,CIR2
          F786 81               ADD     C
          F787 1F       CIR2:   RRA
          F788 CB1D             RR      L
          F78A 10F8             DJNZ    CIR1
          F78C 67               LD      H,A     ;Achtelkreis
          F78D 54               LD      D,H     ;berechnen
          F78E 5D               LD      E,L
          F78F 79               LD      A,C
          F790 CB21             SLA     C
          F792 CB10             RL      B
          F794 0B               DEC     BC
          F795 C5               PUSH    BC
          F796 010100           LD      BC,1
          F799 D9               EXX
          F79A 4F               LD      C,A
          F79B 0600             LD      B,0H
          F79D CDC2F7   CIR3:   CALL    CIRUP   ;und jeweils 8
          F7A0 CDC2F7           CALL    CIRUP   ;Punkte setzen
          F7A3 D9               EXX
          F7A4 A7               AND     A
          F7A5 ED42             SBC     HL,BC
          F7A7 03               INC     BC
          F7A8 03               INC     BC
          F7A9 ED52             SBC     HL,DE
          F7AB 19               ADD     HL,DE
          F7AC D9               EXX
          F7AD 300C             JR      NC,CIR4
          F7AF D9               EXX
          F7B0 E3               EX      (SP),HL
          F7B1 EB               EX      DE,HL
          F7B2 A7               AND     A
          F7B3 ED52             SBC     HL,DE
          F7B5 1B               DEC     DE
          F7B6 1B               DEC     DE
          F7B7 EB               EX      DE,HL
          F7B8 E3               EX      (SP),HL
          F7B9 D9               EXX
          F7BA 0D               DEC     C
          F7BB 04       CIR4:   INC     B
          F7BC 79               LD      A,C
          F7BD B8               CP      B
          F7BE 30DD             JR      NC,CIR3
          F7C0 F1               POP     AF
          F7C1 C9               RET
          F7C2
          F7C2          CIRUP:  ;setzt 4 Punkte um Mittelpunkt
          F7C2 78               LD      A,B
          F7C3 41               LD      B,C
          F7C4 4F               LD      C,A
          F7C5 AF               XOR     A
          F7C6 57               LD      D,A
          F7C7 2A84B7           LD      HL,(ARG2)
          F7CA E5               PUSH    HL
          F7CB 59               LD      E,C
          F7CC 19               ADD     HL,DE
          F7CD CDD6F7           CALL    CIRUP1
          F7D0 AF               XOR     A
          F7D1 57               LD      D,A
          F7D2 E1               POP     HL
          F7D3 59               LD      E,C
          F7D4 ED52             SBC     HL,DE
          F7D6 E5       CIRUP1: PUSH    HL
          F7D7 2A82B7           LD      HL,(ARG1)
          F7DA 58               LD      E,B
          F7DB A7               AND     A
          F7DC ED52             SBC     HL,DE
          F7DE D1               POP     DE
          F7DF CDE8F7           CALL    SHLDE
          F7E2 D5               PUSH    DE
          F7E3 57               LD      D,A
          F7E4 58               LD      E,B
          F7E5 19               ADD     HL,DE
          F7E6 19               ADD     HL,DE
          F7E7 D1               POP     DE
          F7E8                  ;
          F7E8          SHLDE:  ;setzt Punkt auf Pos. HL/DE
          F7E8                  ;(wenn moeglich)
          F7E8 E5               PUSH    HL
          F7E9 D5               PUSH    DE
          F7EA C5               PUSH    BC
          F7EB F5               PUSH    AF
          F7EC 7D       PUSEJ:  LD      A,L
          F7ED E607             AND     7       ;Bitnummer
          F7EF C6F8             ADD     BITTAB%256
          F7F1 4F               LD      C,A
          F7F2 06FD             LD      B,BITTAB/256
          F7F4 7D               LD      A,L
          F7F5 CB3C             SRL     H
          F7F7 1F               RRA
          F7F8 CB3C             SRL     H       ;Bytespalte
          F7FA 1F               RRA
          F7FB CB3C             SRL     H
          F7FD 1F               RRA
          F7FE FE28             CP      28H     ;HL>13Fh?
          F800 3031             JR      NC,POP4
          F802 F680             OR      80H
          F804 67               LD      H,A     ;im IRM
          F805 3EFF             LD      A,0FFH
          F807 82               ADD     D       ;D>0? (DE>0FFh)
          F808 3829             JR      C,POP4
          F80A AB               XOR     E
          F80B 6F               LD      L,A
          F80C 3AD6B7           LD      A,(FARB)
          F80F 57               LD      D,A
          F810 0A               LD      A,(BC)  ;BITTAB lesen
          F811 DDCB015E         BIT     3,(IX+1);HiRes?
          F815 282D             JR      Z,HIRES
          F817 CB4A             BIT     1,D     ;Loeschen?
          F819 2023             JR      NZ,CPLA
          F81B CB42             BIT     0,D     ;XOR?
          F81D 2019             JR      NZ,XORA
          F81F B6               OR      M       ;Punkt setzen
          F820 77       XORJ:   LD      M,A
          F821 DD7E01           LD      A,(IX+1)
          F824 5F               LD      E,A
          F825 EE02             XOR     2       ;Farbebene
          F827 F3               DI
          F828 D384             OUT     84H
          F82A 7E               LD      A,M
          F82B E607             AND     7
          F82D B2               OR      D
          F82E 77               LD      M,A     ;neue vFarbe
          F82F 7B               LD      A,E
          F830 D384             OUT     84H
          F832 FB               EI
          F833 F1       POP4:   POP     AF
          F834 C1               POP     BC
          F835 D1               POP     DE
          F836 E1               POP     HL
          F837 C9               RET
          F838
          F838 AE       XORA:   XOR     M       ;Punkt setzen/
          F839 CB82             RES     0,D     ;ruecksetzen
          F83B C320F8           JP      XORJ
          F83E
          F83E 2F       CPLA:   CPL
          F83F A6               AND     M       ;Punkt loeschen
          F840 77               LD      M,A
          F841 C333F8           JP      POP4
          F844
          F844 47       HIRES:  LD      B,A
          F845 B6               OR      M       ;Bit setzen
          F846 CB5A             BIT     3,D     ;Farbe Rot?
          F848 2001             JR      NZ,HIR1
          F84A A8               XOR     B       ;wieder loeschen
          F84B 77       HIR1:   LD      M,A
          F84C DD7E01           LD      A,(IX+1)
          F84F 4F               LD      C,A
          F850 EE02             XOR     2
          F852 F3               DI
          F853 D384             OUT     84H     ;Farbebene
          F855 78               LD      A,B
          F856 B6               OR      M       ;setzen
          F857 CB62             BIT     4,D     ;Farbe Tuerkis?
          F859 2001             JR      NZ,HIR2
          F85B A8               XOR     B       ;loeschen
          F85C 77       HIR2:   LD      M,A
          F85D 79               LD      A,C
          F85E D384             OUT     84H
          F860 FB               EI
          F861 18D0             JR      POP4
          F863
          F863 CD61FB   LINE:   CALL    CON             ;**3E**
          F866 CD7CC1           CALL    LINEC
          F869 1828             JR      COF
          F86B
          F86B CD61FB   MBOUT:  CALL    CON             ;**38**
          F86E CD2BC7           CALL    MBOC
          F871 1820             JR      COF
          F873
          F873 CD61FB   MBIN:   CALL    CON             ;**37**
          F876 CDA7C7           CALL    MBIC
          F879 1818             JR      COF
          F87B
          F87B CD6DFB   JIOERR: CALL    COFF    ;Sprung zu
          F87E 2AC9B7           LD      HL,(IOERR);?IO ERROR
          F881 CD99F0           CALL    IRMOF
          F884 E9               JP      (HL)
          F885          ;
          F885 7F7F             DW      7F7FH
          F887 4D4F4455         DB      'MODUL',1
          F88D CD61FB   ESC5:   CALL    CON
          F890 CD00C0           CALL    MODULC
          F893 C36DFB   COF:    JP      COFF
          F896          ;
          F896 7F7F             DW      7F7FH
          F898 53595354         DB      'SYSTEM',1
          F89F CD61FB   ESC6:   CALL    CON
          F8A2 CD28C0           CALL    SYSTC
          F8A5 18EC             JR      COF
          F8A7
          F8A7          BASPV:  ;BASIC-I/O-Verteiler
          F8A7 E5               PUSH    HL
          F8A8 C5               PUSH    BC
          F8A9 CD7AF0           CALL    IRMON
          F8AC CB6B             BIT     5,E
          F8AE D5               PUSH    DE
          F8AF 2053             JR      NZ,BASBYE
          F8B1 23               INC     HL
          F8B2 23               INC     HL
          F8B3 CB7B             BIT     7,E
          F8B5 2042             JR      NZ,BSA2
          F8B7 E5               PUSH    HL
          F8B8 7B               LD      A,E
          F8B9 E607             AND     7
          F8BB 21F1F8           LD      HL,BUPTAB
          F8BE 85               ADD     L
          F8BF 6F               LD      L,A
          F8C0 7A               LD      A,D
          F8C1 53               LD      D,E
          F8C2 5E               LD      E,M     ;UP-Nummer
          F8C3 E1               POP     HL
          F8C4 CD77F0           CALL    PV3     ;Aufruf
          F8C7 D1               POP     DE
          F8C8 57               LD      D,A
          F8C9 7B               LD      A,E
          F8CA E64F             AND     4FH
          F8CC EE43             XOR     43H
          F8CE 2018             JR      NZ,BSA1
          F8D0 CDEEF1           CALL    OSTR
          F8D3 56455249         DB      'VERIFY ?(Y):',0
          F8E0 CD38F2           CALL    KBD
          F8E3 FE59             CP      'Y'
          F8E5 CC6AF5           CALL    Z,VERIF
          F8E8 7A       BSA1:   LD      A,D
          F8E9 CB9B             RES     3,E
          F8EB CD99F0           CALL    IRMOF
          F8EE C1               POP     BC
          F8EF E1               POP     HL
          F8F0 C9               RET
          F8F1
          F8F1          BUPTAB: ;H-Teil konstant!
          F8F1 16               DB      16H     ;INTB
          F8F2 24               DB      24H     ;OCHR
          F8F3 27               DB      27H     ;MBIN
          F8F4 38               DB      38H     ;MBOUT
          F8F5 06               DB      06H     ;USIN1
          F8F6 02               DB      02H     ;UOT1
          F8F7 07               DB      07H     ;USIN2
          F8F8 03               DB      03H     ;UOT2
          F8F9
          F8F9 CDCAE3   BSA2:   CALL    KBDS
          F8FC D1               POP     DE
          F8FD 57               LD      D,A
          F8FE 30E8             JR      NC,BSA1
          F900 CBBB             RES     7,E
          F902 18E4             JR      BSA1
          F904
          F904 3A5E03   BASBYE: LD      A,(35EH)
          F907 A7               AND     A
          F908 2809             JR      Z,BASB1
          F90A CD99F0           CALL    IRMOF
          F90D CD41C6           CALL    0C641H  ;NEW
          F910 CD7AF0           CALL    IRMON
          F913 DB88     BASB1:  IN      A,88H
          F915 E65F             AND     5FH     ;BASIC-ROM aus
          F917 D388             OUT     88H
          F919 C37EF1           JP      LOOP
          F91C
          F91C 7E       ZKOUT:  LD      A,M             ;**45**
          F91D 23               INC     HL
          F91E A7               AND     A
          F91F C8               RET     Z
          F920 CD1DF2           CALL    OCHR
          F923 18F7             JR      ZKOUT
          F925
          F925 CDEBF4   TON:    CALL    LARG            ;**35**
          F928 DDCB084E TON1:   BIT     1,(IX+8);noch alter Ton
          F92C 20FA             JR      NZ,TON1
          F92E C5       TON2:   PUSH    BC
          F92F 0E8C             LD      C,8CH   ;CTC0
          F931 CD5AF9           CALL    TON4    ;starten
          F934 0C               INC     C       ;CTC1
          F935 EB               EX      DE,HL
          F936 CD5AF9           CALL    TON4    ;starten
          F939 C1               POP     BC
          F93A 79               LD      A,C     ;Lautstaerke
          F93B EE1F             XOR     1FH     ;da nullaktiv
          F93D F681             OR      81H     ;maskieren
          F93F 4F               LD      C,A
          F940 78               LD      A,B
          F941 A7               AND     A       ;Dauerton?
          F942 280D             JR      Z,TON3
          F944 CBB9             RES     7,C     ;nein, Blinkaus
          F946 DDCB08CE         SET     1,(IX+8);neuer Ton
          F94A 3EC7             LD      A,0C7H  ;EI, Zaehler 50Hz
          F94C D38E             OUT     8EH     ;CTC2
          F94E 78               LD      A,B     ;Dauer
          F94F D38E             OUT     8EH
          F951 0660     TON3:   LD      B,60H
          F953 DB89     TONB:   IN      A,89H
          F955 A0               AND     B       ;RAM8 maskieren
          F956 B1               OR      C
          F957 D389             OUT     89H     ;Ltst. ausgeben
          F959 C9               RET
          F95A
          F95A          TON4:   ;CTC (C) programmieren mit HL
          F95A 7D               LD      A,L
          F95B A7               AND     A       ;Ton?
          F95C 2E03             LD      L,3
          F95E 280B             JR      Z,TON6  ;kein Ton
          F960 6F               LD      L,A
          F961 3E07             LD      A,7     ;Zeitgeber
          F963 CB44             BIT     0,H     ;Vorteiler?
          F965 2802             JR      Z,TON5
          F967 F620             OR      20H     ;ja
          F969 ED79     TON5:   OUT     (C),A
          F96B ED69     TON6:   OUT     (C),L
          F96D C9               RET
          F96E
          F96E
          F96E 2100B2   ESC1:   LD      HL,0B200H
          F971 22CBB7           LD      (VRAM),HL
          F974 DD7E01           LD      A,(IX+1)
          F977 E6F8             AND     0F8H
          F979 D384     OUT84:  OUT     84H,A
          F97B DD7701           LD      (IX+1),A
          F97E C9               RET
          F97F
          F97F 2100AD   ESC2:   LD      HL,0AD00H
          F982 22CBB7           LD      (VRAM),HL
          F985 DD7E01           LD      A,(IX+1)
          F988 F605             OR      5
          F98A 18ED             JR      OUT84
          F98C
          F98C 2100AD   ESC3:   LD      HL,0AD00H
          F98F 22CBB7           LD      (VRAM),HL
          F992 DD7E01           LD      A,(IX+1)
          F995 E6FE             AND     0FEH
          F997 F604             OR      4
          F999 18DE             JR      OUT84
          F99B
          F99B 2100B2   ESC4:   LD      HL,0B200H
          F99E 22CBB7           LD      (VRAM),HL
          F9A1 DD7E01           LD      A,(IX+1)
          F9A4 F601             OR      1
          F9A6 E6F9             AND     0F9H
          F9A8 18CF             JR      OUT84
          F9AA
          F9AA 21A2B7   ESC7:   LD      HL,STBT
          F9AD 7E               LD      A,M
          F9AE EE04             XOR     4
          F9B0 77               LD      M,A
          F9B1 C9               RET
          F9B2
          F9B2 DD7E01   ESC9:   LD      A,(IX+1)
          F9B5 EE02             XOR     2
          F9B7 18C0             JR      OUT84
          F9B9
          F9B9 DB89     ESCA:   IN      A,89H
          F9BB EE80             XOR     80H     ;Blinkbit
          F9BD D389             OUT     89H
          F9BF DD7E01           LD      A,(IX+1)
          F9C2 EE08             XOR     8
          F9C4 18B3             JR      OUT84
          F9C6
          F9C6          ;
          F9C6 7F7F             DW      7F7FH
          F9C8 5632344F         DB      'V24OUT',1
          F9CF          V24OUT: ;Druckerroutine          **47**
          F9CF CD61FB           CALL    CON
          F9D2 CDD5C2           CALL    V24OC
          F9D5 3E0D             LD      A,0DH
          F9D7 CD06FA           CALL    PRINT
          F9DA 3E0A             LD      A,0AH
          F9DC CD06FA           CALL    PRINT
          F9DF C36DFB   COF1:   JP      COFF
          F9E2
          F9E2          HCPGM:  ;Reaktion auf ShCLR
          F9E2 CD61FB           CALL    CON
          F9E5 CDCFC3           CALL    HCPGMC
          F9E8 18F5             JR      COF1
          F9EA
          F9EA          ;
          F9EA 7F7F             DW      7F7FH
          F9EC 56323444         DB      'V24DUP',1
          F9F3          V24DUP: ;Duplexroutine           **48**
          F9F3 CD61FB           CALL    CON
          F9F6 CD4FC6           CALL    V24DC
          F9F9 18E4             JR      COF1
          F9FB
          F9FB CD61FB   INIDUP: CALL    CON
          F9FE CDC3C6           CALL    UMINIT
          FA01 18DC             JR      COF1
          FA03
          FA03 CD29E3   ECHO:   CALL    CRT
          FA06 F5       PRINT:  PUSH    AF
          FA07 3AE1B7           LD      A,(HCPZ)
          FA0A CB7F             BIT     7,A
          FA0C 2829             JR      Z,PRINT3;Drucker
          FA0E E6F0             AND     0F0H    ;Schreibmasch.
          FA10 FE90             CP      90H
          FA12 2817             JR      Z,S3004 ;S3004
          FA14 FEA0             CP      0A0H
          FA16 201F             JR      NZ,PRINT3
          FA18 F1               POP     AF      ;S6005
          FA19 E5               PUSH    HL
          FA1A C5               PUSH    BC
          FA1B 2192FB           LD      HL,ZIBM
          FA1E 010700           LD      BC,7
          FA21 EDB1             CPIR
          FA23 200F             JR      NZ,PRINT2
          FA25 0E06             LD      C,6
          FA27 09               ADD     HL,BC
          FA28 7E               LD      A,M
          FA29 1809             JR      PRINT2
          FA2B
          FA2B F1       S3004:  POP     AF
          FA2C FE7E             CP      7EH
          FA2E 2008             JR      NZ,PRINT4
          FA30 3E83             LD      A,83H   ;ss
          FA32 1804             JR      PRINT4
          FA34
          FA34 C1       PRINT2: POP     BC
          FA35 E1               POP     HL
          FA36 F5               PUSH    AF
          FA37 F1       PRINT3: POP     AF
          FA38 FE09     PRINT4: CP      9       ;CUR
          FA3A 280D             JR      Z,PRINT5
          FA3C F5               PUSH    AF
          FA3D 3AA2B7           LD      A,(STBT)
          FA40 CB5F             BIT     3,A     ;Steuerzeichen
          FA42 280E             JR      Z,OFILT1;ausfuehren
          FA44 F1               POP     AF
          FA45 FE7F             CP      7FH     ;und 7Fh
          FA47 2002             JR      NZ,PRINT6
          FA49 3E20     PRINT5: LD      A,20H   ;nach SPC
          FA4B FE20     PRINT6: CP      20H     ;und Steuerzei-
          FA4D 3002             JR      NC,OFILT;chen nach '_'
          FA4F 3E5F             LD      A,'_'   ;wandeln
          FA51          OFILT:  ;Ausgabe ohne Filter
          FA51 F5               PUSH    AF
          FA52 C5       OFILT1: PUSH    BC
          FA53 CDD4FA           CALL    LCSO
          FA56 3E0A             LD      A,0AH
          FA58 81               ADD     C
          FA59 4F               LD      C,A
          FA5A ED78             IN      A,(C)
          FA5C CB57             BIT     2,A     ;bereit?
          FA5E 2008             JR      NZ,OFILT2
          FA60 3E01             LD      A,1     ;nein-warten
          FA62 CDE0F1           CALL    WAIT
          FA65 C1               POP     BC
          FA66 18EA             JR      OFILT1
          FA68 C1       OFILT2: POP     BC
          FA69 F1               POP     AF
          FA6A C5               PUSH    BC
          FA6B F5               PUSH    AF
          FA6C CDD4FA           CALL    LCSO
          FA6F 3E08     V24PUT: LD      A,8
          FA71 81               ADD     C
          FA72 4F               LD      C,A
          FA73 F1               POP     AF
          FA74 ED79             OUT     (C),A   ;Ausgabe
          FA76 C1               POP     BC
          FA77 C9               RET
          FA78
          FA78 F5       V24OT:  PUSH    AF      ;wie OFILT
          FA79 C5       V24OT1: PUSH    BC
          FA7A CDE1FA           CALL    LCSOD
          FA7D 3E0A             LD      A,0AH
          FA7F 81               ADD     C
          FA80 4F               LD      C,A
          FA81 ED78             IN      A,(C)
          FA83 CB57             BIT     2,A
          FA85 2008             JR      NZ,V24OT2
          FA87 3E01             LD      A,1
          FA89 CDE0F1           CALL    WAIT
          FA8C C1               POP     BC
          FA8D 18EA             JR      V24OT1
          FA8F C1       V24OT2: POP     BC
          FA90 F1               POP     AF
          FA91 C5               PUSH    BC
          FA92 F5               PUSH    AF
          FA93 CDE1FA           CALL    LCSOD
          FA96 18D7             JR      V24PUT
          FA98
          FA98 C5       V24IN:  PUSH    BC
          FA99 E5               PUSH    HL
          FA9A D5               PUSH    DE
          FA9B CDE1FA           CALL    LCSOD
          FA9E C5               PUSH    BC
          FA9F 3E0A             LD      A,0AH
          FAA1 81               ADD     C
          FAA2 4F               LD      C,A
          FAA3 ED78             IN      A,(C)
          FAA5 CB47             BIT     0,A     ;bereit?
          FAA7 2015             JR      NZ,V24IN2
          FAA9 3E05             LD      A,5     ;WR5
          FAAB ED79             OUT     (C),A
          FAAD 3EEA             LD      A,0EAH  ;DTR on, 8bit,
          FAAF ED79             OUT     (C),A   ;Senderfreigabe
          FAB1 ED78     V24IN1: IN      A,(C)
          FAB3 CB47             BIT     0,A     ;jetzt bereit?
          FAB5 2007             JR      NZ,V24IN2
          FAB7 CDDEE3           CALL    BRKT
          FABA 3815             JR      C,V24IN4
          FABC 18F3             JR      V24IN1
          FABE
          FABE 3E05     V24IN2: LD      A,5     ;WR5
          FAC0 ED79             OUT     (C),A
          FAC2 3E6A             LD      A,6AH   ;DTR off usw.
          FAC4 ED79             OUT     (C),A
          FAC6 C1               POP     BC
          FAC7 3E08             LD      A,8
          FAC9 81               ADD     C
          FACA 4F               LD      C,A
          FACB ED78             IN      A,(C)   ;Einlesen
          FACD D1       V24IN3: POP     DE
          FACE E1               POP     HL
          FACF C1               POP     BC
          FAD0 C9               RET
          FAD1
          FAD1 C1       V24IN4: POP     BC
          FAD2 18F9             JR      V24IN3
          FAD4
          FAD4          LCSO:   ;Lade C mit SIO-Offset f.V24OUT
          FAD4 F5               PUSH    AF
          FAD5 3AE1B7           LD      A,(HCPZ)
          FAD8 CB57     LCSO1:  BIT     2,A
          FADA 0E01             LD      C,1
          FADC 2001             JR      NZ,LCSOE
          FADE 0D               DEC     C
          FADF F1       LCSOE:  POP     AF
          FAE0 C9               RET
          FAE1
          FAE1          LCSOD:  ;dto. fuer V24DUP
          FAE1 F5               PUSH    AF
          FAE2 3AE8B7           LD      A,(HCPZ2)
          FAE5 18F1             JR      LCSO1
          FAE7
          FAE7          ISRSB:  ;ISR SIO B fuer MC-Load oder
          FAE7                  ;Fremdtastatur
          FAE7 E5               PUSH    HL
          FAE8 D5               PUSH    DE
          FAE9 C5               PUSH    BC
          FAEA F5               PUSH    AF
          FAEB DB09             IN      A,9     ;1.Zeichen
          FAED F5               PUSH    AF
          FAEE 3E18             LD      A,18H   ;Kanal
          FAF0 D30B             OUT     0BH     ;ruecksetzen
          FAF2 3E05             LD      A,5     ;WR5
          FAF4 D30B             OUT     0BH
          FAF6 3E6A             LD      A,6AH   ;DTR off
          FAF8 D30B             OUT     0BH
          FAFA F1               POP     AF
          FAFB CD57FB           CALL    ISB8
          FAFE FE0D             CP      0DH     ;Fremdtastatur?
          FB00 280A             JR      Z,ISB3
          FB02 FE1B             CP      1BH     ;MC-Programm?
          FB04 2813             JR      Z,ISB4
          FB06 CDFBF9   ISB1:   CALL    INIDUP  ;nichts
          FB09 C324E1   ISB2:   JP      POPS4
          FB0C
          FB0C CDFBF9   ISB3:   CALL    INIDUP
          FB0F 215AFB           LD      HL,ISB9 ;Neue ISR
          FB12 F3               DI
          FB13 22E201           LD      (1E2H),HL
          FB16 FB               EI
          FB17 18F0             JR      ISB2
          FB19
          FB19 3E06     ISB4:   LD      A,6
          FB1B 32E8B7           LD      (HCPZ2),A
          FB1E CDF3F9           CALL    V24DUP
          FB21 CD98FA           CALL    V24IN
          FB24 FE54             CP      'T'
          FB26 2806             JR      Z,ISB5  ;MC laden
          FB28 FE55             CP      'U'
          FB2A 281E             JR      Z,ISB7  ;MC starten
          FB2C 18D8             JR      ISB1
          FB2E
          FB2E CD98FA   ISB5:   CALL    V24IN
          FB31 6F               LD      L,A
          FB32 CD98FA           CALL    V24IN
          FB35 67               LD      H,A
          FB36 CD98FA           CALL    V24IN
          FB39 4F               LD      C,A
          FB3A CD98FA           CALL    V24IN
          FB3D 47               LD      B,A
          FB3E CD98FA   ISB6:   CALL    V24IN
          FB41 77               LD      M,A
          FB42 23               INC     HL
          FB43 0B               DEC     BC
          FB44 79               LD      A,C
          FB45 B0               OR      B
          FB46 20F6             JR      NZ,ISB6
          FB48 18BC             JR      ISB1
          FB4A
          FB4A CD98FA   ISB7:   CALL    V24IN
          FB4D 6F               LD      L,A
          FB4E CD98FA           CALL    V24IN
          FB51 67               LD      H,A
          FB52 CD99E1           CALL    JPHL
          FB55 18AF             JR      ISB1
          FB57
          FB57 FB       ISB8:   EI
          FB58 ED4D             RETI
          FB5A
          FB5A FB       ISB9:   EI              ;ISR fuer
          FB5B F5               PUSH    AF      ;V.24-Tastatur
          FB5C DB09             IN      A,9
          FB5E C3B5E3           JP      TST7
          FB61
          FB61          CON:    ;CAOS-ROM C on
          FB61 F5               PUSH    AF
          FB62 DDCB04FE         SET     7,(IX+4)
          FB66 DD7E04           LD      A,(IX+4)
          FB69 D386             OUT     86H
          FB6B F1               POP     AF
          FB6C C9               RET
          FB6D
          FB6D          COFF:   ;CAOS-ROM C off
          FB6D F5               PUSH    AF
          FB6E DDCB04BE         RES     7,(IX+4)
          FB72 DD7E04           LD      A,(IX+4)
          FB75 D386             OUT     86H
          FB77 F1               POP     AF
          FB78 C9               RET
          FB79
          FB79          MULT:   ;BA=D*C                  **41**
          FB79 CD61FB           CALL    CON
          FB7C CD1CC1           CALL    MULC
          FB7F 18EC             JR      COFF
          FB81
          FB81 CD61FB   SQR:    CALL    CON             ;**40**
          FB84 CD0EC1           CALL    SQRC
          FB87 18E4             JR      COFF
          FB89
          FB89          ISRC2:  ;CTC2: Tonlg
          FB89 CD17E6           CALL    INTEND
          FB8C F5               PUSH    AF
          FB8D CDCDE4           CALL    TOFF
          FB90 F1               POP     AF
          FB91 C9               RET
          FB92
          FB92 7B7C7D7E ZIBM:   DB      ''  ;IBM-Kodierung
          FB96 5B5C5D           DB      '-_'   ;fuer S6005
          FB99 849481E1         DB      84H,94H,81H,0E1H
          FB9D 8E999A           DB      8EH,99H,9AH
          FBA0
          FBA0 00       ZEI0:   DB      0       ;CRT
          FBA1 38               DB      38H     ;MBOUT
          FBA2 02       ZEI2:   DB      2       ;UOUT1
          FBA3 03       ZEI3:   DB      3       ;UOUT2
          FBA4 04       ZEI4:   DB      4       ;KBD
          FBA5 37               DB      37H     ;MBIN
          FBA6 06               DB      6       ;UIN1
          FBA7 07               DB      7       ;UIN2
          FBA8
          FBA8 29E3     SUTB:   DW      CRT     ;00
          FBAA 2BE5             DW      MBO     ;01
          FBAC BDB7             DW      UOUT1   ;02
          FBAE C3B7             DW      UOUT2   ;03
          FBB0 38F2             DW      KBD     ;04
          FBB2 91E5             DW      MBI     ;05
          FBB4 C0B7             DW      UIN1    ;06
          FBB6 C6B7             DW      UIN2    ;07
          FBB8 1CE5             DW      ISRO    ;08
          FBBA D9E4             DW      CSRO    ;09
          FBBC 8EE5             DW      ISRI    ;0A
          FBBE FFF5             DW      CSRI    ;0B
          FBC0 CAE3             DW      KBDS    ;0C
          FBC2 F6F0             DW      BYE     ;0D
          FBC4 D5E3             DW      KBDZ    ;0E
          FBC6 21F6             DW      COLR    ;0F
          FBC8 77F5             DW      LOAD    ;10
          FBCA 6AF5             DW      VERIF   ;11
          FBCC 7EF1             DW      LOOP    ;12
          FBCE FAF1             DW      NORM    ;13
          FBD0 E0F1             DW      WAIT    ;14
          FBD2 EBF4             DW      LARG    ;15
          FBD4 17F2             DW      INTB    ;16
          FBD6 34F3             DW      INLIN   ;17
          FBD8 92F3             DW      RHEX    ;18
          FBDA 61F3             DW      ERRM    ;19
          FBDC 54F3             DW      HLHX    ;1A
          FBDE 89F3             DW      HLDE    ;1B
          FBE0 76F3             DW      AHEX    ;1C
          FBE2 B1F1             DW      ZSUCH   ;1D
          FBE4 00F2             DW      SOUT    ;1E
          FBE6 0DF2             DW      SIN     ;1F
          FBE8 FDF1             DW      NOUT    ;20
          FBEA 0AF2             DW      NIN     ;21
          FBEC C7F3             DW      GARG    ;22
          FBEE EEF1             DW      OSTR    ;23
          FBF0 1DF2             DW      OCHR    ;24
          FBF2 4AF7             DW      CUCP    ;25
          FBF4 04E4             DW      MODU    ;26
          FBF6 9BE4             DW      JUMP    ;27
          FBF8 16E3             DW      LDMA    ;28
          FBFA 18E3             DW      LDAM    ;29
          FBFC DEE3             DW      BRKT    ;2A
          FBFE 5CF3             DW      SPACE   ;2B
          FC00 6BF3             DW      CRLF    ;2C
          FC02 72F3             DW      HOME    ;2D
          FC04 5AF6             DW      MODI    ;2E
          FC06 71F7             DW      PUDE    ;2F
          FC08 60F7             DW      PUSE    ;30
          FC0A 0BF4             DW      SIXD    ;31
          FC0C 6AE0             DW      DABR    ;32
          FC0E 5EE0             DW      TCIF    ;33
          FC10 4EE0             DW      PADR    ;34
          FC12 25F9             DW      TON     ;35
          FC14 A5F4             DW      SAVE    ;36
          FC16 73F8             DW      MBIN    ;37
          FC18 6BF8             DW      MBOUT   ;38
          FC1A E2F6             DW      KEY     ;39
          FC1C 41F7             DW      KEYLI   ;3A
          FC1E 41F6             DW      DISP    ;3B
          FC20 94F6             DW      WININ   ;3C
          FC22 9EF6             DW      WINAK   ;3D
          FC24 63F8             DW      LINE    ;3E
          FC26 7AF7             DW      CIRCL   ;3F
          FC28 81FB             DW      SQR     ;40
          FC2A 79FB             DW      MULT    ;41
          FC2C 2AF6             DW      CSTBT   ;42
          FC2E 51F4             DW      INIEA   ;43
          FC30 5AF4             DW      INIME   ;44
          FC32 1CF9             DW      ZKOUT   ;45
          FC34 47F1             DW      MENU    ;46
          FC36 CFF9             DW      V24OUT  ;47
          FC38 F3F9             DW      V24DUP  ;48
          FC3A
          FC3A
          FC3A 5777     KTAB:   DB      'Ww'
          FC3C 4161             DB      'Aa'
          FC3E 3222             DB      '2"'
          FC40 0819             DB      8,19H		; CUL
          FC42 100C             DB      10H,0CH		; HOME
          FC44 2D3D             DB      '-='
          FC46 F2F8             DB      0F2H,0F8H	; F2
          FC48 5979             DB      'Yy'
          FC4A 4565             DB      'Ee'
          FC4C 5373             DB      'Ss'
          FC4E 3323             DB      '3#'
          FC50 5E5D             DB      '^_'
          FC52 010F             DB      1,0FH		; CLR
          FC54 3A2A             DB      ':*'
          FC56 F3F9             DB      0F3H,0F9H	; F3
          FC58 5878             DB      'Xx'
          FC5A 5474             DB      'Tt'
          FC5C 4666             DB      'Ff'
          FC5E 3525             DB      '5%'
          FC60 5070             DB      'Pp'
          FC62 1F02             DB      1FH,2		; DEL
          FC64 3040             DB      '0@'
          FC66 F5FB             DB      0F5H,0FBH	; F5
          FC68 5676             DB      'Vv'
          FC6A 5575             DB      'Uu'
          FC6C 4868             DB      'Hh'
          FC6E 3727             DB      '7',27H
          FC70 4F6F             DB      'Oo'
          FC72 1A14             DB      1AH,14H		; INS
          FC74 3929             DB      '9)'
          FC76 0303             DB      3,3		; BRK
          FC78 4E6E             DB      'Nn'
          FC7A 4969             DB      'Ii'
          FC7C 4A6A             DB      'Jj'
          FC7E 3828             DB      '8('
          FC80 205B             DB      ' -'		; Space
          FC82 4B6B             DB      'Kk'
          FC84 2C3C             DB      ',<'
          FC86 131B             DB      13H,1BH		; STOP
          FC88 4D6D             DB      'Mm'
          FC8A 5A7A             DB      'Zz'
          FC8C 4767             DB      'Gg'
          FC8E 3626             DB      '6&'
          FC90 0000             DB      0,0		; freie Taste
          FC92 4C6C             DB      'Ll'
          FC94 2E3E             DB      '.>'
          FC96 F6FC             DB      0F6H,0FCH	; F6
          FC98 4262             DB      'Bb'
          FC9A 5272             DB      'Rr'
          FC9C 4464             DB      'Dd'
          FC9E 3424             DB      '4$'
          FCA0 5F5C             DB      '_'
          FCA2 2B3B             DB      '+;'
          FCA4 2F3F             DB      '/?'
          FCA6 F4FA             DB      0F4H,0FAH	; F4
          FCA8 4363             DB      'Cc'
          FCAA 5171             DB      'Qq'
          FCAC 1616             DB      16H,16H		; CAPS
          FCAE 3121             DB      '1!'
          FCB0 0A12             DB      0AH,12H		; CUD
          FCB2 0B11             DB      0BH,11H		; CUU
          FCB4 0918             DB      9,18H		; CUR
          FCB6 F1F7             DB      0F1H,0F7H	; F1
          FCB8 0D0D             DB      0DH,0DH		; Enter
          FCBA
          FCBA
          FCBA E7FA     ISRTAB: DW      ISRSB   ;SIO B:Empfang
          FCBC 08E6             DW      ISRPA   ;PIO A:Kassette
          FCBE 45E3             DW      ISRPB   ;PIO B:Tastatur
          FCC0 17E6             DW      INTEND  ;CTC 0:frei
          FCC2 F8E5             DW      ISRC1   ;CTC 1:Kassette
          FCC4 89FB             DW      ISRC2   ;CTC 2:Tondauer
          FCC6 39E3             DW      ISRC3   ;CTC 3:Tastatur
          FCC8
          FCC8
          FCC8 22E3     CRTTAB: DW      NOT     ;00
          FCCA E2E1             DW      CLR     ;01
          FCCC AAE2             DW      CLLN    ;02
          FCCE 22E3             DW      NOT     ;03=BRK
          FCD0 22E3             DW      NOT     ;04
          FCD2 22E3             DW      NOT     ;05
          FCD4 22E3             DW      NOT     ;06
          FCD6 EBE2             DW      BEEP    ;07
          FCD8 C1E1             DW      CUL     ;08
          FCDA AAE1             DW      CUR     ;09
          FCDC B3E1             DW      CUD     ;0A
          FCDE D1E1             DW      CUU     ;0B
          FCE0 37E2             DW      CLS     ;0C
          FCE2 47E2             DW      CBL     ;0D
          FCE4 22E3             DW      NOT     ;0E
          FCE6 BDE1             DW      HCOPY   ;0F
          FCE8 45E2             DW      HOMEPG  ;10
          FCEA D6E1             DW      PAGE    ;11
          FCEC DDE1             DW      SCROL   ;12
          FCEE 22E3             DW      NOT     ;13=STOP
          FCF0 1AE3             DW      CLICK   ;14
          FCF2 22E3             DW      NOT     ;15
          FCF4 22E3             DW      NOT     ;16=CAPS
          FCF6 22E3             DW      NOT     ;17
          FCF8 CBE1             DW      CEL     ;18
          FCFA 47E2             DW      CBL     ;19
          FCFC 18E2             DW      INS     ;1A
          FCFE 23E3             DW      ESC     ;1B
          FD00 22E3             DW      NOT     ;1C=LIST
          FD02 22E3             DW      NOT     ;1D=RUN
          FD04 B1E1             DW      NL      ;1E=CONT
          FD06 E5E1             DW      DEL     ;1F
          FD08
          FD08
          FD08          TOKTAB: ;BASIC-Token
          FD08                  ;(Bit 7 im 1. Byte gesetzt!)
          FD08 C94E4B45         DB      '+NKEY$'
          FD0E CA4F5953         DB      '-OYST'
          FD13 D3545249         DB      '-TRING$'
          FD1A C94E5354         DB      '+NSTR'
          FD1F D2454E55         DB      '-ENUMBER'
          FD27 C4454C45         DB      '-ELETE'
          FD2D D0415553         DB      'AUSE'
          FD32 C2454550         DB      '-EEP'
          FD36 D7494E44         DB      '+INDOW'
          FD3C C24F5244         DB      '-ORDER'
          FD42 C94E4B           DB      '+NK'
          FD45 D0415045         DB      'APER'
          FD4A C154             DB      '-T'
          FD4C C34F4C4F         DB      '+OLOR'
          FD51 D34F554E         DB      '-OUND'
          FD56 D0534554         DB      'SET'
          FD5A D0524553         DB      'RESET'
          FD60 C24C4F41         DB      '-LOAD'
          FD65 D6504545         DB      '-PEEK'
          FD6A D6504F4B         DB      '-POKE'
          FD6F CC4F4341         DB      'OCATE'
          FD75 CB45594C         DB      '-EYLIST'
          FD7C CB4559           DB      '-EY'
          FD7F D3574954         DB      '-WITCH'
          FD85 D0544553         DB      'TEST'
          FD8A C34C4F53         DB      '+LOSE'
          FD8F CF50454E         DB      'PEN'
          FD93 D2414E44         DB      '-ANDOMIZE'
          FD9C D6474554         DB      '-GET$'
          FDA1 CC494E45         DB      'INE'
          FDA5 C3495243         DB      '+IRCLE'
          FDAB C353524C         DB      '+SRLIN'
          FDB1 80               DB      80H
          FDB2
          FDB2          TOKJP:  ;Sprungtabelle fuer BASIC-Token
          FDB2 7DEB             DW      INKEY
          FDB4 FD02             DW      02FDH   ;JOYST
          FDB6 06E7             DW      STRING
          FDB8 24EC             DW      INSTR
          FDBA 65E7             DW      RENUM
          FDBC 45E9             DW      DELETE
          FDBE 6AE9             DW      PAUSE
          FDC0 9EE9             DW      BBEEP
          FDC2 B3E9             DW      WINDOW
          FDC4 89EA             DW      BORDER
          FDC6 FAEA             DW      INK
          FDC8 14EB             DW      PAPER
          FDCA 48C3             DW      0C348H  ;AT
          FDCC 30EB             DW      BCOLOR
          FDCE 98EB             DW      SOUND
          FDD0 DBEB             DW      PSET
          FDD2 0CEC             DW      PRESET
          FDD4 3DEA             DW      BLOAD
          FDD6 48C3             DW      0C348H  ;VPEEK
          FDD8 6CEA             DW      VPOKE
          FDDA 49EB             DW      LOCATE
          FDDC A8EC             DW      KEYLIST
          FDDE 99EC             DW      BKEY
          FDE0 ACEC             DW      SWITCH
          FDE2 48C3             DW      0C348H  ;PTEST
          FDE4 F8EC             DW      CLOSE
          FDE6 39ED             DW      OPEN
          FDE8 33ED             DW      RANDOM
          FDEA 48C3             DW      0C348H  ;VGET
          FDEC 6EED             DW      BLINE
          FDEE 73ED             DW      CIRCLE
          FDF0
          FDF0 00000000         DS      8       ;Rest frei
          FDF8
          FDF8 80402010 BITTAB: DB      80H,40H,20H,10H
          FDFC 08040201         DB      8,4,2,1
          FE00
          FE00                  END

        Errors: 0000
        End+1 : FE00
        
