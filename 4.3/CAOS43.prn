
          0200          ;**     CAOS 4.3 ROM C          **
          0200          ;       (17.02.95)
          0200
          0200                  ORG     0C000H
          C000
          C000          KCTAB   ;IRM-Defaulttabelle
          C000 F0E3             DW      NOT     ;Hardcopy
          C002 00               DB      0       ;WINNR
          C003 0000             DW      0       ;WINON
          C005 2820             DW      2028H   ;WINLG
          C007 0000             DW      0       ;CURSO
          C009 00               DB      0       ;STBT
          C00A 39               DB      39H     ;COLOR
          C00B F2E2             DW      SCRLPG  ;WEND
          C00D 00EE             DW      0EE00H  ;CCTL0
          C00F 00FE             DW      0FE00H  ;1
          C011 00EE             DW      0EE00H  ;2
          C013 00FE             DW      0FE00H  ;3
          C015 C401             DW      1C4H    ;SYSP
          C017 AFFB             DW      SUTB    ;SUTAB
          C019 CFFC             DW      CRTTAB  ;CTAB
          C01B D388             OUT     88H     ;BJUMP
          C01D C312F0           JP      0F012H
          C020 A7FB             DW      ZEI0    ;OUTAB
          C022 ABFB             DW      ZEI4    ;INTAB
          C024 C3ABF4           JP      NOOP    ;UOUT1
          C027 C3ABF4           JP      NOOP    ;UIN1
          C02A C3ABF4           JP      NOOP    ;UOUT2
          C02D C3ABF4           JP      NOOP    ;UIN2
          C030 82DC             DW      0DC82H  ;IOERR (BASIC)
          C032 00B2             DW      0B200H  ;VRAM
          C034
          C034 470C             DB      47H,0CH ;CTC2 (blinken)
          C036 E4ED             DW      ESCTAB  ;L3TAB
          C038 0D               DB      13      ;L3SIZ (0-C)
          C039 05               DB      5       ;COUNT
          C03A 00               DB      0       ;HCPZ
          C03B 01A8             DW      0A801H  ;INTV1
          C03D 08               DB      8       ;INTV1L
          C03E 09A8             DW      0A809H  ;INTV2
          C040 09               DB      9       ;INTV2L
          C041 06               DB      6       ;HCPZ2
          C042 C3ABF4           JP      NOOP    ;OFILT
          C045 25               DB      '%'     ;PROMPT
          C046 FF               DB      0FFH    ;LINTYP
          C047 D8EF             DW      0EFD8H  ;CUMUST
          C049
          C049 03               DB      3       ;RAM0
          C04A 01               DB      1       ;IRM
          C04B 00               DB      0       ;USER-ROMC
          C04C 03               DB      3       ;RAM8
          C04D 03               DB      3       ;RAM4
          C04E 00               DB      0       ;CAOSC
          C04F
          C04F          SYSI    ;Systeminit
          C04F F3               DI
          C050 ED5E             IM      2
          C052 21C2C0           LD      HL,IOTAB
          C055 CD66F5           CALL    INIMEX  ;Ports init.
          C058 DD21F001         LD      IX,1F0H
          C05C DD360128         LD      (IX+1),28H      ;OUT84
          C060 DD3604E3         LD      (IX+4),0E3H     ;OUT86
          C064 1199B7           LD      DE,HCADR
          C067 2100C0           LD      HL,KCTAB;Defaulttab.
          C06A 013400           LD      BC,34H
          C06D EDB0             LDIR            ;1.Stueck
          C06F 0E15             LD      C,15H
          C071 1EDB             LD      E,CTCMD
          C073 EDB0             LDIR            ;2.Stueck
          C075 1100B8           LD      DE,0B800H
          C078 0E04             LD      C,4
          C07A EDB0             LDIR            ;3. Stueck
          C07C 1A               LD      A,(DE)
          C07D E604             AND     4       ;RAM4-Ebene!
          C07F B6               OR      M
          C080 12               LD      (DE),A  ;RAM4
          C081 13               INC     DE
          C082 23               INC     HL
          C083 EDA0             LDI             ;CAOSC
          C085 3E01             LD      A,1
          C087 21C1FC   SIXC    LD      HL,ISRTAB
          C08A 32D7B7           LD      (MIXIT),A
          C08D 1EE2             LD      E,0E2H
          C08F 57               LD      D,A
          C090 010E00           LD      BC,0EH  ;Interrupttab.
          C093 EDB0             LDIR            ;kopieren
          C095 DD6601           LD      H,(IX+1);alte Merker
          C098 DD6E04           LD      L,(IX+4);mitnehmen
          C09B D5               PUSH    DE
          C09C DDE1             POP     IX
          C09E DD360888         LD      (IX+8),88H
          C0A2 DD7401           LD      (IX+1),H;und eintragen
          C0A5 DD7504           LD      (IX+4),L
          C0A8 DD360E41         LD      (IX+14),KTAB    ;Low
          C0AC DD360FFC         LD      (IX+15),KTAB/256;High
          C0B0 DD36097F         LD      (IX+9),7FH
          C0B4 F3               DI
          C0B5 ED5E             IM      2
          C0B7 3AD7B7           LD      A,(MIXIT)
          C0BA ED47             LD      I,A
          C0BC 21DCC0           LD      HL,IOTAB2
          C0BF C366F5           JP      INIMEX  ;Kanaele init.
          C0C2
          C0C2          IOTAB   ;Portinittabelle
          C0C2 07               DB      7
          C0C3 8A               DB      8AH     ;PIO-A-Steuerw.
          C0C4 01                DB     1
          C0C5 E4                 DB    0E4H    ;Int-Vektor
          C0C6 88               DB      88H     ;PIO-A-Daten
          C0C7 02                DB     2
          C0C8 1F                 DB    1FH     ;D005-Reset
          C0C9 0F                 DB    0FH     ;IRM,RAM0,CAOSE
          C0CA 8A               DB      8AH     ;PIO-A-Steuerw.
          C0CB 02                DB     2
          C0CC 0F                 DB    0FH     ;Byte-Out
          C0CD 03                 DB    3       ;DI
          C0CE 8B               DB      8BH     ;PIO-B-Steuerw.
          C0CF 03                DB     3
          C0D0 E6                 DB    0E6H    ;Int-Vektor
          C0D1 0F                 DB    0FH     ;Byte-Out
          C0D2 83                 DB    83H     ;EI
          C0D3 89               DB      89H     ;PIO-B-Daten
          C0D4 01                DB     1
          C0D5 FF                 DB    0FFH    ;Daten
          C0D6 84               DB      84H     ;Port 84H
          C0D7 01                DB     1
          C0D8 28                 DB    28H     ;Ausgabebyte
          C0D9 86               DB      86H     ;Port 86H
          C0DA 01                DB     1
          C0DB E3                 DB    0E3H    ;Ausgabebyte
          C0DC
          C0DC 04       IOTAB2  DB      4
          C0DD 8A               DB      8AH     ;PIO-A-Steuerw.
          C0DE 01                DB     1
          C0DF E4                 DB    0E4H    ;Int-Vektor
          C0E0 8B               DB      8BH     ;PIO-B-Steuerw.
          C0E1 01                DB     1
          C0E2 E6                 DB    0E6H    ;Int-Vektor
          C0E3 8C               DB      8CH     ;CTC0
          C0E4 01                DB     1
          C0E5 E8                 DB    0E8H    ;Int-Vektor CTC
          C0E6 8E               DB      8EH     ;CTC2 (blinken)
          C0E7 02                DB     2
          C0E8 47                 DB    47H     ;DI,Zaehler,RES
          C0E9 0C                 DB    0CH     ;Zeitkonstante
          C0EA
          C0EA          SYSTC   ;Systemcheck
          C0EA D5               PUSH    DE
          C0EB CD9AF3           CALL    OSTR
          C0EE 0D43414F         DB      CR,'CAOSE',0
          C0F5 DB88             IN      A,88H
          C0F7 E601             AND     1
          C0F9 CDBAC1           CALL    WONOF   ;Bit 0
          C0FC CD9AF3           CALL    OSTR
          C0FF 43414F53         DB      'CAOSC',0
          C105 3A05B8           LD      A,(0B805H)
          C108 E601             AND     1
          C10A CDBAC1           CALL    WONOF
          C10D CD9AF3           CALL    OSTR
          C110 524F4D43         DB      'ROMC ',0
          C116 DD7E04           LD      A,(IX+4)
          C119 CB3F             SRL     A       ;Bits 5,6
          C11B CB3F             SRL     A
          C11D CB3F             SRL     A
          C11F CB3F             SRL     A
          C121 CB3F             SRL     A       ;nach Bits 0,1
          C123 2F               CPL
          C124 E633             AND     '3'
          C126 CDC9F3           CALL    OCHR    ;Ebene ausgeben
          C129 DB88             IN      A,88H
          C12B 5F               LD      E,A
          C12C E680             AND     80H
          C12E CDBAC1           CALL    WONOF   ;Bit 7
          C131 1630             LD      D,'0'
          C133 CDADC1           CALL    WRAM    ;RAM0
          C136 CB5B             BIT     3,E
          C138 2001             JR      NZ,SYSC1
          C13A 37               SCF             ;Schreibschutz
          C13B CB4B     SYSC1   BIT     1,E
          C13D CDBAC1           CALL    WONOF
          C140 1634             LD      D,'4'
          C142 CDADC1           CALL    WRAM    ;RAM4
          C145 CDBAF4           CALL    SPACE
          C148 3A04B8           LD      A,(0B804H)
          C14B 0F               RRCA
          C14C 0F               RRCA            ;Bit 2
          C14D E601             AND     1
          C14F C630             ADD     '0'
          C151 CDC9F3           CALL    OCHR    ;Ebene 0/1
          C154 DDCB044E         BIT     1,(IX+4)
          C158 2001             JR      NZ,SYSC2
          C15A 37               SCF             ;Schreibschutz
          C15B DDCB0446 SYSC2   BIT     0,(IX+4)
          C15F CDBAC1           CALL    WONOF
          C162 1638             LD      D,'8'
          C164 CDADC1           CALL    WRAM    ;RAM8
          C167 3E20             LD      A,' '
          C169 CDC9F3           CALL    OCHR
          C16C DD7E01           LD      A,(IX+1)
          C16F CB3F             SRL     A       ;Bits 4,5,6,7
          C171 CB3F             SRL     A
          C173 CB3F             SRL     A
          C175 CB3F             SRL     A       ;nach 0,1,2,3
          C177 D602             SUB     2
          C179 CDDDF4           CALL    AHEX0   ;Ebene ausg.
          C17C DB89             IN      A,89H
          C17E A7               AND     A
          C17F CB77             BIT     6,A
          C181 2001             JR      NZ,SYSC3
          C183 37               SCF             ;Schreibschutz
          C184 CB6F     SYSC3   BIT     5,A
          C186 CDBAC1           CALL    WONOF
          C189 DD7E01           LD      A,(IX+1)
          C18C 5F               LD      E,A
          C18D CD9AF3           CALL    OSTR
          C190 42494C44         DB      'BILD ',0
          C196 CB53             BIT     2,E     ;Zugriffs-Bit
          C198 3E30             LD      A,'0'
          C19A 2801             JR      Z,SYSC4
          C19C 3C               INC     A
          C19D CDC9F3   SYSC4   CALL    OCHR    ;Bildnummer
          C1A0 3A01B8           LD      A,(0B801H)
          C1A3 E601             AND     1       ;IRM on?
          C1A5 CDBAC1           CALL    WONOF
          C1A8 CDC9F4           CALL    CRLF
          C1AB D1               POP     DE
          C1AC C9               RET
          C1AD
          C1AD          WRAM    ;Schreibe 'RAMn'
          C1AD CD9AF3           CALL    OSTR
          C1B0 52414D00         DB      'RAM',0
          C1B4 7A               LD      A,D
          C1B5 CDC9F3           CALL    OCHR
          C1B8 A7               AND     A       ;CY=0
          C1B9 C9               RET
          C1BA
          C1BA          WONOF   ;Schreibe ON, ON* oder OFF
          C1BA 2816             JR      Z,WOF
          C1BC F5               PUSH    AF
          C1BD CD9AF3           CALL    OSTR
          C1C0 204F4E00         DB      ' ON',0
          C1C4 F1               POP     AF
          C1C5 3E20             LD      A,' '
          C1C7 3002             JR      NC,WRR
          C1C9 3E2A             LD      A,'*'   ;Schreibschutz
          C1CB CDC9F3   WRR     CALL    OCHR
          C1CE CDC9F4           CALL    CRLF
          C1D1 C9               RET
          C1D2                  ;
          C1D2 CD9AF3   WOF     CALL    OSTR
          C1D5 204F4646         DB      ' OFF',CR,LF,0
          C1DC C9               RET
          C1DD
          C1DD          MODULC  ;Modulkontrollanzeige
          C1DD D5               PUSH    DE
          C1DE 2E07             LD      L,7     ;ab Platz 7
          C1E0 E5       MODC1   PUSH    HL
          C1E1 3E01             LD      A,1     ;lesen
          C1E3 CD1FC3           CALL    MODUC
          C1E6 7C               LD      A,H
          C1E7 3C               INC     A       ;Kennbyte=FFh?
          C1E8 2824             JR      Z,MODC2 ;kein Modul
          C1EA 7D               LD      A,L
          C1EB CDB7F4           CALL    AHSPC   ;Platz
          C1EE 7C               LD      A,H
          C1EF CDB7F4           CALL    AHSPC   ;Kennbyte
          C1F2 7A               LD      A,D
          C1F3 CDB7F4           CALL    AHSPC   ;Steuerbyte
          C1F6 4C               LD      C,H
          C1F7 061A             LD      B,26    ;Anzahl in MTAB
          C1F9 2117C2           LD      HL,MTAB
          C1FC 7E       MODCC   LD      A,M
          C1FD 23               INC     HL
          C1FE B9               CP      C
          C1FF 2807             JR      Z,MODCA ;Text gefunden
          C201 7E       MODCB   LD      A,M
          C202 23               INC     HL
          C203 A7               AND     A       ;Stringende?
          C204 20FB             JR      NZ,MODCB
          C206 10F4             DJNZ    MODCC
          C208 CDECF8   MODCA   CALL    ZKOUT   ;Modulname
          C20B CDC9F4           CALL    CRLF
          C20E E1       MODC2   POP     HL
          C20F 2C               INC     L       ;Platz+1
          C210 20CE             JR      NZ,MODC1;bis FFh
          C212 CDC9F4           CALL    CRLF
          C215 D1               POP     DE
          C216 C9               RET
          C217
          C217          MTAB    ;Tabelle der Modulnamen
          C217 01535441         DB      001H,'START-ROM',0
          C222 7033324B         DB      070H,'32K EPROM',0
          C22D 72313238         DB      072H,'128K EPROM',0
          C239 73323536         DB      073H,'256K EPROM',0
          C245 7136344B         DB      071H,'64K EPROM',0
          C250 78313238         DB      078H,'128K RAM',0
          C25A 79323536         DB      079H,'256K RAM',0
          C264 7A353132         DB      07AH,'512K RAM',0
          C26E 7B314D20         DB      07BH,'1M RAM',0
          C276 A7464C4F         DB      0A7H,'FLOPPY',0
          C27E DA50494F         DB      0DAH,'PIO-3',0
          C285 DB455052         DB      0DBH,'EPROMMER',0
          C28F E3444155         DB      0E3H,'DAU1',0
          C295 E7414455         DB      0E7H,'ADU1',0
          C29B EE562E32         DB      0EEH,'V.24',0
          C2A1 EF444947         DB      0EFH,'DIG. IN/OUT',0
          C2AE F0384B20         DB      0F0H,'8K CMOS-RAM',0
          C2BB F131364B         DB      0F1H,'16K CMOS-RAM',0
          C2C9 F233324B         DB      0F2H,'32K CMOS-RAM',0
          C2D7 F431364B         DB      0F4H,'16K RAM',0
          C2E0 F533324B         DB      0F5H,'32K RAM',0
          C2E9 F636344B         DB      0F6H,'64K RAM',0
          C2F2 F7384B20         DB      0F7H,'8K EPROM',0
          C2FC F831364B         DB      0F8H,'16K EPROM',0
          C307 FB384B20         DB      0FBH,'8K SOFTWARE',0
          C314 FC424153         DB      0FCH,'BASIC',0
          C31B 3F3F3F00         DB      '???',0
          C31F
          C31F          MODUC   ;Module schalten
          C31F 26B8             LD      H,0B8H  ;H(ModulStSp)
          C321 0E80             LD      C,80H   ;I/O-Adr.
          C323 45               LD      B,L
          C324 FE02             CP      2       ;Parameter?
          C326 3004             JR      NC,MODU1
          C328 56               LD      D,M     ;nur lesen
          C329 ED60     RSTRB   IN      H,(C)
          C32B C9               RET
          C32C
          C32C 7E       MODU1   LD      A,M     ;alter Zustand
          C32D 72               LD      M,D     ;eintragen
          C32E 67               LD      H,A     ;fuer 2. RAM4
          C32F 7D               LD      A,L
          C330 FE06             CP      6       ;interne Module?
          C332 3804             JR      C,MODU2
          C334 ED51             OUT     (C),D   ;Senden Steuerb.
          C336 18F1             JR      RSTRB
          C338
          C338 45       MODU2   LD      B,L
          C339 04               INC     B
          C33A DB88             IN      A,(88H)
          C33C 1010             DJNZ    MODU3
          C33E E6F5             AND     0F5H    ;0=RAM0
          C340 CB42             BIT     0,D
          C342 2835             JR      Z,OUT88
          C344 CBCF             SET     1,A
          C346 CB4A             BIT     1,D
          C348 282F             JR      Z,OUT88
          C34A CBDF             SET     3,A
          C34C 182B             JR      OUT88
          C34E
          C34E 100A     MODU3   DJNZ    MODU4
          C350 CB42             BIT     0,D     ;1=IRM
          C352 CB97             RES     2,A
          C354 2823             JR      Z,OUT88
          C356 CBD7             SET     2,A
          C358 181F             JR      OUT88
          C35A
          C35A 1021     MODU4   DJNZ    MODU5
          C35C 7A               LD      A,D     ;2=ROMC
          C35D 2F               CPL             ;negieren
          C35E 87               ADD     A
          C35F E660             AND     60H     ;ausfiltern
          C361 67               LD      H,A
          C362 F3               DI
          C363 DD7E04           LD      A,(IX+4)
          C366 E69F             AND     9FH
          C368 B4               OR      H       ;einbauen
          C369 DD7704           LD      (IX+4),A
          C36C D386             OUT     86H
          C36E FB               EI
          C36F DB88             IN      A,88H
          C371 CB42             BIT     0,D
          C373 CBBF             RES     7,A     ;aus
          C375 2802             JR      Z,OUT88
          C377 CBFF             SET     7,A     ;ein
          C379 D388     OUT88   OUT     88H
          C37B 1827             JR      STBFF
          C37D
          C37D 1028     MODU5   DJNZ    MODU6
          C37F DB89             IN      A,89H   ;3=RAM8
          C381 E69F             AND     9FH
          C383 CB42             BIT     0,D
          C385 2808             JR      Z,SRAM8 ;wenn aus dann
          C387 CBEF             SET     5,A
          C389 CB4A             BIT     1,D     ;Schreibschutz
          C38B 2802             JR      Z,SRAM8 ;unerheblich
          C38D CBF7             SET     6,A
          C38F D389     SRAM8   OUT     89H
          C391 7A               LD      A,D
          C392 07               RLCA
          C393 07               RLCA
          C394 C620             ADD     20H     ;Segm.-Verschieb
          C396 E6F0             AND     0F0H
          C398 67               LD      H,A
          C399 DD7E01           LD      A,(IX+1)
          C39C E60F             AND     0FH
          C39E B4               OR      H       ;RAM8-Segment
          C39F D384             OUT     84H
          C3A1 DD7701           LD      (IX+1),A
          C3A4 26FF     STBFF   LD      H,0FFH
          C3A6 C9               RET
          C3A7
          C3A7 10FB     MODU6   DJNZ    STBFF   ;5=CAOSC
          C3A9 7A               LD      A,D     ;4=RAM4
          C3AA AC               XOR     H
          C3AB E604             AND     4       ;Aenderung?
          C3AD 2840             JR      Z,RAM41
          C3AF DD7E04           LD      A,(IX+4)
          C3B2 F603             OR      3
          C3B4 F3               DI
          C3B5 D386             OUT     86H     ;RAM4 on
          C3B7 D5               PUSH    DE
          C3B8 E5               PUSH    HL
          C3B9 DB88             IN      A,(88H)
          C3BB F5               PUSH    AF
          C3BC CB87             RES     0,A
          C3BE D388             OUT     (88H),A ;CAOSE off
          C3C0 DD7E01           LD      A,(IX+1)
          C3C3 F5               PUSH    AF
          C3C4 E6F9             AND     0F9H
          C3C6 2E03             LD      L,3     ;3 IRM-Ebenen
          C3C8 010010           LD      BC,1000H;800H frei!
          C3CB 110040           LD      DE,4000H
          C3CE C602     R4IS    ADD     2
          C3D0 D384             OUT     (84H),A ;IRM-Ebene
          C3D2 67               LD      H,A
          C3D3 E5               PUSH    HL
          C3D4 2100A8           LD      HL,0A800H
          C3D7 1A       R4MV    LD      A,(DE)
          C3D8 EDA0             LDI
          C3DA 2B               DEC     HL
          C3DB 77               LD      M,A
          C3DC 23               INC     HL
          C3DD EAD7C3           JP      PE,R4MV
          C3E0 E1               POP     HL
          C3E1 7C               LD      A,H
          C3E2 0618             LD      B,18H   ;jetzt 1800H!
          C3E4 2D               DEC     L
          C3E5 20E7             JR      NZ,R4IS
          C3E7 F1               POP     AF
          C3E8 D384             OUT     (84H)   ;IRM wie zuvor
          C3EA F1               POP     AF
          C3EB D388             OUT     (88H)   ;CAOSE on
          C3ED E1               POP     HL
          C3EE D1               POP     DE
          C3EF DD7E04   RAM41   LD      A,(IX+4)
          C3F2 E6FC             AND     0FCH
          C3F4 CB42             BIT     0,D
          C3F6 2808             JR      Z,SRAM4
          C3F8 CBC7             SET     0,A
          C3FA CB4A             BIT     1,D
          C3FC 2802             JR      Z,SRAM4
          C3FE CBCF             SET     1,A
          C400 DD7704   SRAM4   LD      (IX+4),A
          C403 D386             OUT     86H
          C405 FB               EI
          C406 189C             JR      STBFF
          C408
          C408          KEYC    ;F-Taste belegen
          C408 2100B9           LD      HL,0B900H
          C40B A7               AND     A
          C40C 2007             JR      NZ,KEY0
          C40E 069C             LD      B,9CH
          C410 77       KEYCL   LD      M,A     ;loeschen
          C411 2C               INC     L
          C412 10FC             DJNZ    KEYCL
          C414 C9               RET
          C415 FE10     KEY0    CP      16
          C417 D0               RET     NC      ;nur F1 bis FF
          C418 47               LD      B,A
          C419 F6F0             OR      0F0H
          C41B 4F               LD      C,A
          C41C 7E       KEY1    LD      A,M     ;B Dummys
          C41D 2C               INC     L       ;auszaehlen
          C41E C8               RET     Z
          C41F A7               AND     A
          C420 20FA             JR      NZ,KEY1
          C422 10F8             DJNZ    KEY1
          C424 7D               LD      A,L
          C425 FE9C             CP      9CH
          C427 D0               RET     NC
          C428 ED5BA0B7         LD      DE,(CURSO)
          C42C CDE5C4           CALL    KEYDI   ;praesentieren
          C42F CDC3F3   KEY2    CALL    INTB
          C432 FE13             CP      13H
          C434 2003             JR      NZ,KEY3
          C436 04               INC     B       ;Umschaltung
          C437 18F6             JR      KEY2
          C439 CB40     KEY3    BIT     0,B
          C43B 280D             JR      Z,KEY4  ;interpret.
          C43D FE03             CP      3
          C43F 2870             JR      Z,KEY12 ;BRK=Abbruch
          C441 FE0D             CP      CR
          C443 280A             JR      Z,KEY5  ;Enter=belegen
          C445 CDC9F3           CALL    OCHR
          C448 18E5             JR      KEY2
          C44A CD5AF7   KEY4    CALL    CSTBT
          C44D 18E0             JR      KEY2
          C44F                  ;
          C44F E5       KEY5    PUSH    HL      ;Pos. in Puffer
          C450 CD7CE0           CALL    DABR
          C453 EB               EX      DE,HL
          C454 CDF0F4           CALL    RHEX    ;Fn lesen
          C457 E1               POP     HL
          C458 3806             JR      C,KERR  ;Formatfehler
          C45A 3A97B7           LD      A,(NUMVX)
          C45D B9               CP      C       ;geaendert!
          C45E 2806             JR      Z,KEY6
          C460 CDC9F4   KERR    CALL    CRLF
          C463 C3BFF4           JP      ERRM
          C466 13       KEY6    INC     DE
          C467 13               INC     DE
          C468 069B             LD      B,9BH
          C46A 2F               CPL
          C46B A7               AND     A
          C46C 2821             JR      Z,KEY8  ;KEY F
          C46E 3C               INC     A
          C46F 47               LD      B,A
          C470 4D               LD      C,L
          C471 7E       KEY7    LD      A,M
          C472 2C               INC     L
          C473 28EB             JR      Z,KERR  ;Puffer voll!
          C475 A7               AND     A
          C476 20F9             JR      NZ,KEY7
          C478 10F7             DJNZ    KEY7    ;Ende suchen
          C47A 2D               DEC     L
          C47B 7D               LD      A,L
          C47C FE9C             CP      9CH
          C47E 30E0             JR      NC,KERR ;Puffer voll!
          C480 44               LD      B,H
          C481 C5               PUSH    BC
          C482 91               SUB     C
          C483 4F               LD      C,A
          C484 0600             LD      B,0
          C486 D5               PUSH    DE
          C487 119BB9           LD      DE,0B99BH
          C48A EDB8             LDDR            ;Rest hinter
          C48C 43               LD      B,E
          C48D D1               POP     DE
          C48E E1               POP     HL
          C48F 4F       KEY8    LD      C,A
          C490 2D       KEY9    DEC     L
          C491 7E               LD      A,M
          C492 A7               AND     A
          C493 20FB             JR      NZ,KEY9 ;zurueck bis 0
          C495 2C       KEY10   INC     L
          C496 1A               LD      A,(DE)
          C497 13               INC     DE
          C498 77               LD      M,A     ;belegen
          C499 B7               OR      A
          C49A 2808             JR      Z,KEY11
          C49C 78               LD      A,B
          C49D 95               SUB     L
          C49E 20F5             JR      NZ,KEY10
          C4A0 3600             LD      M,0
          C4A2 18BC             JR      KERR
          C4A4 79       KEY11   LD      A,C
          C4A5 A7               AND     A
          C4A6 2809             JR      Z,KEY12 ;KEY F
          C4A8 04               INC     B
          C4A9 2C               INC     L
          C4AA 5D               LD      E,L
          C4AB 54               LD      D,H
          C4AC 68               LD      L,B
          C4AD 0600             LD      B,0
          C4AF EDB0             LDIR            ;Rest nach vorn
          C4B1 C3C9F4   KEY12   JP      CRLF
          C4B4
          C4B4          KEYLIC  ;Anzeige belegter F-Tasten
          C4B4 2101B9           LD      HL,0B901H
          C4B7 01F100           LD      BC,0F1H
          C4BA 7E       KEYLC1  LD      A,M
          C4BB A7               AND     A
          C4BC 2807             JR      Z,KEYLC2
          C4BE CDE5C4           CALL    KEYDI   ;Belegung
          C4C1 CDC9F4           CALL    CRLF
          C4C4 04               INC     B       ;Zaehler
          C4C5 2C       KEYLC2  INC     L
          C4C6 7D               LD      A,L
          C4C7 FE9C             CP      9CH
          C4C9 3003             JR      NC,KEYLC3
          C4CB 0C               INC     C
          C4CC 20EC             JR      NZ,KEYLC1 ;F1 bis FF
          C4CE 04       KEYLC3  INC     B
          C4CF 05               DEC     B
          C4D0 C0               RET     NZ
          C4D1 CD9AF3           CALL    OSTR
          C4D4 462D5461         DB      'F-Tasten leer'
          C4E1 0D0A00           DB      CR,LF,0
          C4E4 C9               RET
          C4E5
          C4E5 3E02     KEYDI   LD      A,2
          C4E7 CDC9F3           CALL    OCHR    ;Zeile loeschen
          C4EA 79               LD      A,C
          C4EB CD97F3           CALL    AHOSTR  ;Fn
          C4EE 203A00           DB      ' :',0
          C4F1 7E       KEYD1   LD      A,M
          C4F2 B7               OR      A
          C4F3 C8               RET     Z
          C4F4 CD5AF7           CALL    CSTBT
          C4F7 23               INC     HL
          C4F8 7D               LD      A,L
          C4F9 FE9C             CP      9CH
          C4FB D0               RET     NC
          C4FC 18F3             JR      KEYD1
          C4FE
          C4FE          SQRC    ;Quadratwurzel 16Bit A=SQR(HL)
          C4FE A7               AND     A       ;CY=0
          C4FF 11FFFF           LD      DE,0FFFFH
          C502 13       SQ1     INC     DE
          C503 13               INC     DE
          C504 ED52             SBC     HL,DE
          C506 30FA             JR      NC,SQ1
          C508 7B               LD      A,E
          C509 CB3A             SRL     D
          C50B 1F               RRA             ;A=RADIUS
          C50C C9               RET
          C50D
          C50D          MULC    ;Multiplikation BA=C*D
          C50D 0600             LD      B,0
          C50F 1E09             LD      E,9
          C511 7A       MULC1   LD      A,D
          C512 1F               RRA
          C513 1D               DEC     E
          C514 C8               RET     Z
          C515 57               LD      D,A
          C516 78               LD      A,B
          C517 3001             JR      NC,MULC2
          C519 81               ADD     C
          C51A 1F       MULC2   RRA
          C51B 47               LD      B,A
          C51C 18F3             JR      MULC1   ;8*
          C51E
          C51E A7       COLRC   AND     A
          C51F 2015             JR      NZ,SETCO
          C521                  ;aktuelle Farben anzeigen
          C521 3AA3B7           LD      A,(COLOR)
          C524 6F               LD      L,A
          C525 0F               RRCA
          C526 0F               RRCA
          C527 0F               RRCA
          C528 E61F             AND     1FH
          C52A CDB7F4           CALL    AHSPC
          C52D 7D               LD      A,L
          C52E E607             AND     7
          C530 CDD4F4           CALL    AHEX
          C533 C3C9F4           JP      CRLF
          C536          SETCO   ;Farbe setzen (aus L und E)
          C536 3E1F             LD      A,1FH
          C538 A5               AND     L
          C539 17               RLA
          C53A 17               RLA
          C53B 17               RLA
          C53C 6F               LD      L,A
          C53D 3A81B7           LD      A,(ARGN)
          C540 FE02             CP      2
          C542 7B               LD      A,E
          C543 3003             JR      NC,COLRC1
          C545 3AA3B7           LD      A,(COLOR);Hintergrund
          C548 E607     COLRC1  AND     7
          C54A B5               OR      L
          C54B 32A3B7           LD      (COLOR),A
          C54E C9               RET
          C54F
          C54F          WINDC   ;WINDOW-Menuewort
          C54F A7               AND     A       ;Kein Arg?
          C550 2820             JR      Z,WINAKC;Aufruf No.0
          C552 3D               DEC     A       ;1 Arg?
          C553 7D               LD      A,L     ;nr
          C554 281C             JR      Z,WINAKC;Aufruf No.L
          C556 65               LD      H,L     ;za
          C557 69               LD      L,C     ;sa
          C558 53               LD      D,E     ;zn
          C559 3A88B7           LD      A,(ARG4)
          C55C 5F               LD      E,A     ;sn
          C55D 3A81B7           LD      A,(ARGN)
          C560 FE04             CP      4
          C562 380A             JR      C,WINC2 ;2..3 Arg
          C564 3E00             LD      A,0
          C566 2803             JR      Z,WINC1 ;4 Arg
          C568 3A8AB7           LD      A,(ARG5);nr
          C56B CDA2C5   WINC1   CALL    WININC
          C56E DABFF4   WINC2   JP      C,ERRM
          C571 C9               RET
          C572
          C572          WINAKC  ;def. Fenster aufrufen
          C572 CD8FC5           CALL    WCOPY
          C575 329BB7           LD      (WINNR),A
          C578 CD82C5           CALL    PART    ;Fenster A
          C57B D8               RET     C       ;holen
          C57C EB               EX      DE,HL
          C57D 119CB7           LD      DE,WINON
          C580 181A             JR      WCOP1
          C582
          C582          PART    ;Testet A und berechnet Pos.
          C582                  ;in Fenstervektorspeicher =DE
          C582 C6F6             ADD     0F6H
          C584 D8               RET     C       ;zu groî
          C585 87               ADD     A
          C586 5F               LD      E,A
          C587 87               ADD     A
          C588 87               ADD     A
          C589 83               ADD     E
          C58A 5F               LD      E,A
          C58B 16B9             LD      D,0B9H
          C58D A7               AND     A
          C58E C9               RET
          C58F
          C58F          WCOPY   ;Fenster (WINNR) retten
          C58F F5               PUSH    AF
          C590 3A9BB7           LD      A,(WINNR)
          C593 CD82C5           CALL    PART
          C596 383D             JR      C,WINIE ;Fehler
          C598 F1               POP     AF
          C599 219CB7           LD      HL,WINON
          C59C 010A00   WCOP1   LD      BC,10
          C59F EDB0             LDIR
          C5A1 C9               RET
          C5A2
          C5A2          WININC  ;Initialisierung eines Fensters
          C5A2 F5               PUSH    AF
          C5A3 FE0A             CP      10      ;No.
          C5A5 302E             JR      NC,WINIE
          C5A7 7A               LD      A,D     ;Zeilen
          C5A8 A7               AND     A
          C5A9 282A             JR      Z,WINIE
          C5AB 84               ADD     H
          C5AC 3827             JR      C,WINIE
          C5AE FE21             CP      21H
          C5B0 3023             JR      NC,WINIE
          C5B2 7B               LD      A,E     ;Spalten
          C5B3 A7               AND     A
          C5B4 281F             JR      Z,WINIE
          C5B6 85               ADD     L
          C5B7 381C             JR      C,WINIE
          C5B9 FE29             CP      29H
          C5BB 3018             JR      NC,WINIE
          C5BD F1               POP     AF
          C5BE D5               PUSH    DE
          C5BF E5               PUSH    HL
          C5C0 CD8FC5           CALL    WCOPY
          C5C3 E1               POP     HL
          C5C4 D1               POP     DE
          C5C5 229CB7           LD      (WINON),HL
          C5C8 ED539EB7         LD      (WINLG),DE
          C5CC ED43A0B7         LD      (CURSO),BC
          C5D0 329BB7           LD      (WINNR),A
          C5D3 A7               AND     A
          C5D4 C9               RET
          C5D5                  ;
          C5D5 F1       WINIE   POP     AF      ;Fehlerende
          C5D6 37               SCF
          C5D7 C9               RET
          C5D8
          C5D8          LINEC   ;Linie zeichnen von
          C5D8          ;       (ARG1)/(ARG2) nach (ARG3)/(ARG4)
          C5D8 ED5B84B7          LD     DE,(ARG2) ;YANF
          C5DC 2A88B7            LD     HL,(ARG4) ;YEND
          C5DF D9                EXX
          C5E0 ED5B82B7         LD      DE,(ARG1) ;XANF
          C5E4 D5               PUSH    DE
          C5E5 2A86B7           LD      HL,(ARG3) ;XEND
          C5E8 3E08             LD      A,8     ;X=Master
          C5EA B7               OR      A
          C5EB ED52             SBC     HL,DE   ;HL=XSTEPS
          C5ED 3006             JR      NC,LINC1;vorwaerts
          C5EF 19               ADD     HL,DE
          C5F0 EB               EX      DE,HL
          C5F1 F601             OR      1       ;rueckwaerts
          C5F3 ED52             SBC     HL,DE
          C5F5 D9       LINC1    EXX
          C5F6 D5                PUSH   DE      ;YANF
          C5F7 ED52              SBC    HL,DE   ;HL'=YSTEPS
          C5F9 3006              JR     NC,LINC2;steigend
          C5FB 19                ADD    HL,DE
          C5FC EB                EX     DE,HL
          C5FD F602              OR     2       ;fallend
          C5FF ED52              SBC    HL,DE
          C601 E5       LINC2    PUSH   HL      ;YSTEPS
          C602 D9                EXX            ;HL=XSTEPS
          C603 C1               POP     BC      ;BC=YSTEPS
          C604 E5               PUSH    HL
          C605 ED42             SBC     HL,BC   ;flach/steil?
          C607 E1               POP     HL
          C608 C5               PUSH    BC
          C609 3005             JR      NC,LINC3;flach
          C60B E3               EX      (SP),HL
          C60C CB9F             RES     3,A     ;X=Slave
          C60E CBD7             SET     2,A     ;Y=Master
          C610 E5       LINC3   PUSH    HL      ;HL=MAX(STEPS)
          C611 44               LD      B,H
          C612 4D               LD      C,L     ;Pixelzaehler
          C613 D9                EXX
          C614 C1                POP    BC      ;BC'=MAX(...)
          C615 D1                POP    DE      ;DE'=MIN(...)
          C616 60                LD     H,B
          C617 69                LD     L,C
          C618 CB3C              SRL    H       ;Slave mit 1/2
          C61A CB1D              RR     L       ;HL=1/2*MAX(...)
          C61C D9                EXX
          C61D D1               POP     DE      ;DE=YANF
          C61E E1               POP     HL      ;HL=XANF
          C61F
          C61F                  ;Hauptschleife
          C61F          ;AF Bitregister
          C61F          ;HL lfd. X-Koordinate   HL' Slave
          C61F          ;DE lfd. Y-Koordinate   DE' -Master
          C61F          ;BC Punktezaehler       BC' +Master
          C61F
          C61F F5       LINCS   PUSH    AF
          C620 08               EX      AF,AF'  ;Bitreg merken
          C621 F1               POP     AF
          C622 E5               PUSH    HL
          C623 21EDB7           LD      HL,LINTYP
          C626 CB06             RLC     M
          C628 E1               POP     HL
          C629 DCD9C6           CALL    C,SHLDE;Punkt setzen
          C62C D9                EXX
          C62D A7                AND    A
          C62E ED52              SBC    HL,DE   ;-Master subtr.
          C630 3001              JR     NC,LINC4;kein Uebertrag-
          C632                                  ;kein Sprung!
          C632 09                ADD    HL,BC   ;+Master add.
          C633                                  ;CY bleibt =1!
          C633 D9       LINC4    EXX
          C634 3002             JR      NC,LINC5
          C636 F60C             OR      0CH     ;X und Y!
          C638 CB5F     LINC5   BIT     3,A     ;X?
          C63A 2807             JR      Z,LINC6
          C63C 23               INC     HL
          C63D CB47             BIT     0,A
          C63F 2802             JR      Z,LINC6
          C641 2B               DEC     HL
          C642 2B               DEC     HL
          C643 CB57     LINC6   BIT     2,A     ;Y?
          C645 2807             JR      Z,LINC7
          C647 13               INC     DE
          C648 CB4F             BIT     1,A
          C64A 2802             JR      Z,LINC7
          C64C 1B               DEC     DE
          C64D 1B               DEC     DE
          C64E 78       LINC7   LD      A,B
          C64F B1               OR      C       ;letzter Punkt?
          C650 C8               RET     Z
          C651 0B               DEC     BC
          C652 08               EX      AF,AF'  ;Bitreg
          C653 18CA             JR      LINCS
          C655
          C655          PUSEC   ;Punkt setzen
          C655 E5               PUSH    HL
          C656 D5               PUSH    DE
          C657 C5               PUSH    BC
          C658 CD54C7           CALL    CALHV   ;berechnen
          C65B D4E8C6           CALL    NC,PUSET;& setzen
          C65E C1               POP     BC
          C65F D1               POP     DE
          C660 E1               POP     HL
          C661 C9               RET
          C662
          C662          CIRCLC  ;Kreis zeichnen
          C662 3A86B7           LD      A,(ARG3)
          C665 4F               LD      C,A
          C666 69               LD      L,C
          C667 AF               XOR     A
          C668 0608             LD      B,8
          C66A CB1D             RR      L
          C66C 3001     CIR1    JR      NC,CIR2
          C66E 81               ADD     C
          C66F 1F       CIR2    RRA
          C670 CB1D             RR      L
          C672 10F8             DJNZ    CIR1
          C674 67               LD      H,A     ;Achtelkreis
          C675 54               LD      D,H     ;berechnen
          C676 5D               LD      E,L
          C677 79               LD      A,C
          C678 CB21             SLA     C
          C67A CB10             RL      B
          C67C 0B               DEC     BC
          C67D C5               PUSH    BC
          C67E 010100           LD      BC,1
          C681 D9               EXX
          C682 4F               LD      C,A
          C683 0600             LD      B,0H
          C685 E5       CIR3    PUSH    HL
          C686 21EDB7           LD      HL,LINTYP
          C689 CB06             RLC     M
          C68B E1               POP     HL
          C68C 3006             JR      NC,CIRN
          C68E CDB3C6           CALL    CIRUP   ;und jeweils 8
          C691 CDB3C6           CALL    CIRUP   ;Punkte setzen
          C694 D9       CIRN    EXX
          C695 A7               AND     A
          C696 ED42             SBC     HL,BC
          C698 03               INC     BC
          C699 03               INC     BC
          C69A ED52             SBC     HL,DE
          C69C 19               ADD     HL,DE
          C69D D9               EXX
          C69E 300C             JR      NC,CIR4
          C6A0 D9               EXX
          C6A1 E3               EX      (SP),HL
          C6A2 EB               EX      DE,HL
          C6A3 A7               AND     A
          C6A4 ED52             SBC     HL,DE
          C6A6 1B               DEC     DE
          C6A7 1B               DEC     DE
          C6A8 EB               EX      DE,HL
          C6A9 E3               EX      (SP),HL
          C6AA D9               EXX
          C6AB 0D               DEC     C
          C6AC 04       CIR4    INC     B
          C6AD 79               LD      A,C
          C6AE B8               CP      B
          C6AF 30D4             JR      NC,CIR3
          C6B1 F1               POP     AF
          C6B2 C9               RET
          C6B3
          C6B3          CIRUP   ;setzt 4 Punkte um Mittelpunkt
          C6B3 78               LD      A,B
          C6B4 41               LD      B,C
          C6B5 4F               LD      C,A
          C6B6 AF               XOR     A
          C6B7 57               LD      D,A
          C6B8 2A84B7           LD      HL,(ARG2)
          C6BB E5               PUSH    HL
          C6BC 59               LD      E,C
          C6BD 19               ADD     HL,DE
          C6BE CDC7C6           CALL    CIRUP1
          C6C1 AF               XOR     A
          C6C2 57               LD      D,A
          C6C3 E1               POP     HL
          C6C4 59               LD      E,C
          C6C5 ED52             SBC     HL,DE
          C6C7 E5       CIRUP1  PUSH    HL
          C6C8 2A82B7           LD      HL,(ARG1)
          C6CB 58               LD      E,B
          C6CC A7               AND     A
          C6CD ED52             SBC     HL,DE
          C6CF D1               POP     DE
          C6D0 CDD9C6           CALL    SHLDE
          C6D3 D5               PUSH    DE
          C6D4 57               LD      D,A
          C6D5 58               LD      E,B
          C6D6 19               ADD     HL,DE
          C6D7 19               ADD     HL,DE
          C6D8 D1               POP     DE
          C6D9                  ;
          C6D9          SHLDE   ;setzt Punkt auf Pos. HL/DE
          C6D9                  ;(wenn moeglich)
          C6D9 E5               PUSH    HL
          C6DA D5               PUSH    DE
          C6DB C5               PUSH    BC
          C6DC F5               PUSH    AF
          C6DD CD5DC7           CALL    CALXY   ;berechnen
          C6E0 D4E8C6           CALL    NC,PUSET;& setzen
          C6E3 F1               POP     AF
          C6E4 C1               POP     BC
          C6E5 D1               POP     DE
          C6E6 E1               POP     HL
          C6E7 C9               RET
          C6E8                  ;
          C6E8 DDCB015E PUSET   BIT     3,(IX+1)
          C6EC 2826             JR      Z,HIRES ;HiRes
          C6EE CB4A             BIT     1,D
          C6F0 201E             JR      NZ,PUERA
          C6F2 CB42             BIT     0,D
          C6F4 2003             JR      NZ,PUXOR
          C6F6 B6               OR      M       ;setzen
          C6F7 1803             JR      PUCOL
          C6F9 AE       PUXOR   XOR     M       ;alternierend
          C6FA CB82             RES     0,D
          C6FC 77       PUCOL   LD      M,A
          C6FD DD7E01           LD      A,(IX+1)
          C700 5F               LD      E,A
          C701 EE02             XOR     2       ;Farbebene
          C703 F3               DI
          C704 D384             OUT     84H
          C706 7E               LD      A,M
          C707 E607             AND     7
          C709 B2               OR      D
          C70A 77               LD      M,A     ;neue vFarbe
          C70B 7B               LD      A,E
          C70C D384             OUT     84H
          C70E FB               EI
          C70F C9               RET
          C710 2F       PUERA   CPL
          C711 A6               AND     M       ;loeschen
          C712 77               LD      M,A
          C713 C9               RET
          C714                  ;
          C714 47       HIRES   LD      B,A
          C715 B6               OR      M       ;Bit setzen in
          C716 CB5A             BIT     3,D     ;Pixelebene?
          C718 2001             JR      NZ,HIR1
          C71A A8               XOR     B       ;wieder loeschen
          C71B 77       HIR1    LD      M,A
          C71C DD7E01           LD      A,(IX+1)
          C71F 4F               LD      C,A
          C720 EE02             XOR     2
          C722 F3               DI
          C723 D384             OUT     84H
          C725 78               LD      A,B
          C726 B6               OR      M       ;Bit setzen in
          C727 CB62             BIT     4,D     ;Farbebene?
          C729 2001             JR      NZ,HIR2
          C72B A8               XOR     B       ;wieder loeschen
          C72C 77       HIR2    LD      M,A
          C72D 79               LD      A,C
          C72E D384             OUT     84H
          C730 FB               EI
          C731 C9               RET
          C732
          C732          PUDEC   ;Punkt loeschen, PA: A=Farbbyte
          C732 E5               PUSH    HL
          C733 D5               PUSH    DE
          C734 C5               PUSH    BC
          C735 CD54C7           CALL    CALHV
          C738 3816             JR      C,PUDEE ;auîerhalb
          C73A 47               LD      B,A     ;Bit
          C73B 4E               LD      C,M
          C73C 2F               CPL
          C73D A1               AND     C
          C73E 77               LD      M,A     ;loeschen
          C73F DD7E01           LD      A,(IX+1)
          C742 5F               LD      E,A
          C743 EE02             XOR     2
          C745 F3               DI
          C746 D384             OUT     84H
          C748 56               LD      D,M     ;Farbbyte
          C749 7B               LD      A,E
          C74A D384             OUT     84H
          C74C FB               EI
          C74D 78               LD      A,B     ;Z=1: Punkt
          C74E A1               AND     C       ;war geloescht
          C74F 7A               LD      A,D     ;Farbbyte
          C750 C1       PUDEE   POP     BC
          C751 D1               POP     DE
          C752 E1               POP     HL
          C753 C9               RET
          C754
          C754          ;Grafikposition berechnen
          C754          ;HL=X-Koor., DE=Y-Koor.
          C754          ;PA:    CY=1    auîerhalb
          C754          ;HL=IRM-Adr, A=Bitmaske, D=Farb
          C754
          C754 2AD3B7   CALHV   LD      HL,(HOR)
          C757 ED5BD5B7         LD      DE,(VERT)
          C75B 1600             LD      D,0
          C75D C5       CALXY   PUSH    BC
          C75E 01F8FD           LD      BC,BITTAB
          C761 7D               LD      A,L
          C762 E607             AND     7
          C764 81               ADD     C
          C765 4F               LD      C,A     ;Bit
          C766 7D               LD      A,L
          C767 CB3C             SRL     H
          C769 1F               RRA
          C76A CB3C             SRL     H
          C76C 1F               RRA
          C76D CB3C             SRL     H
          C76F 1F               RRA             ;Spalte
          C770 FE28             CP      28H
          C772 3011             JR      NC,CALEN
          C774 F680             OR      80H     ;IRM
          C776 67               LD      H,A
          C777 3EFF             LD      A,0FFH
          C779 82               ADD     D
          C77A 3809             JR      C,CALEN
          C77C AB               XOR     E       ;CY=0!
          C77D 6F               LD      L,A     ;Zeile
          C77E 3AD6B7           LD      A,(FARB)
          C781 57               LD      D,A
          C782 0A               LD      A,(BC)  ;MASKE fuer X
          C783 C1               POP     BC
          C784 C9               RET
          C785 C1       CALEN   POP     BC      ;auîerhalb
          C786 37               SCF
          C787 C9               RET
          C788
          C788          DPMEMO  ;Ausgabe einer Displayzeile
          C788                  ;HL=Adr, C=Anzahl Bytes
          C788 CDB2F4           CALL    HLHX    ;Adresse
          C78B E5               PUSH    HL
          C78C 41               LD      B,C
          C78D CD7AF7   DPME1   CALL    LDAME   ;Byte holen
          C790 23               INC     HL
          C791 CDB7F4           CALL    AHSPC   ;anzeigen
          C794 10F7             DJNZ    DPME1   ;C*
          C796 E1               POP     HL
          C797 41               LD      B,C
          C798 3E09             LD      A,9
          C79A CDC9F3           CALL    OCHR    ;CUR
          C79D CD7AF7   DPME2   CALL    LDAME   ;Byte holen
          C7A0 23               INC     HL
          C7A1 CD5AF7           CALL    CSTBT   ;als ASCII
          C7A4 10F7             DJNZ    DPME2   ;C*
          C7A6 C9               RET
          C7A7
          C7A7          DISPC   ;Anzeige Speicherbereich
          C7A7                  ;HL=Adr, E=Listblocklaenge
          C7A7                  ;C=Anzahl Bytes pro Zeile
          C7A7                  ;A=Anzahl Argumente
          C7A7 FE03             CP      3
          C7A9 3008             JR      NC,DISP1
          C7AB 0E08             LD      C,8     ;default
          C7AD FE02             CP      2
          C7AF 3002             JR      NC,DISP1
          C7B1 1E04             LD      E,4     ;default
          C7B3 D5       DISP1   PUSH    DE
          C7B4 CD88C7   DISP2   CALL    DPMEMO  ;1 Zeile
          C7B7 CDC9F4           CALL    CRLF
          C7BA CDACE4           CALL    BRKT
          C7BD 3806             JR      C,DISP4
          C7BF 1D               DEC     E
          C7C0 20F2             JR      NZ,DISP2;E*
          C7C2 CDC3F3   DISP3   CALL    INTB    ;Warten Taste
          C7C5 D1       DISP4   POP     DE
          C7C6 FE03             CP      3       ;BRK?
          C7C8 C8               RET     Z
          C7C9 FE0F             CP      0FH
          C7CB 2005             JR      NZ,DISP5
          C7CD CDC9F3           CALL    OCHR    ;Hardcopy
          C7D0 18F0             JR      DISP3
          C7D2 FE13     DISP5   CP      13H     ;STOP?
          C7D4 20DD             JR      NZ,DISP1
          C7D6 1807             JR      MODI1
          C7D8
          C7D8          MODIC   ;Anzeige/Veraendern Speicher-
          C7D8                  ;bereich, Par. wie DISPC
          C7D8 4B               LD      C,E     ;Breite
          C7D9 FE02             CP      2
          C7DB 3002             JR      NC,MODI1
          C7DD 0E01             LD      C,1     ;default
          C7DF CD88C7   MODI1   CALL    DPMEMO
          C7E2 3E05             LD      A,5
          C7E4 32A0B7           LD      (CURSO),A
          C7E7 CD85F4           CALL    INLIN
          C7EA D8               RET     C       ;BRK
          C7EB E5               PUSH    HL
          C7EC CDF0F4           CALL    RHEX    ;Adresse
          C7EF 7E               LD      A,M
          C7F0 E1               POP     HL
          C7F1 3856             JR      C,MODI9 ;Fehler
          C7F3 A7               AND     A
          C7F4 28E9             JR      Z,MODI1
          C7F6 2A97B7           LD      HL,(NUMVX)
          C7F9 E5       MODI2   PUSH    HL
          C7FA CDF0F4           CALL    RHEX    ;Datenbyte
          C7FD 7E               LD      A,M
          C7FE A7               AND     A       ;kein Zeichen
          C7FF 23               INC     HL      ;einlesbar?
          C800 7E               LD      A,M
          C801 E1               POP     HL
          C802 2804             JR      Z,MODI4
          C804 CD9DF7   MODI3   CALL    LDMAE   ;eintragen
          C807 23               INC     HL
          C808 1A       MODI4   LD      A,(DE)
          C809 FE2E             CP      '.'     ;Abschluî?
          C80B C8               RET     Z
          C80C FE2C             CP      ','     ;1 Zeichen?
          C80E 2005             JR      NZ,MODI5
          C810 13               INC     DE
          C811 1A               LD      A,(DE)  ;vom Video-RAM
          C812 13               INC     DE
          C813 18EF             JR      MODI3   ;eintragen
          C815
          C815 FE3A     MODI5   CP      ':'     ;Rueckschritt?
          C817 2006             JR      NZ,MODI6
          C819 0600             LD      B,0
          C81B ED42             SBC     HL,BC   ;C Bytes zurueck
          C81D 18C0             JR      MODI1
          C81F
          C81F FE2F     MODI6   CP      '/'     ;neue Adresse?
          C821 200B             JR      NZ,MODI0
          C823 13               INC     DE
          C824 CDF0F4           CALL    RHEX
          C827 3820             JR      C,MODI9
          C829 2A97B7           LD      HL,(NUMVX)
          C82C 18B1             JR      MODI1
          C82E
          C82E FE27     MODI0   CP      27H     ;Zeichenkette?
          C830 2010             JR      NZ,MODI8
          C832 13               INC     DE
          C833 1A       MODI7   LD      A,(DE)  ;Zeichen holen
          C834 13               INC     DE
          C835 A7               AND     A       ;Dummy-Ende?
          C836 28A7             JR      Z,MODI1
          C838 FE27             CP      27H     ;Ende Kette?
          C83A 28CC             JR      Z,MODI4
          C83C CD9DF7           CALL    LDMAE   ;eintragen
          C83F 23               INC     HL
          C840 18F1             JR      MODI7
          C842
          C842 A7       MODI8   AND     A       ;Ende Zeile?
          C843 289A             JR      Z,MODI1
          C845 FE20             CP      ' '     ;Leerzeichen?
          C847 28B0             JR      Z,MODI2
          C849 CDBFF4   MODI9   CALL    ERRM    ;sonst ERROR
          C84C 1891             JR      MODI1
          C84E
          C84E
          C84E          CENC    ;Initialisierung Centronics-
          C84E                  ;Drucker, PE:Args
          C84E 2181B7           LD      HL,ARGN
          C851 7E               LD      A,M
          C852 34               INC     M       ;Args wie V24!
          C853 A7               AND     A
          C854 2817             JR      Z,CEN1  ;kein Arg
          C856 23               INC     HL
          C857 46               LD      B,M     ;Platz
          C858 0E80             LD      C,80H
          C85A ED78             IN      A,(C)
          C85C FEEF             CP      0EFH    ;M001?
          C85E 200D             JR      NZ,CEN1
          C860 68               LD      L,B
          C861 3E02             LD      A,2
          C863 1601             LD      D,1
          C865 CD1FC3           CALL    MODUC   ;M001 ein
          C868 210BFA           LD      HL,M001PR
          C86B 1803             JR      CEN2
          C86D 211EFA   CEN1    LD      HL,M021PR
          C870 22EAB7   CEN2    LD      (OFILT+1),HL
          C873 2182B7           LD      HL,ARG1
          C876 1812             JR      CEN3
          C878
          C878          V24OC   ;Initialisieren Druckerausgabe
          C878                  ;PE: Argumente
          C878 2181B7           LD      HL,ARGN
          C87B 7E               LD      A,M
          C87C FE02             CP      2
          C87E 302E             JR      NC,V24O3;mehr als 1 Arg
          C880 0608             LD      B,8     ;ab Platz 8
          C882 CD88C9           CALL    V24SU   ;M003 suchen
          C885 385F             JR      C,V24O6 ;nicht gef.
          C887 2184B7           LD      HL,ARG2
          C88A 3A81B7   CEN3    LD      A,(ARGN)
          C88D FE03             CP      3
          C88F 303F             JR      NC,V24O5;USER angegeben
          C891 21B8F9           LD      HL,HCPGM
          C894 2299B7           LD      (HCADR),HL;ShCLR belegen
          C897 11F9F9           LD      DE,PRINT
          C89A 21E1B7           LD      HL,HCPZ
          C89D CB4E             BIT     1,M     ;UOUT1 oder 2?
          C89F 2006             JR      NZ,V24O1
          C8A1 ED53BEB7         LD      (UOUT1+1),DE
          C8A5 1804             JR      V24O2
          C8A7 ED53C4B7 V24O1   LD      (UOUT2+1),DE
          C8AB C33FC9   V24O2   JP      V24O12
          C8AE
          C8AE 23       V24O3   INC     HL      ;ARG1
          C8AF 46               LD      B,M     ;ab Platz
          C8B0 CD88C9           CALL    V24SU   ;M003 suchen
          C8B3 3831             JR      C,V24O6 ;nicht gef.
          C8B5 23               INC     HL
          C8B6 23               INC     HL      ;ARG2
          C8B7 7E               LD      A,M     ;SIO A oder B?
          C8B8 3D               DEC     A
          C8B9 200A             JR      NZ,V24O4
          C8BB 3AE1B7           LD      A,(HCPZ)
          C8BE CB97             RES     2,A     ;merken SIOA
          C8C0 32E1B7           LD      (HCPZ),A
          C8C3 180B             JR      V24O5
          C8C5
          C8C5 3D       V24O4   DEC     A
          C8C6 201E             JR      NZ,V24O6;Fehler
          C8C8 3AE1B7           LD      A,(HCPZ)
          C8CB CBD7             SET     2,A     ;merken SIOB
          C8CD 32E1B7           LD      (HCPZ),A
          C8D0 23       V24O5   INC     HL
          C8D1 23               INC     HL
          C8D2 11F9F9           LD      DE,PRINT
          C8D5 7E               LD      A,M     ;USER1 oder 2?
          C8D6 3D               DEC     A
          C8D7 3D               DEC     A
          C8D8 200F             JR      NZ,V24O7
          C8DA ED53BEB7         LD      (UOUT1+1),DE
          C8DE 11E1B7           LD      DE,HCPZ
          C8E1 1A               LD      A,(DE)
          C8E2 CB8F             RES     1,A     ;merken USER1
          C8E4 1810             JR      V24O8
          C8E6
          C8E6 C3BFF4   V24O6   JP      ERRM    ;Fehlersprung
          C8E9
          C8E9 3D       V24O7   DEC     A
          C8EA 20FA             JR      NZ,V24O6;Fehler
          C8EC ED53C4B7         LD      (UOUT2+1),DE
          C8F0 11E1B7           LD      DE,HCPZ
          C8F3 1A               LD      A,(DE)
          C8F4 CBCF             SET     1,A     ;merken USER2
          C8F6 12       V24O8   LD      (DE),A
          C8F7 3A81B7           LD      A,(ARGN)
          C8FA FE04             CP      4       ;4. Argument?
          C8FC 3841             JR      C,V24O12;nein
          C8FE 23               INC     HL
          C8FF 23               INC     HL
          C900 7E               LD      A,M     ;ShCLR?
          C901 A7               AND     A
          C902 11F0E3           LD      DE,NOT
          C905 2818             JR      Z,V24O11;keine Fkt.
          C907 3D               DEC     A
          C908 280A             JR      Z,V24O9 ;Protokoll
          C90A 3D               DEC     A       ;Hardcopy?
          C90B 20D9             JR      NZ,V24O6
          C90D 3AE1B7           LD      A,(HCPZ)
          C910 CBC7             SET     0,A     ;Hcopy merken
          C912 1805             JR      V24O10
          C914
          C914 3AE1B7   V24O9   LD      A,(HCPZ)
          C917 CB87             RES     0,A     ;Hcopy aus
          C919 32E1B7   V24O10  LD      (HCPZ),A
          C91C 11B8F9           LD      DE,HCPGM
          C91F ED5399B7 V24O11  LD      (HCADR),DE
          C923 3A81B7           LD      A,(ARGN)
          C926 FE05             CP      5       ;5. Argument?
          C928 3815             JR      C,V24O12;nein
          C92A 23               INC     HL
          C92B 23               INC     HL
          C92C 7E               LD      A,M     ;Druckertyp
          C92D CB27             SLA     A
          C92F CB27             SLA     A
          C931 CB27             SLA     A       ;nach obere
          C933 CB27             SLA     A       ;Tetrade
          C935 4F               LD      C,A
          C936 3AE1B7           LD      A,(HCPZ)
          C939 E60F             AND     0FH     ;in (HCPZ)
          C93B B1               OR      C       ;einbauen
          C93C 32E1B7           LD      (HCPZ),A
          C93F 3AEAB7   V24O12  LD      A,(OFILT+1)
          C942 FE0B             CP      M001PR
          C944 2170C9           LD      HL,IN01
          C947 2805             JR      Z,INICEN
          C949 FE1E             CP      M021PR
          C94B 217CC9           LD      HL,IN21
          C94E CA66F5   INICEN  JP      Z,INIMEX;Init Centron.
          C951                  ;Init V.24-Druck
          C951 CDB5FA           CALL    LCSO
          C954 3E0C             LD      A,0CH   ;CTC-Adresse
          C956 C5               PUSH    BC
          C957 81               ADD     C
          C958 0602             LD      B,2     ;2 Steuerbytes
          C95A 4F               LD      C,A
          C95B 2AE2B7           LD      HL,(INTV1)
          C95E F3               DI
          C95F EDB3             OTIR            ;CTC init.
          C961 C1               POP     BC
          C962 3AE4B7           LD      A,(INTV1L)
          C965 3D               DEC     A
          C966 3D               DEC     A       ;-2
          C967 47               LD      B,A
          C968 3E0A             LD      A,0AH   ;SIO-Adresse
          C96A 81               ADD     C
          C96B 4F               LD      C,A
          C96C EDB3             OTIR            ;SIO init.
          C96E FB               EI
          C96F C9               RET
          C970
          C970          IN01    ;Inittabelle fuer M001
          C970 03               DB      3
          C971 06               DB      6       ;PIO-A Stw
          C972 02                DB     2
          C973 CF                 DB    0CFH    ;Bitbetrieb
          C974 00                 DB    0       ;alles Ausg.
          C975 07               DB      7       ;PIO-B Stw
          C976 02                DB     2
          C977 CF                 DB    0CFH    ;Bitbetrieb
          C978 FE                 DB    0FEH    ;Bit 0 Ausg.
          C979 05               DB      5       ;POI-B Daten
          C97A 01                DB     1
          C97B 01                 DB    1       ;Strobe passiv
          C97C
          C97C          IN21    ;Inittabelle fuer M021
          C97C 03               DB      3
          C97D 93               DB      93H     ;PIO-B Stw
          C97E 02                DB     2
          C97F CF                 DB    0CFH    ;Bitbetrieb
          C980 00                 DB    0       ;alles Ausg.
          C981 92               DB      92H     ;PIO-A Stw
          C982 02                DB     2
          C983 CF                 DB    0CFH    ;Bitbetrieb
          C984 7F                 DB    7FH     ;Bit 7 Ausg.
          C985 90               DB      90H     ;PIO-A Daten
          C986 01                DB     1
          C987 80                 DB    80H     ;Strobe passiv
          C988
          C988          V24SU   ;Suche 1. V24-Modul
          C988 0E80             LD      C,80H
          C98A ED78     V24S1   IN      A,(C)
          C98C FEEE             CP      0EEH    ;M003?
          C98E 2805             JR      Z,V24S2 ;ja
          C990 04               INC     B
          C991 20F7             JR      NZ,V24S1
          C993 37               SCF             ;nicht gef.
          C994 C9               RET
          C995                  ;
          C995 E5       V24S2   PUSH    HL
          C996 68               LD      L,B
          C997 3E02             LD      A,2
          C999 1601             LD      D,1
          C99B CD1FC3           CALL    MODUC   ;einschalten
          C99E 2132FA           LD      HL,V24PR
          C9A1 22EAB7           LD      (OFILT+1),HL
          C9A4 E1               POP     HL
          C9A5 C9               RET
          C9A6
          C9A6          PRINTC  ;allgemeine Druckroutine
          C9A6 F5               PUSH    AF
          C9A7 3AE1B7           LD      A,(HCPZ)
          C9AA CB7F             BIT     7,A
          C9AC 2829             JR      Z,PRINT3;Drucker
          C9AE                  ;Schreibmaschine
          C9AE E6F0             AND     0F0H
          C9B0 FE90             CP      90H
          C9B2 2817             JR      Z,S6005
          C9B4 FEA0             CP      0A0H
          C9B6 201F             JR      NZ,PRINT3
          C9B8 F1       S6010   POP     AF
          C9B9 E5               PUSH    HL
          C9BA C5               PUSH    BC
          C9BB 21F6C9           LD      HL,ZIBM
          C9BE 010700           LD      BC,7
          C9C1 EDB1             CPIR
          C9C3 200F             JR      NZ,PRINT2
          C9C5 0E06             LD      C,6
          C9C7 09               ADD     HL,BC
          C9C8 7E               LD      A,M
          C9C9 1809             JR      PRINT2
          C9CB
          C9CB F1       S6005   POP     AF
          C9CC FE7E             CP      'î'
          C9CE 2008             JR      NZ,PRINT4
          C9D0 3E83             LD      A,83H
          C9D2 1804             JR      PRINT4
          C9D4 C1       PRINT2  POP     BC
          C9D5 E1               POP     HL
          C9D6 F5               PUSH    AF
          C9D7 F1       PRINT3  POP     AF
          C9D8 FE09     PRINT4  CP      9       ;CUR
          C9DA 280D             JR      Z,PRINT5
          C9DC F5               PUSH    AF
          C9DD 3AA2B7           LD      A,(STBT)
          C9E0 CB5F             BIT     3,A     ;Steuerzeichen
          C9E2 280E             JR      Z,PRINT7;ausfuehren
          C9E4 F1               POP     AF
          C9E5 FE7F             CP      7FH     ;und 7Fh
          C9E7 2002             JR      NZ,PRINT6
          C9E9 3E20     PRINT5  LD      A,20H   ;nach SPC
          C9EB FE20     PRINT6  CP      20H     ;und Steuerzei-
          C9ED 3004             JR      NC,PRINT8;chen nach '_'
          C9EF 3E5F             LD      A,'_'   ;wandeln
          C9F1 F5               PUSH    AF
          C9F2 F1       PRINT7  POP     AF
          C9F3 C3E9B7   PRINT8  JP      OFILT   ;in IRM
          C9F6
          C9F6          ZIBM    ;IBM-Kodierungen
          C9F6 7B7C7D7E         DB      'äöüî'
          C9FA 5B5C5D           DB      '-Ö_'
          C9FD 849481E1         DB      84H,94H,81H,0E1H
          CA01 8E999A           DB      8EH,99H,9AH
          CA04
          CA04          HCPGMC  ;ShCLR-Reaktionsprogramm
          CA04 E5               PUSH    HL
          CA05 D5               PUSH    DE
          CA06 3AE1B7           LD      A,(HCPZ)
          CA09 CB47             BIT     0,A     ;Hardcopy?
          CA0B C243CA           JP      NZ,COPIES
          CA0E
          CA0E                  ;Protokollfunktion
          CA0E 2AB9B7           LD      HL,(OUTAB)
          CA11 AF               XOR     A
          CA12 B6               OR      M       ;CRT?
          CA13 2014             JR      NZ,PROTO2
          CA15 11F6F9           LD      DE,ECHO ;CRT+PRINT
          CA18 21AAFB           LD      HL,ZEI3 ;UOUT2
          CA1B 3AE1B7           LD      A,(HCPZ)
          CA1E CB4F             BIT     1,A     ;USER1/2?
          CA20 2802             JR      Z,PROTO1
          CA22 180F             JR      PROTO3
          CA24
          CA24 21A9FB   PROTO1  LD      HL,ZEI2 ;UOUT1
          CA27 1810             JR      PROTO4
          CA29
          CA29          PROTO2  ;Protokoll deaktivieren
          CA29 11F9F9           LD      DE,PRINT
          CA2C 21A7FB           LD      HL,ZEI0 ;CRT
          CA2F 3D               DEC     A
          CA30 3D               DEC     A
          CA31 2806             JR      Z,PROTO4
          CA33 ED53C4B7 PROTO3  LD      (UOUT2+1),DE
          CA37 1804             JR      PROTO5
          CA39                  ;
          CA39 ED53BEB7 PROTO4  LD      (UOUT1+1),DE
          CA3D 22B9B7   PROTO5  LD      (OUTAB),HL ;Zeiger
          CA40 D1               POP     DE
          CA41 E1               POP     HL
          CA42 C9               RET
          CA43
          CA43          COPIES  ;Hard- oder Screencopy
          CA43 C5               PUSH    BC
          CA44 F5               PUSH    AF
          CA45 3AE1B7           LD      A,(HCPZ)
          CA48 E6F0             AND     0F0H
          CA4A CB7F             BIT     7,A
          CA4C 2826             JR      Z,HCOPYC;Hardcopy
          CA4E          ;Screencopy
          CA4E 2ACBB7           LD      HL,(VRAM)
          CA51 0620             LD      B,32
          CA53 0E28     SCOPY1  LD      C,40
          CA55 7E       SCOPY2  LD      A,M
          CA56 23               INC     HL
          CA57 FE20             CP      20H
          CA59 3002             JR      NC,SCOPY4
          CA5B 3E20             LD      A,' '   ;statt Steuerz.
          CA5D CDF9F9   SCOPY4  CALL    PRINT
          CA60 0D               DEC     C       ;40 Spalten
          CA61 20F2             JR      NZ,SCOPY2
          CA63 3E0D             LD      A,CR
          CA65 CDD8C9           CALL    PRINT4
          CA68 3E0A             LD      A,LF
          CA6A CDD8C9           CALL    PRINT4
          CA6D 10E4             DJNZ    SCOPY1  ;32 Zeilen
          CA6F F1       HCEND   POP     AF
          CA70 C1               POP     BC
          CA71 D1               POP     DE
          CA72 E1               POP     HL
          CA73 C9               RET
          CA74
          CA74          HCOPYC  ;..nach Typ verzweigen
          CA74 E6F0             AND     0F0H
          CA76 FE10             CP      10H
          CA78 CA43CB           JP      Z,K6314 ;ESC/P breit
          CA7B FE20             CP      20H
          CA7D CA81CB           JP      Z,K6311 ;mit ANSI
          CA80 FE30             CP      30H
          CA82 CAB0CB           JP      Z,K6312 ;ANSI breit
          CA85 FE50             CP      50H
          CA87 283B             JR      Z,HCMIN ;ESC/P2 (Mini)
          CA89 FE70             CP      70H
          CA8B 2867             JR      Z,ESCP2 ;ESC/P2 24 Nadel
          CA8D
          CA8D          ;K6313, K6304, ESC/P2 mit 8 Nadeln
          CA8D 2600     K6313   LD      H,0     ;Zeile 0
          CA8F CD73CC   K6313a  CALL    PRZK    ;Grafik init
          CA92 2E00             LD      L,0     ;Spalte 0
          CA94 0E08     K6313b  LD      C,8
          CA96 CDDDCB           CALL    CBYTES
          CA99 E5               PUSH    HL
          CA9A 0608     K6313c  LD      B,8
          CA9C 2100B7           LD      HL,CASS
          CA9F CB16     K6313d  RL      M
          CAA1 17               RLA
          CAA2 23               INC     HL
          CAA3 10FA             DJNZ    K6313d
          CAA5 CDE9B7           CALL    OFILT
          CAA8 0D               DEC     C
          CAA9 20EF             JR      NZ,K6313c ;naechster
          CAAB E1               POP     HL        ;Cursor
          CAAC 2C               INC     L
          CAAD 3E28             LD      A,40
          CAAF BD               CP      L
          CAB0 20E2             JR      NZ,K6313b
          CAB2 7C               LD      A,H
          CAB3 C608             ADD     8       ;naechste Zeile
          CAB5 67               LD      H,A
          CAB6 30D7             JR      NC,K6313a
          CAB8 3E0D     HCCRLF  LD      A,CR
          CABA CDE9B7           CALL    OFILT
          CABD 3E0A             LD      A,LF
          CABF CDE9B7           CALL    OFILT
          CAC2 18AB             JR      HCEND
          CAC4
          CAC4          HCMIN   ;ESC/P2 Miniformat
          CAC4 210000           LD      HL,0    ;Z=0, Sp=0
          CAC7 CD73CC   MINIa   CALL    PRZK
          CACA 0E18     MINIb   LD      C,24    ;24 Pixel
          CACC CDDDCB           CALL    CBYTES
          CACF CD54CC           CALL    S3PRS
          CAD2 20F6             JR      NZ,MINIb
          CAD4 7C               LD      A,H
          CAD5 C618             ADD     24
          CAD7 67               LD      H,A
          CAD8 2E00             LD      L,0     ;Sp=0
          CADA FEF0             CP      240
          CADC 20E9             JR      NZ,MINIa
          CADE CD73CC           CALL    PRZK
          CAE1 0E10     MINIc   LD      C,16
          CAE3 CDDDCB           CALL    CBYTES
          CAE6 0608             LD      B,8
          CAE8 AF               XOR     A
          CAE9 12       MINId   LD      (DE),A  ;8 Nadeln frei
          CAEA 13               INC     DE
          CAEB 10FC             DJNZ    MINId
          CAED CD54CC           CALL    S3PRS
          CAF0 20EF             JR      NZ,MINIc
          CAF2 18C4             JR      HCCRLF
          CAF4
          CAF4          ESCP2   ;ESC/P2 mit 24 Nadeln
          CAF4 2600             LD      H,0     ;Zeile 0
          CAF6 CD73CC   ESCP2a  CALL    PRZK
          CAF9 2E00             LD      L,0     ;Spalte 0
          CAFB 0608     ESCP2b  LD      B,8     ;8 Pixel
          CAFD E5               PUSH    HL
          CAFE CD60E0           CALL    PADR
          CB01 1100B7           LD      DE,CASS
          CB04 7E       ESCP2c  LD      A,M
          CB05 12               LD      (DE),A
          CB06 13               INC     DE
          CB07 12               LD      (DE),A  ;3 mal ablegen
          CB08 13               INC     DE
          CB09 12               LD      (DE),A
          CB0A 13               INC     DE
          CB0B 2C               INC     L
          CB0C 10F6             DJNZ    ESCP2c
          CB0E 0E08             LD      C,8
          CB10 0618     ESCP2d  LD      B,24    ;3*8 Bytes
          CB12 2100B7           LD      HL,CASS
          CB15 CB16     ESCP2e  RL      M
          CB17 CB13             RL      E
          CB19 CB12             RL      D
          CB1B 17               RLA
          CB1C 23               INC     HL
          CB1D 10F6             DJNZ    ESCP2e  ;Wandlung
          CB1F 77               LD      M,A
          CB20 0603             LD      B,3     ;3 mal drucken
          CB22 7E       ESCP2f  LD      A,M
          CB23 CDE9B7           CALL    OFILT   ;1.
          CB26 7A               LD      A,D
          CB27 CDE9B7           CALL    OFILT   ;2.
          CB2A 7B               LD      A,E
          CB2B CDE9B7           CALL    OFILT   ;3. Byte
          CB2E 10F2             DJNZ    ESCP2f
          CB30 0D               DEC     C
          CB31 20DD             JR      NZ,ESCP2d
          CB33 E1               POP     HL
          CB34 2C               INC     L
          CB35 3E28             LD      A,40    ;Zeilenende?
          CB37 BD               CP      L
          CB38 20C1             JR      NZ,ESCP2b
          CB3A 7C               LD      A,H
          CB3B C608             ADD     A,8
          CB3D 67               LD      H,A
          CB3E 30B6             JR      NC,ESCP2a
          CB40 C3B8CA           JP      HCCRLF
          CB43
          CB43          K6314   ;ESC/P 9-Nadeln (breit)
          CB43 2600             LD      H,0
          CB45 CD73CC   K6314a  CALL    PRZK
          CB48 2E00             LD      L,0
          CB4A 0604     K6314b  LD      B,4
          CB4C E5               PUSH    HL
          CB4D CD60E0           CALL    PADR
          CB50 1100B7           LD      DE,CASS
          CB53 7E       K6314c  LD      A,M
          CB54 12               LD      (DE),A
          CB55 13               INC     DE
          CB56 12               LD      (DE),A
          CB57 13               INC     DE
          CB58 2C               INC     L
          CB59 10F8             DJNZ    K6314c  ;4*
          CB5B 0E08             LD      C,8
          CB5D 0608     K6314d  LD      B,8
          CB5F 2100B7           LD      HL,CASS
          CB62 CB16     K6314e  RL      M
          CB64 17               RLA
          CB65 23               INC     HL
          CB66 10FA             DJNZ    K6314e
          CB68 CDE9B7           CALL    OFILT
          CB6B CDE9B7           CALL    OFILT
          CB6E 0D               DEC     C
          CB6F 20EC             JR      NZ,K6314d
          CB71 E1               POP     HL
          CB72 2C               INC     L
          CB73 3E28             LD      A,40
          CB75 BD               CP      L
          CB76 20D2             JR      NZ,K6314b
          CB78 7C               LD      A,H
          CB79 C604             ADD     4
          CB7B 67               LD      H,A
          CB7C 30C7             JR      NC,K6314a
          CB7E C3B8CA           JP      HCCRLF
          CB81
          CB81          K6311   ;ANSI-Drucker
          CB81 CD73CC           CALL    PRZK
          CB84 062A             LD      B,256/6
          CB86 210000           LD      HL,0
          CB89 0E06     K6311a  LD      C,6
          CB8B CDDDCB           CALL    CBYTES
          CB8E CDFECB           CALL    SPRS    ;6*8-Feld ausg.
          CB91 20F6             JR      NZ,K6311a
          CB93 3E06             LD      A,6     ;6 Pixel tiefer
          CB95 84               ADD     H
          CB96 67               LD      H,A
          CB97 2E00             LD      L,0
          CB99 CD73CC           CALL    PRZK
          CB9C 05               DEC     B
          CB9D 20EA             JR      NZ,K6311a
          CB9F 0E04     K6311b  LD      C,256%6 ;den Rest
          CBA1 CDDDCB           CALL    CBYTES
          CBA4 AF               XOR     A
          CBA5 12               LD      (DE),A  ;letzte beiden
          CBA6 13               INC     DE      ;Zeilen leeren
          CBA7 12               LD      (DE),A
          CBA8 CDFECB           CALL    SPRS
          CBAB 20F2             JR      NZ,K6311b
          CBAD C3B8CA           JP      HCCRLF
          CBB0
          CBB0          K6312   ;ANSI breit
          CBB0 CD73CC           CALL    PRZK
          CBB3 0655             LD      B,256/3
          CBB5 210000           LD      HL,0
          CBB8 0E03     K6312a  LD      C,3
          CBBA CDECCB           CALL    CBYTS2
          CBBD CD28CC           CALL    S2PRS
          CBC0 20F6             JR      NZ,K6312a
          CBC2 24               INC     H
          CBC3 24               INC     H
          CBC4 24               INC     H
          CBC5 2E00             LD      L,0
          CBC7 CD73CC           CALL    PRZK
          CBCA 10EC             DJNZ    K6312a
          CBCC 0E04     K6312b  LD      C,256%6 ;den Rest
          CBCE CDECCB           CALL    CBYTS2
          CBD1 AF               XOR     A
          CBD2 12               LD      (DE),A
          CBD3 13               INC     DE
          CBD4 12               LD      (DE),A
          CBD5 CD28CC           CALL    S2PRS
          CBD8 20F2             JR      NZ,K6312b
          CBDA C3B8CA           JP      HCCRLF
          CBDD
          CBDD          CBYTES  ;C Bytes zum Puffer
          CBDD E5               PUSH    HL
          CBDE C5               PUSH    BC
          CBDF CD60E0           CALL    PADR
          CBE2 1100B7           LD      DE,CASS
          CBE5 0600             LD      B,0
          CBE7 EDB0             LDIR
          CBE9 C1               POP     BC
          CBEA E1               POP     HL
          CBEB C9               RET
          CBEC
          CBEC          CBYTS2  ;C Bytes zum Puffer & doppeln
          CBEC E5               PUSH    HL
          CBED CD60E0           CALL    PADR
          CBF0 1100B7           LD      DE,CASS
          CBF3 7E       C2BYTL  LD      A,M
          CBF4 12               LD      (DE),A
          CBF5 13               INC     DE
          CBF6 12               LD      (DE),A
          CBF7 13               INC     DE
          CBF8 2C               INC     L
          CBF9 0D               DEC     C
          CBFA 20F7             JR      NZ,C2BYTL
          CBFC E1               POP     HL
          CBFD C9               RET
          CBFE
          CBFE          SPRS    ;8* 6-Nadel-Sprosse ausgeben
          CBFE E5               PUSH    HL
          CBFF C5               PUSH    BC
          CC00 2E80             LD      L,80H
          CC02 0600     SPRS1   LD      B,0
          CC04 1100B7           LD      DE,CASS
          CC07 1A       SPRS2   LD      A,(DE)
          CC08 A5               AND     L       ;CY=0
          CC09 2801             JR      Z,SPRS3
          CC0B 37               SCF             ;CY=1
          CC0C CB10     SPRS3   RL      B
          CC0E 13               INC     DE
          CC0F 3E06             LD      A,6     ;fuer 6 Bit
          CC11 BB               CP      E
          CC12 20F3             JR      NZ,SPRS2;ob. Nadel war 0
          CC14 A7               AND     A       ;unt. Nadel = 0
          CC15 CB10             RL      B
          CC17 78               LD      A,B
          CC18 CDE9B7           CALL    OFILT
          CC1B CB0D             RRC     L
          CC1D CB7D             BIT     7,L
          CC1F 28E1             JR      Z,SPRS1
          CC21 C1               POP     BC
          CC22 E1               POP     HL
          CC23 2C               INC     L
          CC24 3E28             LD      A,40
          CC26 BD               CP      L
          CC27 C9               RET
          CC28
          CC28          S2PRS   ;8* 6-Nadel-Sprosse doppelt out
          CC28 E5               PUSH    HL
          CC29 C5               PUSH    BC
          CC2A 2E80             LD      L,80H
          CC2C 0600     S2PR1   LD      B,0
          CC2E 1100B7           LD      DE,CASS ;KassPuff
          CC31 1A       S2PR2   LD      A,(DE)
          CC32 A5               AND     L
          CC33 2801             JR      Z,S2PR3
          CC35 37               SCF
          CC36 CB10     S2PR3   RL      B
          CC38 13               INC     DE
          CC39 3E06             LD      A,6
          CC3B BB               CP      E
          CC3C 20F3             JR      NZ,S2PR2
          CC3E 78               LD      A,B
          CC3F 17               RLA             ;untere beiden
          CC40 17               RLA             ;Nadeln tot
          CC41 CDE9B7           CALL    OFILT
          CC44 CDE9B7           CALL    OFILT
          CC47 CB0D             RRC     L
          CC49 CB7D             BIT     7,L
          CC4B 28DF             JR      Z,S2PR1
          CC4D C1               POP     BC
          CC4E E1               POP     HL
          CC4F 2C               INC     L
          CC50 3E28             LD      A,40
          CC52 BD               CP      L
          CC53 C9               RET
          CC54
          CC54          S3PRS   ;8* 24-Nadel-Sprosse ausgeben
          CC54 E5               PUSH    HL
          CC55 1E08             LD      E,8
          CC57 0E03     S3PR1   LD      C,3     ;3 Byte
          CC59 2100B7           LD      HL,CASS
          CC5C 0608     S3PR2   LD      B,8
          CC5E CB16     S3PR3   RL      M
          CC60 17               RLA
          CC61 23               INC     HL
          CC62 10FA             DJNZ    S3PR3   ;Wandlung
          CC64 CDE9B7           CALL    OFILT
          CC67 0D               DEC     C
          CC68 20F2             JR      NZ,S3PR2
          CC6A 1D               DEC     E
          CC6B 20EA             JR      NZ,S3PR1
          CC6D E1               POP     HL
          CC6E 2C               INC     L
          CC6F 3E28             LD      A,40
          CC71 BD               CP      L
          CC72 C9               RET
          CC73
          CC73          PRZK    ;Druckerinit entsprechend HCPZ
          CC73 E5               PUSH    HL
          CC74 C5               PUSH    BC
          CC75 AF               XOR     A
          CC76 21E1B7           LD      HL,HCPZ
          CC79 ED6F             RLD
          CC7B 4F               LD      C,A     ;Druckertyp
          CC7C ED67             RRD
          CC7E 0C               INC     C
          CC7F 2199CC           LD      HL,C6313
          CC82 46       PRZK1   LD      B,M     ;Laenge
          CC83 0D               DEC     C
          CC84 2809             JR      Z,PRZK2
          CC86 04               INC     B
          CC87 7D               LD      A,L
          CC88 80               ADD     B
          CC89 6F               LD      L,A
          CC8A 30F6             JR      NC,PRZK1
          CC8C 24               INC     H
          CC8D 18F3             JR      PRZK1
          CC8F 23       PRZK2   INC     HL
          CC90 7E               LD      A,M
          CC91 CDE9B7           CALL    OFILT
          CC94 10F9             DJNZ    PRZK2
          CC96 C1               POP     BC
          CC97 E1               POP     HL
          CC98 C9               RET
          CC99
          CC99          ;Grafiksteuersequenzen fuer die Drucker
          CC99          ;
          CC99 0A       C6313   DB      10      ;Laenge
          CC9A 0D09             DB      CR,9
          CC9C 1B4A18           DB      ESC,'J',24
          CC9F 1B2A05           DB      ESC,'*',5
          CCA2 4001             DW      320
          CCA4
          CCA4 0A       C6314   DB      10
          CCA5 0D09             DB      CR,9
          CCA7 1B4A18           DB      ESC,'J',24
          CCAA 1B2A05           DB      ESC,'*',5
          CCAD 8002             DW      640
          CCAF
          CCAF 0E       C6311   DB      14
          CCB0 1B5B3031         DB      ESC,'-01e'
          CCB5 1B5B3132         DB      ESC,'-12`'
          CCBA 1B4B             DB      ESC,'K'
          CCBC 4001             DW      320
          CCBE
          CCBE 0E       C6312   DB      14
          CCBF 1B5B3031         DB      ESC,'-01e'
          CCC4 1B5B3132         DB      ESC,'-12`'
          CCC9 1B4B             DB      ESC,'K'
          CCCB 8002             DW      640
          CCCD
          CCCD 09       C6304   DB      9
          CCCE 0D09             DB      CR,9
          CCD0 1B4A18           DB      ESC,'J',24
          CCD3 1B4B             DB      ESC,'K'
          CCD5 4001             DW      320
          CCD7
          CCD7 0A       CMINI   DB      10
          CCD8 0D09             DB      CR,9
          CCDA 1B4A18           DB      ESC,'J',24
          CCDD 1B2A27           DB      ESC,'*',39
          CCE0 4001             DW      320
          CCE2
          CCE2 0A       C24N1   DB      10
          CCE3 0D09             DB      CR,9
          CCE5 1B4A18           DB      ESC,'J',24
          CCE8 1B2A00           DB      ESC,'*',0
          CCEB 4001             DW      320
          CCED
          CCED 0A       C24N2   DB      10
          CCEE 0D09             DB      CR,9
          CCF0 1B4A18           DB      ESC,'J',24
          CCF3 1B2A27           DB      ESC,'*',39
          CCF6 C003             DW      960
          CCF8
          CCF8          V24DC   ;Duplex-Init
          CCF8                  ;PE: Argumente
          CCF8 3A81B7           LD      A,(ARGN)
          CCFB FE03             CP      3
          CCFD 3829             JR      C,V24DC2;<3 Argumente
          CCFF 2182B7           LD      HL,ARG1
          CD02 46               LD      B,M     ;ab Platz B
          CD03 CD88C9           CALL    V24SU   ;M003 suchen
          CD06 DABFF4           JP      C,ERRM
          CD09 23               INC     HL
          CD0A 23               INC     HL
          CD0B 3AE8B7           LD      A,(HCPZ2)
          CD0E CB46             BIT     0,M     ;SIO A oder B?
          CD10 CB97             RES     2,A
          CD12 2002             JR      NZ,V24DC1
          CD14 CBD7             SET     2,A
          CD16 47       V24DC1  LD      B,A
          CD17 23               INC     HL
          CD18 23               INC     HL
          CD19 7E               LD      A,M
          CD1A D602             SUB     2       ;USER1 oder 2?
          CD1C CB88             RES     1,B
          CD1E 2802             JR      Z,V24DC6
          CD20 CBC8             SET     1,B
          CD22 78       V24DC6  LD      A,B
          CD23 32E8B7           LD      (HCPZ2),A
          CD26 1808             JR      V24DC3
          CD28
          CD28 0607     V24DC2  LD      B,7     ;ab Platz 7
          CD2A CD88C9           CALL    V24SU
          CD2D DABFF4           JP      C,ERRM
          CD30 1159FA   V24DC3  LD      DE,V24OT
          CD33 0179FA           LD      BC,V24IN
          CD36 3AE8B7           LD      A,(HCPZ2)
          CD39 CB4F             BIT     1,A
          CD3B 200A             JR      NZ,V24DC4
          CD3D ED53BEB7         LD      (UOUT1+1),DE
          CD41 ED43C1B7         LD      (UIN1+1),BC
          CD45 1808             JR      V24DC5
          CD47
          CD47 ED53C4B7 V24DC4  LD      (UOUT2+1),DE
          CD4B ED43C7B7         LD      (UIN2+1),BC
          CD4F CDC2FA   V24DC5  CALL    LCSOD
          CD52 3E0C             LD      A,0CH
          CD54 C5               PUSH    BC
          CD55 81               ADD     C
          CD56 0602             LD      B,2     ;2 Initbytes
          CD58 4F               LD      C,A
          CD59 2AE5B7           LD      HL,(INTV2)
          CD5C F3               DI
          CD5D EDB3             OTIR            ;CTC init.
          CD5F C1               POP     BC
          CD60 3AE7B7           LD      A,(INTV2L)
          CD63 3D               DEC     A
          CD64 3D               DEC     A
          CD65 47               LD      B,A
          CD66 3E0A             LD      A,0AH
          CD68 81               ADD     C
          CD69 4F               LD      C,A
          CD6A EDB3     UMINI1  OTIR            ;SIO init.
          CD6C FB               EI
          CD6D C9               RET
          CD6E
          CD6E          UMINIT  ;SIO B auf Interruptbetrieb
          CD6E 2159FA           LD      HL,V24OT
          CD71 22C4B7           LD      (UOUT2+1),HL
          CD74 0E0D             LD      C,0DH
          CD76 21ACCD           LD      HL,V24UMT
          CD79 0602             LD      B,2     ;2 Initbytes
          CD7B F3               DI
          CD7C EDB3             OTIR            ;CTC init.
          CD7E 060B             LD      B,0BH   ;11 Initbytes
          CD80 0E0B             LD      C,0BH
          CD82 18E6             JR      UMINI1
          CD84
          CD84          V24INI  ;-Tabellen in IRM kopieren
          CD84                  ;-M003 suchen und einschalten
          CD84                  ;-M003-Status in A800h merken
          CD84 219BCD           LD      HL,V24TAB
          CD87 1101A8           LD      DE,0A801H
          CD8A 011100           LD      BC,17
          CD8D EDB0             LDIR
          CD8F 0608             LD      B,8
          CD91 CD88C9           CALL    V24SU
          CD94 D8               RET     C
          CD95 3E01             LD      A,1
          CD97 3200A8           LD      (0A800H),A
          CD9A C9               RET
          CD9B
          CD9B 47       V24TAB  DB      47H     ;fuer IRM
          CD9C 5B               DB      5BH
          CD9D 0404             DB      4,4
          CD9F 0320             DB      3,20H
          CDA1 056A             DB      5,6AH
          CDA3
          CDA3 47               DB      47H
          CDA4 2E               DB      2EH
          CDA5 18               DB      18H
          CDA6 0444             DB      4,44H
          CDA8 03E1             DB      3,0E1H
          CDAA 056A             DB      5,6AH
          CDAC
          CDAC 47       V24UMT  DB      47H     ;fuer Interrupt-
          CDAD 2E               DB      2EH     ;betrieb
          CDAE 18               DB      18H
          CDAF 02E2             DB      2,0E2H
          CDB1 1444             DB      14H,44H
          CDB3 03E1             DB      3,0E1H
          CDB5 05EA             DB      5,0EAH
          CDB7 1118             DB      11H,18H
          CDB9
          CDB9          MBOC    ;Byteweise MB-Ausgabe
          CDB9 5A               LD      E,D     ;Steuerbyte
          CDBA 57               LD      D,A     ;Datenbyte
          CDBB D5               PUSH    DE
          CDBC C5               PUSH    BC
          CDBD CB5B             BIT     3,E
          CDBF 2829             JR      Z,NOINIT
          CDC1 DDCB07CE         SET     1,(IX+7);merken INIT
          CDC5 3ED5             LD      A,'U'+80H
          CDC7 BE               CP      M
          CDC8 D5               PUSH    DE
          CDC9 11A000           LD      DE,0A0H ;Vortonlaenge
          CDCC 2003             JR      NZ,NOHIU;bei 'U'
          CDCE 110005           LD      DE,500H ;gedehnt
          CDD1 ED53D8B7 NOHIU   LD      (VORTN),DE
          CDD5 1100B7           LD      DE,CASS
          CDD8 010B00           LD      BC,11
          CDDB EDB0             LDIR            ;Name
          CDDD EB               EX      DE,HL
          CDDE D1               POP     DE
          CDDF 72               LD      M,D     ;1.Byte
          CDE0 2C               INC     L
          CDE1 7D       MBOC1   LD      A,L
          CDE2 32DAB7           LD      (DTPTR),A
          CDE5 C1       MBOCE   POP     BC
          CDE6 D1               POP     DE
          CDE7 CB9B             RES     3,E
          CDE9 C9               RET
          CDEA
          CDEA 2ADAB7   NOINIT  LD      HL,(DTPTR)
          CDED 26B7             LD      H,0B7H
          CDEF 72               LD      M,D     ;Byte eintragen
          CDF0 CB73             BIT     6,E
          CDF2 201F             JR      NZ,MCLOS;Close
          CDF4 2C               INC     L
          CDF5 CB7D             BIT     7,L
          CDF7 28E8             JR      Z,MBOC1
          CDF9 DDCB074E         BIT     1,(IX+7)
          CDFD 2008             JR      NZ,MBOC2;erst mal Init!
          CDFF CD07CF           CALL    MBLO    ;Blockout
          CE02 2100B7   MBOC6   LD      HL,CASS
          CE05 18DA             JR      MBOC1
          CE07
          CE07 DDCB078E MBOC2   RES     1,(IX+7);ruecksetzen
          CE0B CD28E5           CALL    ISRO    ;Init
          CE0E CD0ECF           CALL    MBLNR   ;Blocknr.
          CE11 18EF             JR      MBOC6
          CE13
          CE13 DDCB074E MCLOS   BIT     1,(IX+7);Init?
          CE17 2805             JR      Z,MBOC3
          CE19 CD28E5           CALL    ISRO    ;erst noch Init!
          CE1C 1803             JR      MBOC4
          CE1E CD07CF   MBOC3   CALL    MBLO    ;Blockout
          CE21 ED4BD8B7 MBOC4   LD      BC,(VORTN)
          CE25 CDDBE4           CALL    CSRO
          CE28 D5       MBOC5   PUSH    DE
          CE29 CD34F7           CALL    CSRI
          CE2C DDCB07AE         RES     5,(IX+7);'U'-Merker
          CE30 D1               POP     DE      ;ruecksetzen
          CE31 18B2             JR      MBOCE
          CE33
          CE33          MBIC    ;Byteweise MB-Eingabe
          CE33 5A               LD      E,D     ;Steuerbyte
          CE34 57               LD      D,A     ;Datenbyte (PA!)
          CE35 D5               PUSH    DE
          CE36 C5               PUSH    BC
          CE37 CB73             BIT     6,E     ;Close?
          CE39 20ED             JR      NZ,MBOC5
          CE3B CB5B             BIT     3,E     ;Init?
          CE3D 2866             JR      Z,MBIU
          CE3F 3E01             LD      A,1     ;erwarteter Blk
          CE41 DD7703           LD      (IX+3),A
          CE44 E5               PUSH    HL
          CE45 CD9AE5           CALL    ISRI
          CE48 E1       MBIC1   POP     HL
          CE49 DAF7CE           JP      C,JBLERR;Fehler: '*'
          CE4C DD7E02           LD      A,(IX+2);gelesener Blk.
          CE4F FE01             CP      1
          CE51 C2F7CE           JP      NZ,JBLERR ;Fehler: '*'
          CE54 DDCB07BE         RES     7,(IX+7);Kopfblk geladen
          CE58 DD3403           INC     (IX+3)  ;erw. Block
          CE5B 1100B7           LD      DE,CASS
          CE5E 060B             LD      B,11
          CE60 1A               LD      A,(DE)
          CE61 FED5             CP      'U'+80H ;hohes 'U'?
          CE63 2004             JR      NZ,MBIC2
          CE65 DDCB07EE         SET     5,(IX+7);merken zur
          CE69           ;Blocknummernausgabeunterdrueckung
          CE69 C629     MBIC2   ADD     29H     ;Geschuetzte
          CE6B 3012             JR      NC,MBIC3;BASIC-
          CE6D 1A               LD      A,(DE)  ;Programme
          CE6E D604             SUB     4       ;als un-
          CE70 12               LD      (DE),A  ;geschuetzt
          CE71 13               INC     DE      ;anzeigen
          CE72 12               LD      (DE),A  ;und Setzen
          CE73 13               INC     DE      ;LIST/EDIT/BYE-
          CE74 12               LD      (DE),A  ;Schutz
          CE75 325E03           LD      (35EH),A;<=hier
          CE78 DDCB07F6         SET     6,(IX+7);merken wofuer?
          CE7C 1100B7           LD      DE,CASS
          CE7F 1A       MBIC3   LD      A,(DE)  ;Name
          CE80 CDF7E3           CALL    CRT     ;anzeigen
          CE83 BE               CP      M       ;stimmt Name?
          CE84 2804             JR      Z,MBIC4
          CE86 DDCB07FE         SET     7,(IX+7);nein-merken
          CE8A 23       MBIC4   INC     HL
          CE8B 13               INC     DE
          CE8C 10F1             DJNZ    MBIC3
          CE8E CDC9F4           CALL    CRLF
          CE91 DDCB077E         BIT     7,(IX+7)
          CE95 C248F8           JP      NZ,JIOERR ;zu ?IO ERROR
          CE98 EB               EX      DE,HL
          CE99 56       MBIC5   LD      D,M     ;Daten lesen
          CE9A 2C               INC     L
          CE9B 7D               LD      A,L
          CE9C 32DAB7           LD      (DTPTR),A
          CE9F 7A               LD      A,D
          CEA0 C1               POP     BC
          CEA1 D1               POP     DE
          CEA2 CB9B             RES     3,E
          CEA4 C9               RET
          CEA5
          CEA5 2ADAB7   MBIU    LD      HL,(DTPTR)
          CEA8 26B7             LD      H,0B7H
          CEAA CB7D             BIT     7,L
          CEAC 28EB             JR      Z,MBIC5 ;aus Puffer
          CEAE CD9DE5   MBIU1   CALL    MBI
          CEB1 3833             JR      C,MERR
          CEB3 3EFF             LD      A,0FFH
          CEB5 DDBE02           CP      (IX+2)  ;Block FF?
          CEB8 2817             JR      Z,MBIU3
          CEBA DD7E03           LD      A,(IX+3)
          CEBD DDBE02           CP      (IX+2)  ;erwarteter?
          CEC0 280F             JR      Z,MBIU3
          CEC2 3E2A             LD      A,'*'
          CEC4 CDF7E3           CALL    CRT     ;nicht
          CEC7 CD94F3           CALL    BNROST  ;erwartet
          CECA 1900             DB      19H,0
          CECC CD14CF   MBIU2   CALL    JBRKT
          CECF 18DD             JR      MBIU1
          CED1
          CED1 DD3403   MBIU3   INC     (IX+3)  ;naechsten
          CED4 3D               DEC     A       ;erwarten
          CED5 DDCB076E         BIT     5,(IX+7)
          CED9 2006             JR      NZ,MBIU4
          CEDB CD94F3           CALL    BNROST  ;Blocknummer
          CEDE 3E               DB      '>'     ;unter Vorbe-
          CEDF 1900             DB      19H,0   ;halt ausgeben
          CEE1 2100B7   MBIU4   LD      HL,CASS
          CEE4 18B3             JR      MBIC5
          CEE6
          CEE6 CD9AF3   MERR    CALL    OSTR    ;Fehler im
          CEE9 09090909         DB      9,9,9,9 ;Block
          CEED 3F00             DB      '?',0
          CEEF CD94F3           CALL    BNROST
          CEF2 0D0A00           DB      CR,LF,0
          CEF5 18D5             JR      MBIU2
          CEF7
          CEF7 CD9AF3   JBLERR  CALL    OSTR    ;nicht erwarte-
          CEFA 2A0800           DB      '*',8,0 ;ter 1. Block
          CEFD CD14CF           CALL    JBRKT
          CF00 CD9DE5           CALL    MBI
          CF03 E5               PUSH    HL
          CF04 C348CE           JP      MBIC1
          CF07
          CF07 ED4BD8B7 MBLO    LD      BC,(VORTN)
          CF0B CD37E5           CALL    MBO
          CF0E CD94F3   MBLNR   CALL    BNROST
          CF11 3E1900           DB      '>',19H,0
          CF14 CDACE4   JBRKT   CALL    BRKT    ;bei BRK
          CF17 D0               RET     NC      ;auch ?IO ERROR
          CF18 C348F8           JP      JIOERR
          CF1B
          CF1B 7F7F     VIEW7F  DW      7F7FH
          CF1D 76696577         DB      'view'
          CF21 03               DB      3
          CF22 7D               LD      A,L
          CF23 FE10             CP      10H
          CF25 300C             JR      NC,VIEW1;L>0Fh
          CF27 7C               LD      A,H
          CF28 A7               AND     A
          CF29 2008             JR      NZ,VIEW1;H>0
          CF2B 2182B7           LD      HL,ARG1
          CF2E ED6F             RLD
          CF30 66               LD      H,M
          CF31 2E00             LD      L,0
          CF33 110088   VIEW1   LD      DE,8800H
          CF36 010020           LD      BC,2000H
          CF39 CD7AF7   VIEW2   CALL    LDAME   ;Byte holen
          CF3C 12               LD      (DE),A  ;in IRM poken
          CF3D 23               INC     HL
          CF3E 13               INC     DE
          CF3F 0D               DEC     C
          CF40 20F7             JR      NZ,VIEW2
          CF42 10F5             DJNZ    VIEW2
          CF44 3E0B     VIEW3   LD      A,0BH   ;Zeile hoch
          CF46 CDF7E3           CALL    CRT
          CF49 3E08             LD      A,8
          CF4B 32A0B7           LD      (CURSO),A
          CF4E CD51CF           CALL    VIEW4
          CF51 3E01     VIEW4   LD      A,1
          CF53 4F       VIEW5   LD      C,A
          CF54 CDD4F4           CALL    AHEX    ;HEX-Leiste
          CF57 79               LD      A,C
          CF58 C622             ADD     22H
          CF5A 30F7             JR      NC,VIEW5
          CF5C C9               RET
          CF5D
          CF5D          ;Druckereinstellungen
          CF5D
          CF5D 7F7F     PRI7F   DW      7F7FH
          CF5F 5052494E         DB      'PRINT',1FH
          CF65 1A       PRI     LD      A,(DE)
          CF66 A7               AND     A
          CF67 C8               RET     Z       ;fertig
          CF68 FE20             CP      ' '
          CF6A 2814             JR      Z,PRINC
          CF6C FE2C             CP      ','
          CF6E 2813             JR      Z,PRK   ;Zeichen
          CF70 FE27             CP      27H
          CF72 2813             JR      Z,PRSTR ;String
          CF74 CDF0F4           CALL    RHEX
          CF77 DABFF4           JP      C,ERRM  ;Fehler!
          CF7A 3A97B7           LD      A,(NUMVX)
          CF7D CDE9B7   PRIC    CALL    OFILT
          CF80 13       PRINC   INC     DE
          CF81 18E2             JR      PRI
          CF83 13       PRK     INC     DE
          CF84 1A               LD      A,(DE)  ;Zeichen
          CF85 18F6             JR      PRIC
          CF87 13       PRSTR   INC     DE
          CF88 1A               LD      A,(DE)
          CF89 A7               AND     A
          CF8A C8               RET     Z       ;Ende-0
          CF8B FE27             CP      27H
          CF8D 28F1             JR      Z,PRINC ;Stringende
          CF8F CDE9B7           CALL    OFILT
          CF92 18F3             JR      PRSTR
          CF94
          CF94                  ;Rest frei
          CF94
          CF94                  END

        Errors: 0000
        End+1 : CF94

          0200
          0200          ;**     CAOS 4.3 ROM D          **
          0200          ;       (17.02.95)
          0200
          0200                  ORG     0D000H
          D000
          D000          JDISC   ;MC-Sprungverteiler
          D000                  ;(fuer die 9 Grundfunktionen)
          D000                  ;
          D000 FE09             CP      9       ;Funktion 0-8
          D002 D0               RET     NC      ;zugelassen
          D003 F5               PUSH    AF
          D004 210000           LD      HL,0
          D007 CD80D0           CALL    NAM2    ;Name ausgeben
          D00A 2156D0           LD      HL,DTAB
          D00D F1               POP     AF
          D00E 87               ADD     A
          D00F 1600             LD      D,0
          D011 5F               LD      E,A
          D012 19               ADD     HL,DE
          D013 5E               LD      E,M     ;Tab. lesen
          D014 23               INC     HL
          D015 56               LD      D,M
          D016 D5               PUSH    DE      ;Sprungadresse
          D017
          D017          DISK    ;testet ob Floppy arbeitet
          D017 0180FC           LD      BC,0FC80H
          D01A ED78             IN      A,(C)
          D01C FEA7             CP      0A7H    ;Floppy?
          D01E 2813             JR      Z,DISK1
          D020 CD9AF3           CALL    OSTR
          D023 6B65696E         DB      'kein D004!'
          D02D 070D0A00         DB      7,CR,LF,0
          D031 E1               POP     HL
          D032 C9               RET
          D033 01F3B3   DISK1   LD      BC,0B3F3H
          D036 ED78             IN      A,(C)
          D038 FE05             CP      5       ;KC-BA?
          D03A C8               RET     Z
          D03B CD9AF3           CALL    OSTR
          D03E 43414F53         DB      'CAOS-Disk starten!'
          D050 070D0A00         DB      7,CR,LF,0
          D054 E1               POP     HL
          D055 C9               RET
          D056          ;
          D056          DTAB    ;Sprungtabelle Diskroutinen
          D056 DDD1             DW      FLOAD
          D058 9BD2             DW      FSAVE
          D05A FAD2             DW      DIR
          D05C 6ED3             DW      STAT
          D05E BDD3             DW      REN
          D060 0FD4             DW      SETRO
          D062 26D4             DW      SETWR
          D064 F8D3             DW      ERA
          D066 3AD4             DW      DRIVE
          D068          ;
          D068          NAME    ;Name ein-, ausgeben
          D068 EB               EX      DE,HL
          D069 7E               LD      A,M
          D06A E6DF             AND     0DFH
          D06C 2012             JR      NZ,NAM2 ;mit arg!
          D06E 210600   NAM0    LD      HL,6
          D071 CD9AF3   NAM1    CALL    OSTR
          D074 4E616D65         DB      'Name :',0
          D07B CD85F4           CALL    INLIN
          D07E D8               RET     C       ;BRK
          D07F 19               ADD     HL,DE
          D080 1E0C     NAM2    LD      E,12
          D082 01F382           LD      BC,82F3H
          D085 7E       NAM3    LD      A,M
          D086 ED79             OUT     (C),A
          D088 23               INC     HL
          D089 04               INC     B
          D08A 1D               DEC     E
          D08B 20F8             JR      NZ,NAM3
          D08D 0680             LD      B,80H
          D08F C9               RET
          D090          ;
          D090          STEUER2 ;Steuerbyte 2 ausgeben
          D090 01F180           LD      BC,80F1H
          D093 1803             JR      STEU0
          D095                  ;
          D095          STEUER  ;Steuerbyte 1 ausgeben
          D095 01F380           LD      BC,80F3H
          D098 ED79     STEU0   OUT     (C),A
          D09A C5       STEU1   PUSH    BC
          D09B 3E01             LD      A,1
          D09D CD86F3           CALL    WAIT
          D0A0 C1               POP     BC
          D0A1 ED78             IN      A,(C)
          D0A3 CB47             BIT     0,A
          D0A5 20F3             JR      NZ,STEU1;fertig?
          D0A7 CB7F             BIT     7,A
          D0A9 C8               RET     Z       ;kein Fehler
          D0AA C1               POP     BC      ;RET-Adresse!
          D0AB 01F183   FLERR   LD      BC,83F1H
          D0AE ED78             IN      A,(C)
          D0B0 FE20             CP      20H     ;DEP ab 2.0?
          D0B2 300B             JR      NC,FLER1;ja
          D0B4 01F381           LD      BC,81F3H
          D0B7 ED78             IN      A,(C)   ;Fehlernummer
          D0B9 CDD4F4           CALL    AHEX
          D0BC C3BFF4           JP      ERRM
          D0BF                  ;
          D0BF 01F100   FLER1   LD      BC,0F1H ;Fehlertext
          D0C2 ED78     FLER2   IN      A,(C)
          D0C4 04               INC     B
          D0C5 A7               AND     A
          D0C6 C8               RET     Z       ;00=Ende
          D0C7 CDC9F3           CALL    OCHR
          D0CA 18F6             JR      FLER2
          D0CC          ;
          D0CC          ;BASEX-Programmteil mit Fehlertexten
          D0CC          ;
          D0CC 219ED1   BASEX   LD      HL,BAS
          D0CF 11D800           LD      DE,0D8H
          D0D2 013000           LD      BC,BASE-BAS
          D0D5 EDB0             LDIR            ;Verteiler
          D0D7 2176D1           LD      HL,UMS
          D0DA 115001           LD      DE,150H
          D0DD 012800           LD      BC,UMSE-UMS
          D0E0 EDB0             LDIR            ;Umschaltung
          D0E2 210CD1           LD      HL,BASEC
          D0E5 110002           LD      DE,200H
          D0E8 016A00           LD      BC,UMS-BASEC
          D0EB EDB0             LDIR            ;BASEX selbst
          D0ED 2AB0B7           LD      HL,(SUTAB)
          D0F0 220102           LD      (SUSP),HL
          D0F3 116A02           LD      DE,SUBAS
          D0F6 ED53B0B7         LD      (SUTAB),DE
          D0FA 019200           LD      BC,92H
          D0FD EDB0             LDIR            ;SUTAB
          D0FF 215202           LD      HL,MBIND
          D102 22D802           LD      (SUBAS+6EH),HL
          D105 210302           LD      HL,MBOUTD
          D108 22DA02           LD      (SUBAS+70H),HL
          D10B C9               RET
          D10C
          D10C          BASEC   EQU     $       ;Adresse im ROMC
          D10C          RUN     EQU     $-BASEC+200H
          D10C 00               DB      0       ;1 ->RUN-Switch
          D10D          SUSP    EQU     $-BASEC+200H
          D10D 0000             DW      0       ;Speicher SUTAB
          D10F
          D10F          MBOUTD  EQU     $-BASEC+200H
          D10F 01F38E           LD      BC,8EF3H
          D112 ED79             OUT     (C),A   ;Datenbyte
          D114 7A               LD      A,D
          D115 E648             AND     48H
          D117 F637             OR      37H
          D119 CD6501           CALL    NAMBAS
          D11C CB77             BIT     6,A     ;close?
          D11E 280A             JR      Z,O1
          D120 57               LD      D,A
          D121 3A0002           LD      A,(RUN)
          D124 A7               AND     A
          D125 7A               LD      A,D
          D126 2802             JR      Z,O1
          D128 CBFF             SET     7,A     ;run-switch
          D12A ED79     O1      OUT     (C),A   ;Steuerbyte
          D12C ED78     O2      IN      A,(C)
          D12E CB47             BIT     0,A     ;fertig?
          D130 20FA             JR      NZ,O2
          D132 07               RLCA
          D133 DDCB08C6         SET     0,(IX+8);Taste gedrueckt
          D137 D0               RET     NC
          D138 01F183   BASERR  LD      BC,83F1H
          D13B ED78             IN      A,(C)
          D13D FE20             CP      20H     ;DEP ab 2.0?
          D13F 3010             JR      NC,BERR2;ja
          D141 01F381           LD      BC,81F3H
          D144 ED78             IN      A,(C)
          D146 CD03F0           CALL    0F003H
          D149 1C               DB      1CH     ;Fehler-Nr.
          D14A 2AC9B7   BERR1   LD      HL,(IOERR)
          D14D E5               PUSH    HL
          D14E C31BF0           JP      0F01BH
          D151 0600     BERR2   LD      B,0     ;Fehlertext
          D153 ED78     BERR3   IN      A,(C)
          D155 28F3             JR      Z,BERR1 ;00-Ende
          D157 04               INC     B
          D158 CD03F0           CALL    0F003H
          D15B 24               DB      24H     ;OCHR
          D15C 18F5             JR      BERR3
          D15E
          D15E          MBIND   EQU     $-BASEC+200H
          D15E 7A               LD      A,D
          D15F E648             AND     48H
          D161 F635             OR      35H
          D163 CD6501           CALL    NAMBAS
          D166 ED79             OUT     (C),A   ;Steuerbyte
          D168 ED78     I1      IN      A,(C)
          D16A CB47             BIT     0,A     ;fertig?
          D16C 20FA             JR      NZ,I1
          D16E 07               RLCA
          D16F 38C7             JR      C,BASERR;Fehler
          D171 068E             LD      B,8EH
          D173 ED78             IN      A,(C)   ;Datenbyte
          D175 C9               RET
          D176
          D176          SUBAS   EQU     $-BASEC+200H
          D176                  ;hier wird die SUTAB hin kopiert
          D176
          D176          UMS     ;Umschaltung Tape/Disk
          D176 CD18F0           CALL    0F018H
          D179 2A0102           LD      HL,(SUSP)
          D17C ED5BB0B7         LD      DE,(SUTAB)
          D180 22B0B7           LD      (SUTAB),HL
          D183 ED530102         LD      (SUSP),DE
          D187 CD1BF0           CALL    0F01BH
          D18A C9               RET
          D18B
          D18B          ;Dateiname (in BASEX) ausgeben:
          D18B
          D18B          NAMBAS  EQU     $-UMS+150H
          D18B 01F383           LD      BC,83F3H
          D18E CB5F             BIT     3,A     ;open?
          D190 2809             JR      Z,NAMB2
          D192 1E0B             LD      E,11    ;Anzahl
          D194 EDA3     NAMB1   OUTI
          D196 04               INC     B
          D197 04               INC     B
          D198 1D               DEC     E
          D199 20F9             JR      NZ,NAMB1
          D19B 0680     NAMB2   LD      B,80H   ;BC fuer Steuer-
          D19D C9               RET             ;byte
          D19E          UMSE    ;Ende der Umschaltroutine
          D19E
          D19E          BAS     ;BASIC-Schnittstelle
          D19E                  ;(vorbereitet fuer 12 Funktionen)
          D19E 3E00             LD      A,0     ;CALL*D8
          D1A0 01               DB      1
          D1A1 3E01             LD      A,1     ;CALL*DB
          D1A3 01               DB      1
          D1A4 3E02             LD      A,2     ;CALL*DE
          D1A6 01               DB      1
          D1A7 3E03             LD      A,3     ;CALL*E1
          D1A9 01               DB      1
          D1AA 3E04             LD      A,4     ;CALL*E4
          D1AC 01               DB      1
          D1AD 3E05             LD      A,5     ;CALL*E7
          D1AF 01               DB      1
          D1B0 3E06             LD      A,6     ;CALL*EA
          D1B2 01               DB      1
          D1B3 3E07             LD      A,7     ;CALL*ED
          D1B5 01               DB      1
          D1B6 3E08             LD      A,8     ;CALL*F0
          D1B8 01               DB      1
          D1B9 3E09             LD      A,9     ;CALL*F3
          D1BB 01               DB      1
          D1BC 3E0A             LD      A,10    ;CALL*F6
          D1BE 01               DB      1
          D1BF 3E0B             LD      A,11    ;CALL*F9
          D1C1 01               DB      1
          D1C2 3E0C             LD      A,12    ;CALL*FC
          D1C4 CD18F0           CALL    0F018H
          D1C7 CD21F0           CALL    JDISK   ;Disk-Verteiler
          D1CA CD1BF0           CALL    0F01BH
          D1CD C9               RET
          D1CE          BASE    ;Ende BASIC-Verteiler
          D1CE
          D1CE 7F7F     FLOA7F  DW      7F7FH
          D1D0 464C4F41         DB      'FLOAD'
          D1D5 01               DB      1
          D1D6 CD17D0           CALL    DISK
          D1D9 CD6ED0           CALL    NAM0
          D1DC D8               RET     C       ;BRK
          D1DD 3A81B7   FLOAD   LD      A,(ARGN)
          D1E0 FE02             CP      2
          D1E2 3E00             LD      A,0
          D1E4 3802             JR      C,FLO0
          D1E6 CBCF             SET     1,A     ;kein Autostart
          D1E8 DD7707   FLO0    LD      (IX+7),A
          D1EB 3E09             LD      A,9     ;Lesen open
          D1ED CD95D0           CALL    STEUER
          D1F0 01F290           LD      BC,90F2H
          D1F3 ED78             IN      A,(C)   ;Anzahl
          D1F5 CB27             SLA     A
          D1F7 CB27             SLA     A
          D1F9 E61C             AND     1CH
          D1FB DDB607           OR      (IX+7)
          D1FE DD7707           LD      (IX+7),A
          D201 ED78             IN      A,(C)   ;Anzahl
          D203 FE02             CP      2
          D205 3804             JR      C,FLO1  ;wenn<2
          D207 FE0A             CP      10
          D209 3817             JR      C,FLO2  ;wenn>10
          D20B CD9AF3   FLO1    CALL    OSTR
          D20E 6B65696E         DB      'keine MC-Datei!'
          D21D 070D0A00         DB      7,CR,LF,0
          D221 C9               RET
          D222 04       FLO2    INC     B
          D223 ED68             IN      L,(C)
          D225 04               INC     B
          D226 ED60             IN      H,(C)   ;HL=Ladeadr
          D228 04               INC     B
          D229 ED58             IN      E,(C)
          D22B 04               INC     B
          D22C ED50             IN      D,(C)   ;DE=Endadr
          D22E FE03             CP      3
          D230 3808             JR      C,FLO3  ;keine Startadr
          D232 E5               PUSH    HL
          D233 04               INC     B
          D234 ED68             IN      L,(C)
          D236 04               INC     B
          D237 ED60             IN      H,(C)   ;Startadr
          D239 E3               EX      (SP),HL
          D23A 08       FLO3    EX      AF,AF'
          D23B 3A81B7           LD      A,(ARGN)
          D23E A7               AND     A
          D23F 280F             JR      Z,FLO5  ;ohne Offset
          D241 ED4B82B7         LD      BC,(ARG1);Offset
          D245 09               ADD     HL,BC
          D246 EB               EX      DE,HL
          D247 09               ADD     HL,BC
          D248 EB               EX      DE,HL
          D249 08               EX      AF,AF'
          D24A 3803             JR      C,FLO4  ;keine Startadr
          D24C E3               EX      (SP),HL
          D24D 09               ADD     HL,BC
          D24E E3               EX      (SP),HL
          D24F 08       FLO4    EX      AF,AF'
          D250 CDE7F4   FLO5    CALL    HLDE    ;Aadr Eadr
          D253 08               EX      AF,AF'
          D254 3808             JR      C,FLO6  ;keine Startadr
          D256 E3               EX      (SP),HL
          D257 2286B7           LD      (ARG3),HL
          D25A CDB2F4           CALL    HLHX    ;Sadr
          D25D E1               POP     HL
          D25E CDC9F4   FLO6    CALL    CRLF
          D261 3E01     FLO7    LD      A,1     ;Lesen normal
          D263 CD95D0           CALL    STEUER
          D266 0D               DEC     C
          D267 ED78     FLO8    IN      A,(C)
          D269 CD9DF7           CALL    LDMAE   ;in Speicher
          D26C 23               INC     HL
          D26D 04               INC     B
          D26E E5               PUSH    HL
          D26F ED52             SBC     HL,DE   ;Ende?
          D271 E1               POP     HL
          D272 3006             JR      NC,FLO9 ;ja
          D274 78               LD      A,B
          D275 A7               AND     A
          D276 20EF             JR      NZ,FLO8
          D278 18E7             JR      FLO7
          D27A DD7E07   FLO9    LD      A,(IX+7)
          D27D CB4F             BIT     1,A
          D27F C0               RET     NZ      ;kein Start
          D280 E61C             AND     1CH
          D282 FE0C             CP      0CH
          D284 D8               RET     C       ;keine Sadr
          D285 2A86B7           LD      HL,(ARG3);Sadr
          D288 E5               PUSH    HL
          D289 C372FB           JP      COFF    ;erst CAOSC off!
          D28C
          D28C 7F7F     FSAV7F  DW      7F7FH
          D28E 46534156         DB      'FSAVE'
          D293 05               DB      5
          D294 CD17D0           CALL    DISK
          D297 CD6ED0           CALL    NAM0
          D29A D8               RET     C       ;BRK
          D29B CD1FE5   FSAVE   CALL    CLC     ;Puffer loeschen
          D29E 2E81             LD      L,ARGN
          D2A0 1110B7           LD      DE,CASS+10H
          D2A3 011500           LD      BC,15H
          D2A6 EDB0             LDIR            ;Arg's
          D2A8 2E00             LD      L,0
          D2AA 01F281           LD      BC,81F2H
          D2AD 1E80             LD      E,80H
          D2AF EDA3     FSA2    OUTI            ;Vorblock
          D2B1 04               INC     B
          D2B2 04               INC     B
          D2B3 1D               DEC     E
          D2B4 20F9             JR      NZ,FSA2
          D2B6 3E0B             LD      A,0BH   ;Schreib open
          D2B8 CD95D0           CALL    STEUER
          D2BB 2A82B7           LD      HL,(ARG1);Aadr
          D2BE 01F280   FSA3    LD      BC,80F2H
          D2C1 1E80             LD      E,80H
          D2C3 CD7AF7   FSA4    CALL    LDAME   ;Daten
          D2C6 23               INC     HL
          D2C7 ED79             OUT     (C),A
          D2C9 04               INC     B
          D2CA 1D               DEC     E
          D2CB 20F6             JR      NZ,FSA4
          D2CD 3E03             LD      A,3     ;Schreib normal
          D2CF CD95D0           CALL    STEUER
          D2D2 E5               PUSH    HL
          D2D3 ED5B84B7         LD      DE,(ARG2);Eadr
          D2D7 A7               AND     A
          D2D8 ED52             SBC     HL,DE   ;fertig?
          D2DA E1               POP     HL
          D2DB 38E1             JR      C,FSA3  ;nein
          D2DD 3E43             LD      A,43H   ;Schreib close
          D2DF CD95D0           CALL    STEUER
          D2E2 CD1FE5           CALL    CLC     ;Puffer loeschen
          D2E5 C9               RET
          D2E6
          D2E6          ;Directory mit Maske
          D2E6          ;
          D2E6 7F7F     DIR7F   DW      7F7FH
          D2E8 444952           DB      'DIR'
          D2EB 1F               DB      1FH
          D2EC CD17D0           CALL    DISK
          D2EF EB               EX      DE,HL   ;Maske
          D2F0 1100B7           LD      DE,CASS
          D2F3 010B00           LD      BC,11   ;Laenge
          D2F6 EDB0             LDIR
          D2F8 1803             JR      DIR0
          D2FA 1100B7   DIR     LD      DE,CASS
          D2FD AF       DIR0    XOR     A       ;Abschluî Maske
          D2FE 12               LD      (DE),A
          D2FF 3E0D             LD      A,0DH   ;Directory open
          D301 CD95D0   DIR1    CALL    STEUER
          D304 CB57             BIT     2,A
          D306 2041             JR      NZ,DIR6 ;Ende
          D308 0682             LD      B,82H
          D30A 210CB7           LD      HL,CASS+0CH
          D30D A7               AND     A       ;CY=0
          D30E 1603             LD      D,3     ;3 Eintraege
          D310 1E0B     DIR2    LD      E,11    ;11 Zeichen lang
          D312 ED78     DIR3    IN      A,(C)   ;einlesen
          D314 F5               PUSH    AF
          D315 E67F             AND     7FH
          D317 04               INC     B
          D318 77               LD      M,A
          D319 23               INC     HL
          D31A 7B               LD      A,E
          D31B FE03             CP      3       ;RO-Byte?
          D31D 2801             JR      Z,DIR4
          D31F F1               POP     AF
          D320 1D       DIR4    DEC     E
          D321 20EF             JR      NZ,DIR3
          D323 3600             LD      M,0     ;Ende-Kennung
          D325 23               INC     HL
          D326 04               INC     B
          D327 F1               POP     AF
          D328 77               LD      M,A     ;RO-Byte
          D329 23               INC     HL
          D32A 15               DEC     D
          D32B 20E3             JR      NZ,DIR2
          D32D 210CB7           LD      HL,CASS+0CH
          D330 0603             LD      B,3
          D332 E5       DIR5    PUSH    HL
          D333 1100B7           LD      DE,CASS
          D336 1A               LD      A,(DE)
          D337 A7               AND     A
          D338 C487D3           CALL    NZ,GLOB ;Vergleich
          D33B E1               POP     HL
          D33C D452D3           CALL    NC,DIR7 ;Anzeige
          D33F 110D00           LD      DE,13
          D342 19               ADD     HL,DE
          D343 10ED             DJNZ    DIR5    ;3 Eintraege
          D345 3E05             LD      A,5     ;DIR weiter
          D347 18B8             JR      DIR1
          D349                  ;
          D349 3AA0B7   DIR6    LD      A,(CURSO)
          D34C A7               AND     A
          D34D C4C9F4           CALL    NZ,CRLF
          D350 181C             JR      STAT
          D352                  ;
          D352 E5       DIR7    PUSH    HL
          D353 3AA0B7           LD      A,(CURSO)
          D356 FE27             CP      3*13
          D358 CCC9F4           CALL    Z,CRLF
          D35B CDECF8           CALL    ZKOUT
          D35E 3E20             LD      A,' '   ;WR
          D360 CB7E             BIT     7,M
          D362 2802             JR      Z,DIR8
          D364 3E2A             LD      A,'*'   ;RO
          D366 CDC9F3   DIR8    CALL    OCHR
          D369 CDBAF4           CALL    SPACE
          D36C E1               POP     HL
          D36D C9               RET
          D36E          ;
          D36E 3E15     STAT    LD      A,15H   ;Status
          D370 CD95D0           CALL    STEUER
          D373 1E14             LD      E,20
          D375 0682             LD      B,82H
          D377 ED78     STAT1   IN      A,(C)
          D379 E67F             AND     7FH
          D37B 04               INC     B
          D37C F5               PUSH    AF
          D37D CDC9F3           CALL    OCHR
          D380 F1               POP     AF
          D381 1D               DEC     E
          D382 20F3             JR      NZ,STAT1
          D384 C9               RET
          D385
          D385          ;Vergleich mit Maske
          D385          ;
          D385 23       MAT0    INC     HL
          D386 13       MAT0E   INC     DE
          D387          GLOB    ;Eintritt, HL=Name, DE=Maske
          D387                  ;PA: CY=1: nicht gefunden
          D387 1A               LD      A,(DE)
          D388 B6               OR      M       ;Beide Ende?
          D389 C8               RET     Z       ;->OK
          D38A 1A               LD      A,(DE)
          D38B FE2A             CP      '*'
          D38D 2816             JR      Z,MAT0S
          D38F FE01             CP      1
          D391 D8               RET     C       ;M Ende
          D392 7E               LD      A,M
          D393 FE01             CP      1
          D395 D8               RET     C       ;N Ende
          D396 1A               LD      A,(DE)
          D397 FE3F             CP      '?'
          D399 28EA             JR      Z,MAT0  ;Joker
          D39B CB6E             BIT     5,M
          D39D CC42F5           CALL    Z,UPCASE
          D3A0 BE               CP      M
          D3A1 28E2             JR      Z,MAT0
          D3A3 37               SCF
          D3A4 C9               RET
          D3A5                  ;
          D3A5 E5       MAT0S   PUSH    HL
          D3A6 D5               PUSH    DE
          D3A7 CD86D3           CALL    MAT0E   ;Rekursion!
          D3AA D1               POP     DE
          D3AB E1               POP     HL
          D3AC D0               RET     NC      ;-> OK
          D3AD 7E               LD      A,M
          D3AE 23               INC     HL
          D3AF B7               OR      A
          D3B0 20F3             JR      NZ,MAT0S
          D3B2 37               SCF
          D3B3 C9               RET
          D3B4          ;
          D3B4 7F7F     REN7F   DW      7F7FH
          D3B6 52454E           DB      'REN'
          D3B9 1F               DB      1FH
          D3BA CD17D0           CALL    DISK
          D3BD CD9AF3   REN     CALL    OSTR
          D3C0 416C7465         DB      'Alter ',0
          D3C7 210C00           LD      HL,12
          D3CA CD71D0           CALL    NAM1
          D3CD D8               RET     C       ;BRK
          D3CE 3E29             LD      A,29H   ;Ren old
          D3D0 CD95D0           CALL    STEUER
          D3D3 CD9AF3           CALL    OSTR
          D3D6 4E657565         DB      'Neuer ',0
          D3DD 210C00           LD      HL,12
          D3E0 CD71D0           CALL    NAM1
          D3E3 3E21             LD      A,21H   ;Ren new
          D3E5 D8       OUT     RET     C       ;BRK
          D3E6 CD95D0           CALL    STEUER
          D3E9 C9               RET
          D3EA          ;
          D3EA 7F7F     ERA7F   DW      7F7FH
          D3EC 455241           DB      'ERA'
          D3EF 1F               DB      1FH
          D3F0 CD17D0           CALL    DISK
          D3F3 CD68D0           CALL    NAME
          D3F6 1803             JR      ERA1
          D3F8 CD6ED0   ERA     CALL    NAM0
          D3FB 3E11     ERA1    LD      A,11H   ;Era
          D3FD 18E6             JR      OUT
          D3FF          ;
          D3FF 7F7F     SRO7F   DW      7F7FH
          D401 53455452         DB      'SETRO'
          D406 1F               DB      1FH
          D407 CD17D0           CALL    DISK
          D40A CD68D0           CALL    NAME
          D40D 1803             JR      SETR1
          D40F CD6ED0   SETRO   CALL    NAM0
          D412 3E25     SETR1   LD      A,25H   ;Setro
          D414 18CF             JR      OUT
          D416          ;
          D416 7F7F     SWR7F   DW      7F7FH
          D418 53455457         DB      'SETWR'
          D41D 1F               DB      1FH
          D41E CD17D0           CALL    DISK
          D421 CD68D0           CALL    NAME
          D424 1803             JR      SETW1
          D426 CD6ED0   SETWR   CALL    NAM0
          D429 3E31     SETW1   LD      A,31H   ;Setwr
          D42B 18B8             JR      OUT
          D42D          ;
          D42D 7F7F     DRIV7F  DW      7F7FH
          D42F 44524956         DB      'DRIVE'
          D434 1F               DB      1FH
          D435 CD17D0           CALL    DISK
          D438 1803             JR      DRIV0
          D43A 1156D4   DRIVE   LD      DE,DRIV1
          D43D 01F183   DRIV0   LD      BC,83F1H
          D440 ED78             IN      A,(C)
          D442 FE20             CP      20H     ;DEP ab 2.0?
          D444 3012             JR      NC,DRIV2;nein
          D446 CD9AF3           CALL    OSTR
          D449 6B65696E         DB      'kein DEP2!'
          D453 070D0A           DB      7,CR,LF
          D456 00       DRIV1   NOP
          D457 C9               RET
          D458 EB       DRIV2   EX      DE,HL
          D459 7E               LD      A,M
          D45A E6DF             AND     0DFH
          D45C 202F             JR      NZ,DRIV3;mit arg
          D45E CD9AF3           CALL    OSTR
          D461 4C617566         DB      'Laufwerk:',0
          D46B 3E01             LD      A,1     ;akt. lesen
          D46D CD90D0           CALL    STEUER2
          D470 01F181           LD      BC,81F1H
          D473 ED78             IN      A,(C)
          D475 CDC9F3           CALL    OCHR    ;Laufwerk
          D478 04               INC     B
          D479 ED78             IN      A,(C)   ;akt. User
          D47B E60F             AND     0FH
          D47D C4DDF4           CALL    NZ,AHEX0;Userbereich
          D480 3E09             LD      A,9
          D482 32A0B7           LD      (CURSO),A
          D485 CD85F4           CALL    INLIN   ;Eingabe
          D488 D8               RET     C       ;BRK
          D489 210900           LD      HL,9
          D48C 19               ADD     HL,DE
          D48D 01F181   DRIV3   LD      BC,81F1H
          D490 7E               LD      A,M
          D491 A7               AND     A       ;leer?
          D492 C8               RET     Z
          D493 CD42F5           CALL    UPCASE
          D496 ED79             OUT     (C),A   ;LW-Code
          D498 23               INC     HL
          D499 7E               LD      A,M
          D49A A7               AND     A       ;USER angeg.?
          D49B 3E03             LD      A,3     ;nur LW anf.
          D49D 2810             JR      Z,DRIV5
          D49F EB               EX      DE,HL
          D4A0 CDF0F4           CALL    RHEX
          D4A3 3E00             LD      A,0     ;USER 0, weil
          D4A5 3803             JR      C,DRIV4 ;keine HEX-Zahl
          D4A7 3A97B7           LD      A,(NUMVX)
          D4AA 04       DRIV4   INC     B
          D4AB ED79             OUT     (C),A   ;USER-Nr.
          D4AD 3E07             LD      A,7     ;LW+User anf.
          D4AF CD90D0   DRIV5   CALL    STEUER2
          D4B2 C9               RET
          D4B3          ;
          D4B3 7F7F     TYPE7F  DW      7F7FH
          D4B5 54595045         DB      'TYPE'
          D4B9 1F               DB      1FH
          D4BA CD17D0           CALL    DISK
          D4BD CD68D0           CALL    NAME
          D4C0 D8               RET     C       ;BRK
          D4C1 3E09             LD      A,9     ;read-open
          D4C3 CD95D0           CALL    STEUER
          D4C6 01F290           LD      BC,90F2H
          D4C9 ED70             INF
          D4CB 0680             LD      B,80H
          D4CD 2006             JR      NZ,TYPE2;kein Vorblock
          D4CF 3E01     TYPE1   LD      A,1     ;read
          D4D1 CD95D0           CALL    STEUER
          D4D4 0D               DEC     C
          D4D5 ED78     TYPE2   IN      A,(C)   ;Zeichen
          D4D7 FE03             CP      3
          D4D9 CAC9F4           JP      Z,CRLF  ;CAOS-Ende
          D4DC FE1A             CP      1AH
          D4DE CAC9F4           JP      Z,CRLF  ;CP/M-Ende
          D4E1 FE20             CP      20H
          D4E3 301C             JR      NC,TYPE5
          D4E5 FE0A             CP      LF
          D4E7 2818             JR      Z,TYPE5
          D4E9 FE0D             CP      CR
          D4EB 2814             JR      Z,TYPE5
          D4ED FE09             CP      9
          D4EF 200E             JR      NZ,TYPE4
          D4F1 3E20     TYPE3   LD      A,' '
          D4F3 CDC9F3           CALL    OCHR
          D4F6 3AA0B7           LD      A,(CURSO)
          D4F9 E607             AND     7
          D4FB 20F4             JR      NZ,TYPE3
          D4FD 1805             JR      TYPE6
          D4FF 3E2E     TYPE4   LD      A,'.'   ;statt Steuerz.
          D501 CDC9F3   TYPE5   CALL    OCHR
          D504 3AA1B7   TYPE6   LD      A,(CURSO+1)
          D507 3C               INC     A
          D508 219FB7           LD      HL,WINLG+1
          D50B BE               CP      (HL)    ;Seite voll?
          D50C 2019             JR      NZ,TYPE9
          D50E CDC3F3   TYPE7   CALL    INTB
          D511 FE03             CP      3
          D513 C8               RET     Z       ;BRK
          D514 FE0F             CP      0FH
          D516 2005             JR      NZ,TYPE8
          D518 CDC9F3           CALL    OCHR    ;Hardcopy
          D51B 18F1             JR      TYPE7
          D51D 3E0C     TYPE8   LD      A,0CH
          D51F CDF7E3           CALL    CRT
          D522 3E0A             LD      A,LF
          D524 CDF7E3           CALL    CRT
          D527 04       TYPE9   INC     B
          D528 20AB             JR      NZ,TYPE2;weiter
          D52A 18A3             JR      TYPE1   ;neuen Block
          D52C          ;
          D52C 7F7F     DUMP7F  DW      7F7FH
          D52E 44554D50         DB      'DUMP'
          D532 1F               DB      1FH
          D533 CD17D0           CALL    DISK
          D536 CD68D0           CALL    NAME
          D539 D8               RET     C       ;BRK
          D53A 3E09             LD      A,9     ;read-open
          D53C CD95D0           CALL    STEUER
          D53F 1805             JR      DUMP2
          D541 3E01     DUMP1   LD      A,1     ;read
          D543 CD95D0           CALL    STEUER
          D546 0D       DUMP2   DEC     C
          D547 C5       DUMP3   PUSH    BC
          D548 3E20     DUMP4   LD      A,' '
          D54A CDC9F3           CALL    OCHR
          D54D ED78             IN      A,(C)
          D54F CDD4F4           CALL    AHEX
          D552 04               INC     B
          D553 3E07             LD      A,7
          D555 A0               AND     B       ;8*Hexwert
          D556 20F0             JR      NZ,DUMP4
          D558 CD9AF3           CALL    OSTR
          D55B 20202000         DB      '   ',0
          D55F C1               POP     BC
          D560 ED78     DUMP5   IN      A,(C)
          D562 CD5AF7           CALL    CSTBT
          D565 04               INC     B
          D566 3E07             LD      A,7
          D568 A0               AND     B       ;8*Ascii
          D569 20F5             JR      NZ,DUMP5
          D56B CDC9F4           CALL    CRLF
          D56E 3AA1B7           LD      A,(CURSO+1)
          D571 3C               INC     A
          D572 219FB7           LD      HL,WINLG+1
          D575 BE               CP      (HL)    ;Seite voll?
          D576 2019             JR      NZ,DUMP8
          D578 CDC3F3   DUMP6   CALL    INTB
          D57B FE03             CP      3       ;BRK?
          D57D C8               RET     Z       ;ja
          D57E FE0F             CP      0FH
          D580 2005             JR      NZ,DUMP7
          D582 CDC9F3           CALL    OCHR    ;Hardcopy
          D585 18F1             JR      DUMP6
          D587 3E0C     DUMP7   LD      A,0CH
          D589 CDF7E3           CALL    CRT
          D58C 3E0A             LD      A,LF
          D58E CDF7E3           CALL    CRT
          D591 78       DUMP8   LD      A,B
          D592 A7               AND     A
          D593 20B2             JR      NZ,DUMP3
          D595 18AA             JR      DUMP1
          D597          ;
          D597 494E4954 UUU     DB      'INITIAL.UUU',0
          D5A3 7F7F             DW      7F7FH
          D5A5 494E4954         DB      'INIT'
          D5A9 1F               DB      1FH
          D5AA CD17D0           CALL    DISK
          D5AD EB               EX      DE,HL
          D5AE 7E               LD      A,M
          D5AF E6DF             AND     0DFH
          D5B1 282C             JR      Z,INIT3 ;Standard
          D5B3 E5               PUSH    HL
          D5B4 7E       INIT1   LD      A,M
          D5B5 A7               AND     A
          D5B6 282B             JR      Z,INIT4 ;Ende Dateiname
          D5B8 23               INC     HL
          D5B9 FE3A             CP      ':'     ;LW?
          D5BB 20F7             JR      NZ,INIT1
          D5BD 7E               LD      A,M
          D5BE E1               POP     HL
          D5BF A7               AND     A
          D5C0 2021             JR      NZ,INIT4        ;LW & Na
          D5C2 01F181           LD      BC,81F1H
          D5C5 7E               LD      A,M
          D5C6 ED79             OUT     (C),A   ;LW-Code
          D5C8 23               INC     HL
          D5C9 7E               LD      A,M
          D5CA FE3A             CP      ':'
          D5CC 3E03             LD      A,3     ;ohne USER
          D5CE 280C             JR      Z,INIT2 ;nur LW
          D5D0 EB               EX      DE,HL
          D5D1 CDF0F4           CALL    RHEX
          D5D4 3A97B7           LD      A,(NUMVX)
          D5D7 04               INC     B
          D5D8 ED79             OUT     (C),A   ;User
          D5DA 3E07             LD      A,7
          D5DC CD90D0   INIT2   CALL    STEUER2
          D5DF 2197D5   INIT3   LD      HL,UUU
          D5E2 E5               PUSH    HL
          D5E3 E1       INIT4   POP     HL
          D5E4 CD80D0   INIT5   CALL    NAM2
          D5E7 1100B7           LD      DE,CASS
          D5EA 3E09             LD      A,9     ;read-open
          D5EC CD95D0   INIT6   CALL    STEUER
          D5EF 0D               DEC     C
          D5F0 ED78     INIT7   IN      A,(C)   ;Zeichen
          D5F2 A7               AND     A
          D5F3 2813             JR      Z,INIT8 ;00 ignorieren
          D5F5 FE03             CP      3
          D5F7 2816             JR      Z,INIT9 ;CAOS-Ende
          D5F9 FE0A             CP      0AH
          D5FB 280B             JR      Z,INIT8 ;LF ignorieren
          D5FD FE1A             CP      1AH
          D5FF 280E             JR      Z,INIT9 ;CP/M-Ende
          D601 12               LD      (DE),A
          D602 1C               INC     E
          D603 7B               LD      A,E
          D604 FE7F             CP      7FH
          D606 2807             JR      Z,INIT9 ;Puffer voll!
          D608 04       INIT8   INC     B
          D609 20E5             JR      NZ,INIT7;weiter
          D60B 3E01             LD      A,1
          D60D 18DD             JR      INIT6   ;neuen Block
          D60F 3E00     INIT9   LD      A,0
          D611 12               LD      (DE),A  ;Ende
          D612 2100B7           LD      HL,CASS
          D615 22D1B7           LD      (FTAST),HL
          D618 DDCB08F6         SET     6,(IX+8)
          D61C C9               RET
          D61D
          D61D                  ;Rest frei
          D61D
          D61D                  END

        Errors: 0000
        End+1 : D61D

          0200
          0200          ;**     CAOS 4.3 ROM E          **
          0200          ;       (17.02.95)
          0200
          0200                  ORG     0E000H
          E000
          E000 C38EF1           JP      BYE     ;Tasten-RESET
          E003 C35BE6           JP      BEXP1   ;BASIC-
          E006 C36FE6           JP      BEXP2   ;Expansionen
          E009 C3E7E6           JP      BEXP3
          E00C 0FFD             DW      TOKTAB
          E00E C364F8   BASIO   JP      BASPV
          E011
          E011 7F7F             DW      7F7FH
          E013 42415349         DB      'BASIC'
          E018 11               DB      11H
          E019 CD2FE0           CALL    BASON
          E01C C30DC0           JP      0C00DH  ;Kaltstart
          E01F
          E01F 7F7F             DW      7F7FH
          E021 52454241         DB      'REBASIC'
          E028 11               DB      11H
          E029 CD2FE0           CALL    BASON
          E02C C38CC0           JP      0C08CH  ;Warmstart
          E02F
          E02F          BASON   ;BASIC vorbereiten
          E02F 01F3B3           LD      BC,0B3F3H
          E032 ED78             IN      A,(C)
          E034 FE05             CP      5       ;KC-BA?
          E036 2006             JR      NZ,BASO1
          E038 CD6BFB           CALL    CON
          E03B CDCCD0           CALL    BASEX   ;DISK-Treiber
          E03E 1600     BASO1   LD      D,0
          E040 3E02             LD      A,2
          E042 2E05             LD      L,5
          E044 CD09F1           CALL    MODU    ;CAOSC off
          E047 16C1             LD      D,0C1H
          E049 3E02             LD      A,2
          E04B 6F               LD      L,A
          E04C CD09F1           CALL    MODU    ;BASIC-Ebene on
          E04F C345F0           JP      SCROFF  ;IRM off
          E052
          E052          ;CRT-Treiber
          E052
          E052 ED5BA0B7 PADR0   LD      DE,(CURSO)
          E056 2A9CB7   PADR1   LD      HL,(WINON)
          E059 19               ADD     HL,DE
          E05A CB24             SLA     H
          E05C CB24             SLA     H
          E05E CB24             SLA     H
          E060                  ;
          E060 F5       PADR    PUSH    AF              ;**34**
          E061 7D               LD      A,L     ;Spalte
          E062 6C               LD      L,H     ;Pixelzeile
          E063 FE28             CP      28H
          E065 3006             JR      NC,IAD2 ;zu groî
          E067 F680             OR      80H
          E069 67               LD      H,A     ;HL=Pixeladr.
          E06A F1               POP     AF
          E06B A7               AND     A       ;CY=0
          E06C C9               RET
          E06D F1       IAD2    POP     AF
          E06E 37               SCF             ;CY=1
          E06F C9               RET
          E070
          E070          TCIF    ;Test Cursor im Fenster  **33**
          E070 3A9EB7           LD      A,(WINLG)
          E073 3D               DEC     A
          E074 93               SUB     E       ;Cursor-Spalte
          E075 D8               RET     C
          E076 3A9FB7           LD      A,(WINLG+1)
          E079 3D               DEC     A
          E07A 92               SUB     D       ;Cursor-Zeile
          E07B C9               RET
          E07C
          E07C F5       DABR    PUSH    AF              ;**32**
          E07D CD70E0           CALL    TCIF
          E080 38EB             JR      C,IAD2
          E082 3A9CB7           LD      A,(WINON)
          E085 83               ADD     E       ;Cursor-Spalte
          E086 D5               PUSH    DE
          E087 5F               LD      E,A     ;absolut
          E088 3A9DB7           LD      A,(WINON+1)
          E08B 82               ADD     D       ;Cursor-Zeile
          E08C 87               ADD     A
          E08D 87               ADD     A
          E08E 87               ADD     A       ;*8
          E08F 6F               LD      L,A     ;Pixelzeile
          E090 2600             LD      H,0
          E092 54               LD      D,H     ;D=0
          E093 29               ADD     HL,HL
          E094 29               ADD     HL,HL   ;*4
          E095 19               ADD     HL,DE   ;*5, zus. *40
          E096 ED5BCBB7         LD      DE,(VRAM)
          E09A 5F               LD      E,A
          E09B 19               ADD     HL,DE
          E09C D1               POP     DE
          E09D F1               POP     AF
          E09E A7               AND     A
          E09F C9               RET
          E0A0
          E0A0          WPIX    ;Zeichen auf Grafikbildschirm
          E0A0                  ;sichtbar machen
          E0A0                  ;PE:    DE, A, STBT
          E0A0 E5               PUSH    HL
          E0A1 D5               PUSH    DE
          E0A2 C5               PUSH    BC
          E0A3 F5               PUSH    AF
          E0A4 4F               LD      C,A     ;Zeichen
          E0A5 2A9CB7           LD      HL,(WINON)
          E0A8 19               ADD     HL,DE
          E0A9 EB               EX      DE,HL   ;DE:Absolut-Curs
          E0AA          ;       LD      A,D
          E0AA          ;       CP      20H
          E0AA          ;       JP      NC,WPX13;ausserhalb
          E0AA 7B               LD      A,E
          E0AB FE28             CP      28H
          E0AD D25CE1           JP      NC,WPX13;ausserhalb!
          E0B0 21A2B7           LD      HL,STBT
          E0B3 CB6E             BIT     5,M     ;IBM?
          E0B5 2844             JR      Z,WPX03 ;nein
          E0B7 DD7E04           LD      A,(IX+4);CAOSC merken
          E0BA F5               PUSH    AF
          E0BB CBFF             SET     7,A     ;CAOSC on
          E0BD DD7704           LD      (IX+4),A;fuer IBM-Tab.
          E0C0 D386             OUT     86H
          E0C2 79               LD      A,C
          E0C3 0100DC           LD      BC,0DC00H
          E0C6 87               ADD     A
          E0C7 382C             JR      C,WPX02 ;80..FF
          E0C9 05               DEC     B
          E0CA FE40             CP      40H
          E0CC 3827             JR      C,WPX02 ;00..1F
          E0CE 06ED             LD      B,0EEH-1;Grossbuchst.
          E0D0 FEB6             CP      2*5BH
          E0D2 3821             JR      C,WPX02 ;20..5A
          E0D4 FEBC             CP      2*5EH
          E0D6 380C             JR      C,WPX01 ;5B..5D
          E0D8 FEC0             CP      2*60H
          E0DA 3819             JR      C,WPX02 ;5E..5F
          E0DC 2806             JR      Z,WPX01 ;60
          E0DE 06FC             LD      B,0FEH-2;Kleinbuchst.
          E0E0 FEF6             CP      2*7BH
          E0E2 3811             JR      C,WPX02 ;61..7A
          E0E4 01B8DA   WPX01   LD      BC,0DAB8H;Zusatztabelle
          E0E7 D6B6             SUB     2*5BH
          E0E9 FE06             CP      6
          E0EB 3808             JR      C,WPX02 ;5B..5D
          E0ED D604             SUB     4
          E0EF FE06             CP      6
          E0F1 2802             JR      Z,WPX02 ;60
          E0F3 D634             SUB     34H
          E0F5 6F       WPX02   LD      L,A
          E0F6 2600             LD      H,0
          E0F8 29               ADD     HL,HL   ;*4
          E0F9 1819             JR      WPX07
          E0FB
          E0FB 79       WPX03   LD      A,C
          E0FC 21A6B7           LD      HL,CCTL0
          E0FF 87               ADD     A
          E100 3002             JR      NC,WPX04
          E102 2EAA             LD      L,CCTL2
          E104 D640     WPX04   SUB     40H
          E106 F20DE1           JP      P,WPX06 ;CCTL0/2
          E109 2C               INC     L
          E10A 2C               INC     L       ;CCTL1/3
          E10B EEC0             XOR     0C0H
          E10D 4E       WPX06   LD      C,M
          E10E 2C               INC     L       ;BC=(CCTL)
          E10F 46               LD      B,M
          E110 87               ADD     A       ;*4
          E111 6F               LD      L,A
          E112 2600             LD      H,0
          E114 29       WPX07   ADD     HL,HL   ;*8
          E115 09               ADD     HL,BC   ;HL=Pixelmuster
          E116 7A               LD      A,D
          E117 87               ADD     A
          E118 87               ADD     A
          E119 87               ADD     A
          E11A 53               LD      D,E
          E11B 5F               LD      E,A
          E11C CBFA             SET     7,D     ;DE=IRM-Adresse
          E11E ED4BA2B7         LD      BC,(STBT)
          E122 CB49             BIT     1,C
          E124 2016             JR      NZ,WPIXNC;Farbe AUS
          E126 CD6EF9           CALL    ESC9
          E129 DDCB015E         BIT     3,(IX+1)
          E12D 2004             JR      NZ,WPIXA;LORES
          E12F CB71             BIT     6,C
          E131 202E             JR      NZ,WPIXH1;HRG-Modus
          E133 78       WPIXA   LD      A,B     ;Farbe
          E134 43               LD      B,E
          E135 CDA9E1           CALL    WCOLOR  ;8 Farbbytes
          E138 58               LD      E,B
          E139 CD6EF9   WPIXHE  CALL    ESC9
          E13C CB41     WPIXNC  BIT     0,C
          E13E 2012             JR      NZ,WPX11;Farbe AUS
          E140 DDCB015E         BIT     3,(IX+1)
          E144 2004             JR      NZ,WPIXB;LORES
          E146 CB71             BIT     6,C
          E148 2022             JR      NZ,WPIXH2;HRG-Modus
          E14A CB51     WPIXB   BIT     2,C
          E14C CC88E1           CALL    Z,WPIXEL;normal
          E14F C49BE1           CALL    NZ,WPIXI;invers
          E152 CB69     WPX11   BIT     5,C     ;IBM?
          E154 2806             JR      Z,WPX13 ;nein
          E156 F1               POP     AF
          E157 DD7704           LD      (IX+4),A;CAOSC
          E15A D386             OUT     86H     ;wie vorher
          E15C F1       WPX13   POP     AF
          E15D C1               POP     BC
          E15E D1               POP     DE
          E15F E1               POP     HL
          E160 C9               RET
          E161
          E161          WPIXH1  ;Farbebene im HRG-Modus
          E161 78               LD      A,B
          E162 0F               RRCA
          E163 E5               PUSH    HL
          E164 D5               PUSH    DE
          E165 CD76E1           CALL    WPHRG
          E168 D1               POP     DE
          E169 E1               POP     HL
          E16A 18CD             JR      WPIXHE
          E16C
          E16C          WPIXH2  ;Pixelebene im HRG-Modus
          E16C 78               LD      A,B
          E16D E5               PUSH    HL
          E16E D5               PUSH    DE
          E16F CD76E1           CALL    WPHRG
          E172 D1               POP     DE
          E173 E1               POP     HL
          E174 18DC             JR      WPX11
          E176
          E176                  ;Reaktion im HRG-Modus
          E176 E609     WPHRG   AND     9       ;Bits 0&3
          E178 282F             JR      Z,WCOLOR;Ebene ruecks.
          E17A FE09             CP      9
          E17C 2829             JR      Z,COLFF ;Ebene setzen
          E17E CB51             BIT     2,C
          E180 2803             JR      Z,WPHN
          E182 2F               CPL             ;invers
          E183 E609             AND     9
          E185 3D       WPHN    DEC     A
          E186 2813             JR      Z,WPIXI ;Pixel invers
          E188          WPIXEL  ;8 Pixelbytes kopieren
          E188 C5               PUSH    BC
          E189 EDA0             LDI
          E18B EDA0             LDI
          E18D EDA0             LDI
          E18F EDA0             LDI
          E191 EDA0             LDI
          E193 EDA0             LDI
          E195 EDA0             LDI
          E197 EDA0             LDI
          E199 C1               POP     BC
          E19A C9               RET
          E19B
          E19B C5       WPIXI   PUSH    BC
          E19C 0608             LD      B,8     ;8 Pixelmuster
          E19E 7E       WPIXI1  LD      A,M     ;invers
          E19F 2F               CPL
          E1A0 12               LD      (DE),A
          E1A1 23               INC     HL
          E1A2 1C               INC     E
          E1A3 10F9             DJNZ    WPIXI1
          E1A5 C1               POP     BC
          E1A6 C9               RET
          E1A7
          E1A7 3EFF     COLFF   LD      A,0FFH
          E1A9 12       WCOLOR  LD      (DE),A  ;8 Farbbytes
          E1AA 1C               INC     E
          E1AB 12               LD      (DE),A
          E1AC 1C               INC     E
          E1AD 12               LD      (DE),A
          E1AE 1C               INC     E
          E1AF 12               LD      (DE),A
          E1B0 1C               INC     E
          E1B1 12               LD      (DE),A
          E1B2 1C               INC     E
          E1B3 12               LD      (DE),A
          E1B4 1C               INC     E
          E1B5 12               LD      (DE),A
          E1B6 1C               INC     E
          E1B7 12               LD      (DE),A
          E1B8 C9               RET
          E1B9
          E1B9          MOVELN  ;Rolle Fenster fuer Scrolling
          E1B9 E5               PUSH    HL
          E1BA D5               PUSH    DE
          E1BB C5               PUSH    BC
          E1BC F5               PUSH    AF
          E1BD 08               EX      AF,AF'
          E1BE F5               PUSH    AF
          E1BF 79               LD      A,C     ;BC:Pixelzeilen
          E1C0 08               EX      AF,AF'
          E1C1 3A9EB7           LD      A,(WINLG) ;Spalten
          E1C4 E5       MOLN1   PUSH    HL
          E1C5 D5               PUSH    DE
          E1C6 EDA0     MOLN2   LDI             ;zeichenweise
          E1C8 EDA0             LDI
          E1CA EDA0             LDI
          E1CC EDA0             LDI
          E1CE EDA0             LDI
          E1D0 EDA0             LDI
          E1D2 EDA0             LDI
          E1D4 EDA0             LDI
          E1D6 EAC6E1           JP      PE,MOLN2
          E1D9 D1               POP     DE
          E1DA E1               POP     HL
          E1DB 24               INC     H       ;neue Spalte
          E1DC 14               INC     D
          E1DD 08               EX      AF,AF'
          E1DE 4F               LD      C,A
          E1DF 08               EX      AF,AF'
          E1E0 3D               DEC     A       ;Spaltenzaehler
          E1E1 20E1             JR      NZ,MOLN1
          E1E3 08               EX      AF,AF'
          E1E4 F1               POP     AF
          E1E5 08               EX      AF,AF'
          E1E6 F1               POP     AF
          E1E7 C1               POP     BC
          E1E8 D1               POP     DE
          E1E9 E1               POP     HL
          E1EA C9               RET
          E1EB
          E1EB          PCHR    ;CRT-Grundprogramm
          E1EB ED5BA0B7         LD      DE,(CURSO)
          E1EF 21A2B7           LD      HL,STBT
          E1F2 CB66             BIT     4,M     ;ESC aktiv?
          E1F4 2822             JR      Z,PCHR3
          E1F6 CBA6     CRT1    RES     4,M
          E1F8 FE30             CP      '0'
          E1FA D8               RET     C
          E1FB FE3A             CP      '9'+1
          E1FD 3004             JR      NC,PCHR1
          E1FF D630             SUB     '0'
          E201 180A             JR      PCHR2
          E203                  ;
          E203 FE41     PCHR1   CP      'A'
          E205 D8               RET     C
          E206 CBAF             RES     5,A
          E208 FE5B             CP      'Z'+1
          E20A D0               RET     NC
          E20B D637             SUB     'A'-10
          E20D 21DFB7   PCHR2   LD      HL,L3SIZ;Tabelle
          E210 BE               CP      M       ;lang genug?
          E211 D0               RET     NC
          E212 87               ADD     A       ;*2
          E213 2ADDB7           LD      HL,(L3TAB) ;klar zum
          E216 180C             JR      PCHR4   ;Ansprung
          E218                  ;
          E218 FE20     PCHR3   CP      20H     ;Steuerfunktion?
          E21A 3018             JR      NC,PCHR5
          E21C CB5E             BIT     3,M     ;darstellen?
          E21E 2014             JR      NZ,PCHR5
          E220 87               ADD     A       ;*2
          E221 2AB2B7           LD      HL,(CTAB)
          E224 4F       PCHR4   LD      C,A
          E225 0600             LD      B,0
          E227 09               ADD     HL,BC
          E228 7E               LD      A,M
          E229 23               INC     HL
          E22A 66               LD      H,M
          E22B 6F               LD      L,A
          E22C E9       JPHL    JP      (HL)    ;anspringen
          E22D
          E22D 7B       ESC0    LD      A,E     ;Tabulator
          E22E F607             OR      7       ;8er Step
          E230 3C               INC     A
          E231 5F               LD      E,A
          E232 1809             JR      CUR1
          E234                  ;
          E234 CD7CE0   PCHR5   CALL    DABR
          E237 D8               RET     C       ;auîerhalb
          E238 77               LD      M,A     ;ASCII eintragen
          E239 CDA0E0           CALL    WPIX    ;darstellen
          E23C 1C       CUR     INC     E
          E23D 3A9EB7   CUR1    LD      A,(WINLG)
          E240 3D               DEC     A
          E241 BB               CP      E
          E242 D0               RET     NC
          E243 1E00     NL      LD      E,0     ;NL fuer 1E
          E245 14       CUD     INC     D
          E246 3A9FB7           LD      A,(WINLG+1)
          E249 BA               CP      D
          E24A C0               RET     NZ
          E24B 2AA4B7           LD      HL,(WEND)
          E24E E9               JP      (HL)    ;PAGE o. SCROLL
          E24F
          E24F 2A99B7   HCOPY   LD      HL,(HCADR) ;ShCLR
          E252 E9               JP      (HL)
          E253
          E253 7B       CUL     LD      A,E
          E254 A7               AND     A
          E255 2802             JR      Z,CUL1
          E257 1D               DEC     E
          E258 C9               RET
          E259
          E259 7A       CUL1    LD      A,D
          E25A A7               AND     A
          E25B C8               RET     Z
          E25C 15               DEC     D
          E25D 3A9EB7   CEL     LD      A,(WINLG)
          E260 3D               DEC     A
          E261 5F               LD      E,A
          E262 C9               RET
          E263
          E263 7A       CUU     LD      A,D
          E264 A7               AND     A
          E265 C8               RET     Z
          E266 15               DEC     D
          E267 C9               RET
          E268
          E268 21D7E2   PAGE    LD      HL,HOMEPG ;ShCUU
          E26B 22A4B7   WADR    LD      (WEND),HL
          E26E C9               RET
          E26F
          E26F 21F2E2   SCROL   LD      HL,SCRLPG ;ShCUD
          E272 18F7             JR      WADR
          E274
          E274 CD53E2   CLR     CALL    CUL
          E277 D5       DEL     PUSH    DE      ;Cursor retten
          E278 CD7CE0           CALL    DABR
          E27B 7E               LD      A,M
          E27C A7               AND     A       ;Ende?
          E27D 2829             JR      Z,POPDE
          E27F E5               PUSH    HL      ;VRAM
          E280 D5       DEL1    PUSH    DE      ;Cursor
          E281 1C               INC     E       ;naechste Spalte
          E282 CD7CE0           CALL    DABR    ;raus?
          E285 3008             JR      NC,DEL2
          E287 1E00             LD      E,0     ;ja, wie NL
          E289 14               INC     D
          E28A CD7CE0           CALL    DABR    ;raus?
          E28D 3810             JR      C,DEL3  ;ja-wie Ende
          E28F 7E       DEL2    LD      A,M
          E290 A7               AND     A       ;Ende?
          E291 280C             JR      Z,DEL3
          E293 42               LD      B,D
          E294 4B               LD      C,E     ;BC:=DE
          E295 D1               POP     DE      ;DE=links davon
          E296 E3               EX      (SP),HL ;HL=VRAM links
          E297 77               LD      M,A     ;eintragen
          E298 CDA0E0           CALL    WPIX    ;zeichnen
          E29B 50               LD      D,B
          E29C 59               LD      E,C     ;DE:=BC
          E29D 18E1             JR      DEL1    ;von vorn
          E29F
          E29F D1       DEL3    POP     DE
          E2A0 E1               POP     HL
          E2A1 3600             LD      M,0
          E2A3 3E20             LD      A,' '
          E2A5 CDA0E0           CALL    WPIX
          E2A8 D1       POPDE   POP     DE
          E2A9 C9               RET
          E2AA
          E2AA D5       INS     PUSH    DE      ;Cursor
          E2AB 3E20             LD      A,' '
          E2AD CD7CE0           CALL    DABR
          E2B0 46       INS1    LD      B,M     ;VRAM
          E2B1 77               LD      M,A     ;neues Zeichen
          E2B2 CDA0E0           CALL    WPIX    ;zeichnen
          E2B5 78               LD      A,B
          E2B6 A7               AND     A       ;Dummy?
          E2B7 280E             JR      Z,INS2
          E2B9 1C               INC     E       ;CUR
          E2BA CD7CE0           CALL    DABR    ;raus?
          E2BD 30F1             JR      NC,INS1
          E2BF 1E00             LD      E,0     ;wie NL
          E2C1 14               INC     D
          E2C2 CD7CE0           CALL    DABR    ;raus?
          E2C5 30E9             JR      NC,INS1
          E2C7 D1       INS2    POP     DE      ;wenn ja Schluî
          E2C8 C9               RET
          E2C9
          E2C9 3A9FB7   CLS     LD      A,(WINLG+1) ;ShHOME
          E2CC 1600             LD      D,0
          E2CE F5       CLS1    PUSH    AF
          E2CF CD3CE3           CALL    CLLN
          E2D2 F1               POP     AF
          E2D3 14               INC     D
          E2D4 3D               DEC     A
          E2D5 20F7             JR      NZ,CLS1 ;A Zeilen
          E2D7 1600     HOMEPG  LD      D,0
          E2D9 1E00     CBL     LD      E,0
          E2DB C9               RET
          E2DC
          E2DC          CLLINE  ;Loeschen einer Zeile
          E2DC                  ;HL: Adr. C: Laenge, A: Byte
          E2DC 41               LD      B,C
          E2DD 55       CLL1    LD      D,L     ;L retten
          E2DE 77               LD      M,A     ;zeichenweise
          E2DF 2C               INC     L       ;ohne Schleife
          E2E0 77               LD      M,A
          E2E1 2C               INC     L
          E2E2 77               LD      M,A
          E2E3 2C               INC     L
          E2E4 77               LD      M,A
          E2E5 2C               INC     L
          E2E6 77               LD      M,A
          E2E7 2C               INC     L
          E2E8 77               LD      M,A
          E2E9 2C               INC     L
          E2EA 77               LD      M,A
          E2EB 2C               INC     L
          E2EC 77               LD      M,A
          E2ED 6A               LD      L,D     ;L holen
          E2EE 24               INC     H
          E2EF 10EC             DJNZ    CLL1
          E2F1 C9               RET
          E2F2
          E2F2 3A9EB7   SCRLPG  LD      A,(WINLG) ;Spalten
          E2F5 4F               LD      C,A
          E2F6 0600             LD      B,0
          E2F8 3A9FB7           LD      A,(WINLG+1) ;Zeilen
          E2FB 3D               DEC     A       ;nur 1 Zeile?
          E2FC 283D             JR      Z,SCRL3 ;nur CLLN
          E2FE D5               PUSH    DE
          E2FF F5               PUSH    AF
          E300 110000           LD      DE,0    ;Cursor li/oben
          E303 CD7CE0           CALL    DABR
          E306 EB               EX      DE,HL
          E307 212800   SCRL1   LD      HL,40   ;1 Zeile tiefer
          E30A 19               ADD     HL,DE
          E30B E5               PUSH    HL
          E30C C5               PUSH    BC
          E30D EDB0             LDIR            ;im VRAM eine
          E30F C1               POP     BC      ;Zeile rollen
          E310 D1               POP     DE
          E311 3D               DEC     A
          E312 20F3             JR      NZ,SCRL1;A*
          E314 F1               POP     AF
          E315 87               ADD     A
          E316 87               ADD     A
          E317 87               ADD     A       ;*8: Pixelzeile
          E318 4F               LD      C,A
          E319 110000           LD      DE,0
          E31C 42               LD      B,D
          E31D CD56E0           CALL    PADR1
          E320 EB               EX      DE,HL   ;DE=PixAdr.
          E321 2E08             LD      L,8     ;H war 0
          E323 19               ADD     HL,DE
          E324 3AA2B7           LD      A,(STBT)
          E327 1F               RRA
          E328 1F               RRA
          E329 380B             JR      C,SCRL2 ;Farbe AUS
          E32B F5               PUSH    AF
          E32C CD6EF9           CALL    ESC9
          E32F CDB9E1           CALL    MOVELN
          E332 CD6EF9           CALL    ESC9
          E335 F1               POP     AF
          E336 17       SCRL2   RLA             ;Pixel AUS?
          E337 D4B9E1           CALL    NC,MOVELN
          E33A D1               POP     DE
          E33B 15       SCRL3   DEC     D
          E33C                  ;
          E33C 1E00     CLLN    LD      E,0     ;ShDEL
          E33E CD7CE0           CALL    DABR    ;auîerhalb?
          E341 D8               RET     C       ;(Selbstschutz)
          E342 3A9EB7           LD      A,(WINLG)
          E345 47               LD      B,A     ;Spalten
          E346 4F               LD      C,A
          E347 AF               XOR     A
          E348 77       CLLN1   LD      M,A     ;VRAM loeschen
          E349 23               INC     HL
          E34A 10FC             DJNZ    CLLN1
          E34C CD56E0           CALL    PADR1
          E34F D8               RET     C
          E350 D5               PUSH    DE
          E351 DDCB015E         BIT     3,(IX+1)
          E355 3AA2B7           LD      A,(STBT)
          E358 2004             JR      NZ,CLLALT;LORES
          E35A CB77             BIT     6,A
          E35C 201C             JR      NZ,CLLHR;HRG-Modus
          E35E 0F       CLLALT  RRCA            ;Pixel AUS?
          E35F 5F               LD      E,A     ;nach E merken
          E360 3806             JR      C,CLLN2
          E362 AF               XOR     A
          E363 E5               PUSH    HL
          E364 CDDCE2           CALL    CLLINE  ;Pixel loeschen
          E367 E1               POP     HL
          E368 CB0B     CLLN2   RRC     E       ;Farbe AUS?
          E36A 380C             JR      C,CLLN3
          E36C CD6EF9           CALL    ESC9
          E36F 3AA3B7           LD      A,(COLOR)
          E372 CDDCE2           CALL    CLLINE  ;Farbe setzen
          E375 CD6EF9           CALL    ESC9
          E378 D1       CLLN3   POP     DE
          E379 C9               RET
          E37A                  ;
          E37A 3AA3B7   CLLHR   LD      A,(COLOR)
          E37D E603             AND     3       ;Paper
          E37F 110000           LD      DE,0    ;schwarz
          E382 B7               OR      A
          E383 2809             JR      Z,CLLH2
          E385 15               DEC     D       ;rot
          E386 3D               DEC     A
          E387 2805             JR      Z,CLLH2
          E389 1D               DEC     E       ;weiî
          E38A 3D               DEC     A
          E38B 2001             JR      NZ,CLLH2
          E38D 14               INC     D       ;tuerkis
          E38E 7A       CLLH2   LD      A,D     ;Pixel
          E38F 0602             LD      B,2
          E391 1804             JR      CLLH4
          E393 CD6EF9   CLLH3   CALL    ESC9
          E396 7B               LD      A,E     ;Color
          E397 E5       CLLH4   PUSH    HL
          E398 C5               PUSH    BC
          E399 CDDCE2           CALL    CLLINE
          E39C C1               POP     BC
          E39D E1               POP     HL
          E39E 10F3             DJNZ    CLLH3
          E3A0 CD6EF9           CALL    ESC9
          E3A3 D1               POP     DE
          E3A4 C9               RET
          E3A5
          E3A5 010F0A   BEEP    LD      BC,0A0FH
          E3A8 213000           LD      HL,48
          E3AB D5               PUSH    DE
          E3AC 5C               LD      E,H     ;E=0
          E3AD CDFEF8           CALL    TON2
          E3B0 3E1E             LD      A,1EH
          E3B2 CD86F3           CALL    WAIT
          E3B5 3E03             LD      A,3
          E3B7 D38C             OUT     8CH
          E3B9 3E10             LD      A,10H
          E3BB D1               POP     DE
          E3BC C386F3           JP      WAIT
          E3BF
          E3BF 010703   CLIK    LD      BC,0307H
          E3C2 212400           LD      HL,36
          E3C5 D5               PUSH    DE
          E3C6 5C               LD      E,H     ;E=0
          E3C7 CDFEF8           CALL    TON2
          E3CA D1               POP     DE
          E3CB C9               RET
          E3CC
          E3CC 21A3B7   ESC8    LD      HL,COLOR;Farbtausch
          E3CF 7E               LD      A,M
          E3D0 F5               PUSH    AF
          E3D1 E6C0             AND     0C0H
          E3D3 4F               LD      C,A     ;Bit 6,7
          E3D4 F1               POP     AF
          E3D5 F5               PUSH    AF
          E3D6 E607             AND     7       ;hFarbe
          E3D8 07               RLCA
          E3D9 07               RLCA
          E3DA 07               RLCA
          E3DB B1               OR      C
          E3DC 4F               LD      C,A
          E3DD F1               POP     AF
          E3DE 0F               RRCA
          E3DF 0F               RRCA
          E3E0 0F               RRCA
          E3E1 E607             AND     7       ;vFarbe
          E3E3 B1               OR      C
          E3E4 77       LDMA    LD      M,A             ;**28**
          E3E5 C9               RET
          E3E6
          E3E6 7E       LDAM    LD      A,M             ;**29**
          E3E7 C9               RET
          E3E8
          E3E8 DD7E08   CLICK   LD      A,(IX+8);ShINS
          E3EB EE20             XOR     20H
          E3ED DD7708           LD      (IX+8),A
          E3F0 C9       NOT     RET
          E3F1
          E3F1 21A2B7   ESCPRG  LD      HL,STBT ;ShSTOP
          E3F4 CBE6             SET     4,M
          E3F6 C9               RET
          E3F7
          E3F7 E5       CRT     PUSH    HL              ;**00**
          E3F8 D5               PUSH    DE
          E3F9 C5               PUSH    BC
          E3FA F5               PUSH    AF
          E3FB CDEBE1           CALL    PCHR
          E3FE ED53A0B7         LD      (CURSO),DE
          E402 F1               POP     AF
          E403 C1               POP     BC
          E404 D1               POP     DE
          E405 E1               POP     HL
          E406 C9               RET
          E407
          E407          ;KBD-Treiber
          E407
          E407          ISRC3   ;ISR CTC Kanal 3 (Tastatur)
          E407 FB               EI
          E408 F5               PUSH    AF
          E409 3E23             LD      A,23H     ;DI,ZG256,Res
          E40B D38F             OUT     8FH       ;CTC K3
          E40D DD360D00         LD      (IX+13),0 ;Zeichen tot
          E411 1864             JR      TST5      ;freigeben
          E413
          E413          ISRPB   ;ISR PIO Kanal B (Tastatur)
          E413 F5               PUSH    AF
          E414 DB8F             IN      A,8FH   ;gemessene Zeit
          E416 F5               PUSH    AF
          E417 3EA7             LD      A,0A7H  ;EI,ZG256,Res
          E419 D38F             OUT     8FH,A
          E41B 3E8F             LD      A,8FH   ;Zeitkonstante
          E41D D38F             OUT     8FH
          E41F F1               POP     AF
          E420 FB               EI
          E421 FE14             CP      20
          E423 3852             JR      C,TST5  ;zu lang
          E425 FE78             CP      120
          E427 304E             JR      NC,TST5 ;zu kurz
          E429 FE65             CP      101     ;Diskriminator
          E42B 3004             JR      NC,TST1
          E42D C6BE             ADD     190
          E42F 3006             JR      NC,TST2 ;Stop-Bit
          E431 DDCB0C1E TST1    RR      (IX+12) ;Bit einschieben
          E435 1840             JR      TST5
          E437 E5       TST2    PUSH    HL
          E438 D5               PUSH    DE
          E439 DD7E0C           LD      A,(IX+12)
          E43C 1F               RRA             ;7bit-Scancode
          E43D EE01             XOR     1       ;Startbit neg.
          E43F DD6E0E           LD      L,(IX+14)
          E442 DD660F           LD      H,(IX+15)
          E445 1600             LD      D,0
          E447 5F               LD      E,A
          E448 19               ADD     HL,DE   ;Pos. in KTAB
          E449 7E               LD      A,M     ;ASCII holen
          E44A DDCB087E         BIT     7,(IX+8);CAPS aktiv?
          E44E 200A             JR      NZ,TST3 ;1=nein
          E450 FE40             CP      40H
          E452 3806             JR      C,TST3
          E454 FE80             CP      80H
          E456 3002             JR      NC,TST3
          E458 EE20             XOR     20H     ;klein<=>groî
          E45A 57       TST3    LD      D,A     ;Code merken
          E45B DDBE0D           CP      (IX+13) ;= letzter Code?
          E45E 201E             JR      NZ,TST6 ;nein
          E460 DB88             IN      A,88H
          E462 5F               LD      E,A
          E463 CBD7             SET     2,A     ;IRM on
          E465 D388             OUT     88H
          E467 3AE0B7           LD      A,(COUNT)
          E46A DDBE0A           CP      (IX+10) ;FastRepeat?
          E46D 7B               LD      A,E
          E46E D388             OUT     88H
          E470 381C             JR      C,TST7
          E472 DD340A           INC     (IX+10) ;Zeit abwarten
          E475 D1       TST4    POP     DE
          E476 E1               POP     HL
          E477 DB89     TST5    IN      A,89H   ;PIO-Logik
          E479 D389             OUT     89H     ;freigeben
          E47B F1               POP     AF
          E47C ED4D             RETI
          E47E
          E47E DD360A00 TST6    LD      (IX+10),0 ;neuer Code
          E482 FE16             CP      16H       ;CAPS?
          E484 2009             JR      NZ,TST8
          E486 DD7E08           LD      A,(IX+8)
          E489 EE80             XOR     80H       ;CAPS on/off
          E48B DD7708           LD      (IX+8),A
          E48E 7A       TST7    LD      A,D       ;Code
          E48F DD770D   TST8    LD      (IX+13),A ;eintragen
          E492 DDCB08C6         SET     0,(IX+8)  ;gueltig machen
          E496 18DD             JR      TST4
          E498
          E498          KBDS    ;Abfrage ohne Quittung   **0C**
          E498 B7               OR      A
          E499 DDCB0846         BIT     0,(IX+8);Code gueltig?
          E49D C8               RET     Z
          E49E DD7E0D           LD      A,(IX+13)
          E4A1 37               SCF             ;wenn ja
          E4A2 C9               RET
          E4A3
          E4A3          KBDZ    ;Abfrage mit Quittung    **0E**
          E4A3 CD98E4           CALL    KBDS
          E4A6 D0               RET     NC
          E4A7 DDCB0886         RES     0,(IX+8)
          E4AB C9               RET
          E4AC
          E4AC          BRKT    ;Test auf BRK-Anforderung**2A**
          E4AC CD98E4           CALL    KBDS
          E4AF D0               RET     NC
          E4B0 FE03             CP      3
          E4B2 37               SCF
          E4B3 C8               RET     Z
          E4B4 A7               AND     A
          E4B5 C9               RET
          E4B6
          E4B6          ;TAPE-Treiber
          E4B6
          E4B6 F3       ISRI1   DI
          E4B7 DB88             IN      A,88H
          E4B9 F640             OR      40H     ;Motor ein
          E4BB E6DF             AND     0DFH    ;LED aus
          E4BD D388     ISRO1   OUT     88H
          E4BF FB               EI
          E4C0 2AA4B7           LD      HL,(WEND)
          E4C3 22CFB7           LD      (ZWEND),HL
          E4C6 CDA9F3           CALL    NOUT    ;kein Drucker!
          E4C9 22CDB7           LD      (ZOTAB),HL
          E4CC CD68E2           CALL    PAGE    ;Page Mode
          E4CF 3E03     TOFF    LD      A,3     ;Ton aus
          E4D1 D38C             OUT     8CH     ;CTC0
          E4D3 D38D             OUT     8DH     ;CTC1
          E4D5 DDCB088E         RES     1,(IX+8)
          E4D9 1823             JR      CSRO2
          E4DB
          E4DB          CSRO    ;Abschluî Bandausgabe    **09**
          E4DB DD3602FE         LD      (IX+2),0FEH
          E4DF CD37E5           CALL    MBO
          E4E2 2ACDB7   CSROI   LD      HL,(ZOTAB) ;intern
          E4E5 22B9B7           LD      (OUTAB),HL
          E4E8 2ACFB7           LD      HL,(ZWEND) ;groîes
          E4EB 22A4B7           LD      (WEND),HL  ;Ruecksetzen
          E4EE CD1FE5           CALL    CLC     ;KassPuff loe.
          E4F1 DB88             IN      A,88H
          E4F3 E69F             AND     9FH     ;Motor,LED aus
          E4F5 D388             OUT     88H
          E4F7 CDC9F4           CALL    CRLF
          E4FA DDCB0886         RES     0,(IX+8)
          E4FE DDCB015E CSRO2   BIT     3,(IX+1);HiRes?
          E502 2806             JR      Z,CSRO3
          E504 DB89             IN      A,89H   ;nein-
          E506 CBFF             SET     7,A     ;Blinken ein
          E508 D389             OUT     89H
          E50A DDCB084E CSRO3   BIT     1,(IX+8);neuer Ton?
          E50E 20FA             JR      NZ,CSRO3;Ende abwarten
          E510 3ADBB7           LD      A,(CTCMD);CTC2 auf
          E513 E660             AND     60H
          E515 F607             OR      7
          E517 D38E             OUT     8EH     ;Blinken
          E519 3ADCB7           LD      A,(BLINK);ZK laden
          E51C D38E             OUT     8EH
          E51E C9               RET
          E51F
          E51F 2180B7   CLC     LD      HL,CASS+80H
          E522 AF               XOR     A
          E523 2D       CLC1    DEC     L
          E524 77               LD      M,A
          E525 20FC             JR      NZ,CLC1
          E527 C9               RET
          E528
          E528          ISRO    ;Init. Bandausgabe       **08**
          E528 F3               DI
          E529 DB88             IN      A,88H
          E52B F660             OR      60H     ;Motor,LED ein
          E52D CDBDE4           CALL    ISRO1
          E530 DD360200         LD      (IX+2),0
          E534 010010           LD      BC,1000H
          E537                  ;
          E537          MBO     ;Ausgabe 1 Block         **01**
          E537 DD3402           INC     (IX+2)
          E53A F3               DI
          E53B 3E87             LD      A,87H   ;EI,ZG16,Res
          E53D D38D             OUT     8DH
          E53F 3E2F             LD      A,2FH   ;Vorton
          E541 D38D             OUT     8DH
          E543 FB               EI
          E544 57               LD      D,A     ;D=2Fh
          E545 5F               LD      E,A     ;E=2Fh
          E546 CD8CE5   MBO1    CALL    BITOUT
          E549 EDA1             CPI
          E54B EA46E5           JP      PE,MBO1 ;BC mal
          E54E CD8AE5           CALL    ZTON    ;Trennzeichen
          E551 DD7E02           LD      A,(IX+2)
          E554 CD77E5           CALL    BYTOT   ;Blocknummer
          E557 DD6E05           LD      L,(IX+5)
          E55A DD6606           LD      H,(IX+6)
          E55D 0680             LD      B,80H
          E55F 7E       BLKOT   LD      A,M
          E560 CD77E5           CALL    BYTOT   ;Datenbyte
          E563 79               LD      A,C
          E564 86               ADD     M       ;Pruefsumme
          E565 4F               LD      C,A     ;nebenher
          E566 23               INC     HL
          E567 10F6             DJNZ    BLKOT
          E569 CD77E5           CALL    BYTOT   ;und ausgeben
          E56C 7A               LD      A,D
          E56D CD8FE5           CALL    HBITOT  ;noch ein
          E570 5D               LD      E,L     ;Knacks
          E571 54               LD      D,H
          E572 3E03             LD      A,3     ;CTC stoppen
          E574 D38D             OUT     8DH
          E576 C9               RET
          E577
          E577          BYTOT   ;Ausgabe eines Bytes
          E577 C5               PUSH    BC
          E578 4F               LD      C,A
          E579 0608             LD      B,8
          E57B CB09     BYTOUT  RRC     C       ;mit Bit0
          E57D 1E17             LD      E,17H   ;beginnend
          E57F D48CE5           CALL    NC,BITOUT
          E582 1E2F             LD      E,2FH   ;Zeitkonstanten
          E584 DC8CE5           CALL    C,BITOUT
          E587 10F2             DJNZ    BYTOUT  ;8*
          E589 C1               POP     BC
          E58A 1E5D     ZTON    LD      E,5DH   ;ZK Trennz.
          E58C CD8FE5   BITOUT  CALL    HBITOT  ;Aufrufen und
          E58F DD7200   HBITOT  LD      (IX),D  ;reinlaufen
          E592 DD7E00   HBIT1   LD      A,(IX)  ;Warten auf
          E595 A7               AND     A       ;Interrupt
          E596 20FA             JR      NZ,HBIT1
          E598 53               LD      D,E
          E599 C9               RET
          E59A
          E59A          ISRI    ;Init. Bandeingabe       **0A**
          E59A CDB6E4           CALL    ISRI1
          E59D                  ;
          E59D          MBI     ;Einlesen 1 Block        **05**
          E59D 3E83             LD      A,83H   ;EI
          E59F D38A             OUT     8AH     ;an PIO A
          E5A1 E5               PUSH    HL
          E5A2 D5               PUSH    DE
          E5A3 0616     MBI1    LD      B,16H
          E5A5 DD360D00         LD      (IX+13),0 ;Pruefsumme=0
          E5A9 CD26E6   MBI2    CALL    STOP1
          E5AC 38F5             JR      C,MBI1
          E5AE FEBA             CP      0BAH
          E5B0 CDF9E5           CALL    LEDOO
          E5B3 38EE             JR      C,MBI1  ;16h korrekte
          E5B5 10F2             DJNZ    MBI2    ;Schwingungen
          E5B7 0602     MBI3    LD      B,2     ;erkennen
          E5B9 AF       MBI4    XOR     A
          E5BA 4F               LD      C,A
          E5BB DD7700           LD      (IX),A
          E5BE CD39E6           CALL    STOP21  ;2 halbe Trenn-
          E5C1 FE5D             CP      5DH     ;zeichen er-
          E5C3 30F2             JR      NC,MBI3 ;kennen
          E5C5 10F2             DJNZ    MBI4
          E5C7 CD45E6           CALL    BYTIN   ;Blocknummer
          E5CA 3825             JR      C,MBI5  ;Stoerung
          E5CC DD7702           LD      (IX+2),A
          E5CF 0680             LD      B,80H
          E5D1 DD6E05           LD      L,(IX+5)
          E5D4 DD6606           LD      H,(IX+6)
          E5D7 CD45E6   BLKIN   CALL    BYTIN   ;Datenbyte
          E5DA 3815             JR      C,MBI5  ;Stoerung
          E5DC 77               LD      M,A
          E5DD DD7E0D           LD      A,(IX+13)
          E5E0 86               ADD     M       ;aufsummieren
          E5E1 DD770D           LD      (IX+13),A
          E5E4 23               INC     HL
          E5E5 10F0             DJNZ    BLKIN
          E5E7 CD45E6           CALL    BYTIN   ;Pruefsumme
          E5EA 3805             JR      C,MBI5  ;Stoerung
          E5EC DD960D           SUB     (IX+13) ;gleich?
          E5EF C6FF             ADD     0FFH    ;CY:=/Z
          E5F1 D1       MBI5    POP     DE
          E5F2 E1               POP     HL
          E5F3 F3               DI
          E5F4 3E03             LD      A,3     ;DI an PIO A
          E5F6 D38A             OUT     8AH
          E5F8 FB               EI
          E5F9 DB88     LEDOO   IN      A,88H   ;LED ein/aus
          E5FB CBEF             SET     5,A     ;je nach CY
          E5FD 3002             JR      NC,MBI6
          E5FF CBAF             RES     5,A
          E601 D388     MBI6    OUT     88H
          E603 C9               RET
          E604
          E604          ISRC1   ;ISR CTC Kanal 1 (Kassette-Out)
          E604 F5               PUSH    AF
          E605 3E87             LD      A,87H
          E607 D38D             OUT     8DH
          E609 DD7E00           LD      A,(IX)  ;Uebergabezelle
          E60C D38D             OUT     8DH
          E60E DD360000         LD      (IX),0  ;Quittierung
          E612 180E             JR      ISR1E
          E614
          E614          ISRPA   ;ISR PIO Kanal A (Kassette-In)
          E614 F5               PUSH    AF
          E615 DB8E             IN      A,8EH
          E617 DD7700           LD      (IX),A  ;Uebergabezelle
          E61A 3E07             LD      A,7
          E61C D38E             OUT     8EH
          E61E 3EA3             LD      A,0A3H
          E620 D38E             OUT     8EH
          E622 F1       ISR1E   POP     AF
          E623 FB       INTEND  EI
          E624 ED4D             RETI
          E626
          E626 DD360000 STOP1   LD      (IX),0  ;1 Bit einlesen
          E62A DB88     STOP11  IN      A,88H   ;PIO-Logik
          E62C D388             OUT     88H     ;freigeben
          E62E DD7E00           LD      A,(IX)  ;Warten auf
          E631 B7               OR      A       ;Interrupt
          E632 28F6             JR      Z,STOP11
          E634 4F               LD      C,A
          E635 DD360000         LD      (IX),0
          E639 DB88     STOP21  IN      A,88H   ;dto.
          E63B D388             OUT     88H,A
          E63D DD7E00           LD      A,(IX)
          E640 B7               OR      A
          E641 28F6             JR      Z,STOP21
          E643 81               ADD     C       ;beide 'Zeiten'
          E644 C9               RET             ;addieren
          E645
          E645          BYTIN   ;Einlesen eines Bytes
          E645                  ;PA: A:Byte, CY=1: Stoerung
          E645 110008           LD      DE,800H
          E648 CD26E6   TRN1    CALL    STOP1
          E64B 3803             JR      C,TRN2
          E64D FEBA             CP      0BAH    ;zu intolerant
          E64F D8               RET     C
          E650 3F       TRN2    CCF
          E651 CB1B             RR      E       ;Bit einschieben
          E653 15               DEC     D
          E654 20F2             JR      NZ,TRN1 ;8*
          E656 CD26E6           CALL    STOP1   ;Trennzeichen
          E659 7B               LD      A,E     ;mit CY-
          E65A C9               RET             ;Rueckmeldung
          E65B
          E65B          ;BASIC:
          E65B
          E65B          BEXP1   ;BASIC-Exp 1
          E65B 78               LD      A,B
          E65C D609             SUB     9
          E65E 384F             JR      C,SNERR1
          E660 FE1B             CP      27
          E662 304B             JR      NC,SNERR1       ;>26
          E664 07               RLCA            ;*2
          E665 4F               LD      C,A
          E666 0600             LD      B,0
          E668 EB               EX      DE,HL
          E669 21C1FD           LD      HL,TOKJP+8
          E66C C3B7C8           JP      0C8B7H  ;Ruecksprung
          E66F
          E66F          BEXP2   ;BASIC-Exp 2
          E66F 7E               LD      A,M
          E670 FEDF             CP      0DFH
          E672 D8               RET     C               ;<DFH
          E673 FEE3             CP      0E3H
          E675 D0               RET     NC              ;>E2H
          E676 FEE1             CP      0E1H    ;AT?
          E678 CAA3EA           JP      Z,PRAT
          E67B 3AFD03           LD      A,(3FDH)
          E67E A7               AND     A       ;PRINT-Erw.?
          E67F 202E             JR      NZ,SNERR1
          E681 3C               INC     A
          E682 32FD03           LD      (3FDH),A
          E685 E5       PREX1   PUSH    HL
          E686 21A3B7           LD      HL,COLOR
          E689 CDA1EC           CALL    IRMRD
          E68C E1               POP     HL
          E68D 327E03           LD      (37EH),A ;Farbe merken
          E690 7E               LD      A,M
          E691 FEDF             CP      0DFH    ;INK?
          E693 281D             JR      Z,PRINK
          E695 FEE2             CP      0E2H    ;COLOR?
          E697 CAA7E6           JP      Z,PRCOL
          E69A CDBDC8           CALL    0C8BDH
          E69D CD20EB           CALL    PAPER
          E6A0 7E       PREX2   LD      A,M
          E6A1 FE3B             CP      ';'
          E6A3 283D             JR      Z,PREX5
          E6A5 1808             JR      SNERR1
          E6A7
          E6A7 CDBDC8   PRCOL   CALL    0C8BDH
          E6AA CD3CEB           CALL    BCOLOR
          E6AD 18F1             JR      PREX2
          E6AF
          E6AF C348C3   SNERR1  JP      0C348H  ;SN-ERROR
          E6B2
          E6B2 CDBDC8   PRINK   CALL    0C8BDH
          E6B5 CD06EB           CALL    INK
          E6B8 7E               LD      A,M
          E6B9 FE3B             CP      ';'
          E6BB 2825             JR      Z,PREX5
          E6BD CDCCC8           CALL    0C8CCH  ;Komma?
          E6C0 2C               DB      ','
          E6C1 FEE0             CP      0E0H    ;PAPER?
          E6C3 20EA             JR      NZ,SNERR1
          E6C5 CDBDC8           CALL    0C8BDH
          E6C8 CD20EB           CALL    PAPER
          E6CB CDCCC8           CALL    0C8CCH
          E6CE 3B               DB      ';'
          E6CF CD03CB   PREX3   CALL    0CB03H
          E6D2 3A7E03           LD      A,(37EH)  ;Farbe
          E6D5 E5               PUSH    HL
          E6D6 21A3B7           LD      HL,COLOR
          E6D9 CD9DEC           CALL    IRMWR     ;eintragen
          E6DC E1               POP     HL
          E6DD C1               POP     BC
          E6DE C9               RET
          E6DF C5       PREX4   PUSH    BC
          E6E0 18A3             JR      PREX1
          E6E2 CDBDC8   PREX5   CALL    0C8BDH
          E6E5 18E8             JR      PREX3
          E6E7
          E6E7          BEXP3   ;BASIC-Exp 3
          E6E7 79               LD      A,C
          E6E8 FE62             CP      62H
          E6EA CA57EA           JP      Z,VPEEK
          E6ED FE6E             CP      6EH
          E6EF CACCEC           JP      Z,PTEST
          E6F2 FE7C             CP      7CH
          E6F4 CAAAED           JP      Z,CSRLN
          E6F7 FE76             CP      76H
          E6F9 CACDED           JP      Z,VGET
          E6FC D63E             SUB     3EH
          E6FE 38AF             JR      C,SNERR1
          E700 FE07             CP      7
          E702 30AB             JR      NC,SNERR1
          E704 EB               EX      DE,HL
          E705 01B9FD           LD      BC,TOKJP ;Tokentab.
          E708 E1               POP     HL
          E709 6F               LD      L,A
          E70A 09               ADD     HL,BC
          E70B 4E               LD      C,M
          E70C 23               INC     HL
          E70D 66               LD      H,M
          E70E 69               LD      L,C
          E70F E5               PUSH    HL      ;Routine
          E710 EB               EX      DE,HL   ;anspringen
          E711 C9               RET
          E712
          E712          STRING  ;String vervielfaeltigen
          E712 CDCCC8           CALL    0C8CCH
          E715 28               DB      '('     ;Klammer auf?
          E716 CD21D4           CALL    0D421H
          E719 F5               PUSH    AF
          E71A CDD6C8           CALL    0C8D6H  ;Komma?
          E71D CD3ACD           CALL    0CD3AH
          E720 CDDBC8           CALL    0C8DBH  ;Klammer zu?
          E723 F1               POP     AF
          E724 E5               PUSH    HL
          E725 F5               PUSH    AF
          E726 CD30D3           CALL    0D330H
          E729 23               INC     HL
          E72A 23               INC     HL
          E72B 5E               LD      E,M
          E72C 23               INC     HL
          E72D 56               LD      D,M
          E72E C1               POP     BC
          E72F C5               PUSH    BC
          E730 F5               PUSH    AF
          E731 D5               PUSH    DE
          E732 4F               LD      C,A
          E733 AF               XOR     A
          E734 B9               CP      C
          E735 280C             JR      Z,STR2
          E737 B8               CP      B
          E738 2809             JR      Z,STR2
          E73A 79               LD      A,C
          E73B 05               DEC     B
          E73C 2805             JR      Z,STR2
          E73E 81       STR1    ADD     C
          E73F 382B             JR      C,STR5
          E741 10FB             DJNZ    STR1
          E743 47       STR2    LD      B,A
          E744 0E00             LD      C,0
          E746 C5               PUSH    BC
          E747 CDE1D1           CALL    0D1E1H  ;Str.-Arithm.
          E74A C1               POP     BC
          E74B C1               POP     BC
          E74C C5               PUSH    BC
          E74D CD7ED1           CALL    0D17EH
          E750 E1               POP     HL
          E751 E3               EX      (SP),HL
          E752 7C               LD      A,H
          E753 E1               POP     HL
          E754 E3               EX      (SP),HL
          E755 6F               LD      L,A
          E756 24               INC     H
          E757 25       STR3    DEC     H
          E758 E5               PUSH    HL
          E759 C5               PUSH    BC
          E75A 2807             JR      Z,STR4
          E75C CDF2D2           CALL    0D2F2H
          E75F C1               POP     BC
          E760 E1               POP     HL
          E761 18F4             JR      STR3
          E763 C1       STR4    POP     BC
          E764 E1               POP     HL
          E765 D1               POP     DE
          E766 CD02D3           CALL    0D302H
          E769 C3A9D1           JP      0D1A9H
          E76C 1E1C     STR5    LD      E,1CH   ;ST-
          E76E C356C3           JP      0C356H  ;ERROR
          E771
          E771          RENUM   ;neu nummerieren
          E771 E5               PUSH    HL
          E772 210A00           LD      HL,10
          E775 225403           LD      (354H),HL       ;DISTAN
          E778 2A5F03           LD      HL,(35FH)       ;Start
          E77B F5               PUSH    AF
          E77C E5               PUSH    HL
          E77D 23               INC     HL
          E77E 23               INC     HL
          E77F 7E               LD      A,M
          E780 23               INC     HL
          E781 66               LD      H,M
          E782 6F               LD      L,A
          E783 224E03           LD      (34EH),HL       ;ZL-Nr
          E786 225203           LD      (352H),HL       ;NANF
          E789 ED5BD703         LD      DE,(3D7H)       ;Ende
          E78D 1B               DEC     DE
          E78E 1B               DEC     DE
          E78F E1       REN1    POP     HL
          E790 E5               PUSH    HL
          E791 7E               LD      A,M
          E792 23               INC     HL
          E793 66               LD      H,M
          E794 6F               LD      L,A
          E795 CD89C6           CALL    0C689H
          E798 E3               EX      (SP),HL
          E799 20F4             JR      NZ,REN1
          E79B D1               POP     DE
          E79C 23               INC     HL
          E79D 23               INC     HL
          E79E 7E               LD      A,M
          E79F 23               INC     HL
          E7A0 66               LD      H,M
          E7A1 6F               LD      L,A
          E7A2 225003           LD      (350H),HL ;ZL-Abst.
          E7A5 0604             LD      B,4
          E7A7 F1               POP     AF
          E7A8 214E03           LD      HL,34EH
          E7AB E3               EX      (SP),HL
          E7AC 2820     REN2    JR      Z,REN5
          E7AE CD86C9           CALL    0C986H
          E7B1 F5               PUSH    AF
          E7B2 7A               LD      A,D
          E7B3 B3               OR      E
          E7B4 CA67C9   REN3    JP      Z,0C967H  ;FC-ERROR
          E7B7 F1               POP     AF
          E7B8 E3               EX      (SP),HL
          E7B9 73               LD      M,E
          E7BA 23               INC     HL
          E7BB 72               LD      M,D
          E7BC 23               INC     HL
          E7BD 280F             JR      Z,REN5
          E7BF F5               PUSH    AF
          E7C0 05               DEC     B
          E7C1 2807             JR      Z,REN4
          E7C3 F1               POP     AF
          E7C4 E3               EX      (SP),HL
          E7C5 CDD6C8           CALL    0C8D6H  ;Komma?
          E7C8 18E2             JR      REN2
          E7CA F1       REN4    POP     AF
          E7CB C275EA           JP      NZ,SNERR2
          E7CE 2A5003   REN5    LD      HL,(350H)
          E7D1 ED5B4E03         LD      DE,(34EH)
          E7D5 CD89C6           CALL    0C689H
          E7D8 DA67C9   REN6    JP      C,0C967H
          E7DB 2A5F03           LD      HL,(35FH)
          E7DE CDBEC4   REN7    CALL    0C4BEH
          E7E1 3804             JR      C,REN8
          E7E3 28CF             JR      Z,REN3
          E7E5 18F7             JR      REN7
          E7E7 E1       REN8    POP     HL
          E7E8 C5               PUSH    BC
          E7E9 ED5B5003         LD      DE,(350H)
          E7ED 210000           LD      HL,0
          E7F0 225003           LD      (350H),HL
          E7F3 60       REN9    LD      H,B
          E7F4 69               LD      L,C
          E7F5 4E               LD      C,M
          E7F6 23               INC     HL
          E7F7 46               LD      B,M
          E7F8 78               LD      A,B
          E7F9 B1               OR      C
          E7FA 28B8             JR      Z,REN3
          E7FC 23               INC     HL
          E7FD 7E               LD      A,M
          E7FE 23               INC     HL
          E7FF 66               LD      H,M
          E800 6F               LD      L,A
          E801 CD89C6           CALL    0C689H
          E804 2A5003           LD      HL,(350H)
          E807 23               INC     HL
          E808 225003           LD      (350H),HL
          E80B 20E6             JR      NZ,REN9
          E80D 23               INC     HL
          E80E 23               INC     HL
          E80F 29               ADD     HL,HL
          E810 23               INC     HL
          E811 ED5BD703         LD      DE,(3D7H)
          E815 19               ADD     HL,DE
          E816 38C0             JR      C,REN6
          E818 CD27C3           CALL    0C327H  ;genug RAM?
          E81B 22D703           LD      (3D7H),HL
          E81E AF               XOR     A
          E81F 2B               DEC     HL
          E820 77               LD      M,A
          E821 2B               DEC     HL
          E822 77               LD      M,A
          E823 1B               DEC     DE
          E824 1B               DEC     DE
          E825 EB               EX      DE,HL
          E826 73               LD      M,E
          E827 23               INC     HL
          E828 72               LD      M,D
          E829 23               INC     HL
          E82A 3D               DEC     A
          E82B 77               LD      M,A
          E82C 23               INC     HL
          E82D 77               LD      M,A
          E82E 23               INC     HL
          E82F EB               EX      DE,HL
          E830 2A5203           LD      HL,(352H)
          E833 224E03           LD      (34EH),HL
          E836 E1       REN10   POP     HL
          E837 4E               LD      C,M
          E838 23               INC     HL
          E839 46               LD      B,M
          E83A 23               INC     HL
          E83B C5               PUSH    BC
          E83C 014E03           LD      BC,34EH
          E83F 7E               LD      A,M
          E840 12               LD      (DE),A
          E841 0A               LD      A,(BC)
          E842 77               LD      M,A
          E843 23               INC     HL
          E844 13               INC     DE
          E845 03               INC     BC
          E846 7E               LD      A,M
          E847 12               LD      (DE),A
          E848 0A               LD      A,(BC)
          E849 77               LD      M,A
          E84A 13               INC     DE
          E84B 2A4E03           LD      HL,(34EH)
          E84E ED4B5403         LD      BC,(354H)
          E852 09               ADD     HL,BC
          E853 224E03           LD      (34EH),HL
          E856 2A5003           LD      HL,(350H)
          E859 2B               DEC     HL
          E85A 7C               LD      A,H
          E85B B5               OR      L
          E85C 225003           LD      (350H),HL
          E85F 20D5             JR      NZ,REN10
          E861 12               LD      (DE),A
          E862 E1               POP     HL
          E863 2A5F03           LD      HL,(35FH)
          E866 E5               PUSH    HL
          E867 E1       REN11   POP     HL
          E868 4E               LD      C,M
          E869 23               INC     HL
          E86A 46               LD      B,M
          E86B 23               INC     HL
          E86C C5               PUSH    BC
          E86D 7E               LD      A,M
          E86E 23               INC     HL
          E86F A6               AND     M
          E870 3C               INC     A
          E871 2826             JR      Z,REN15
          E873 23       REN12   INC     HL
          E874 7E       REN13   LD      A,M
          E875 B7               OR      A
          E876 28EF             JR      Z,REN11
          E878 FE88             CP      88H     ;GOTO
          E87A 282A             JR      Z,REN16
          E87C FE8C             CP      8CH     ;GOSUB
          E87E 2826             JR      Z,REN16
          E880 FE8B             CP      8BH     ;RESTORE
          E882 2808             JR      Z,REN14
          E884 FED4             CP      0D4H    ;ELSE
          E886 2804             JR      Z,REN14
          E888 FEA9             CP      0A9H    ;THEN
          E88A 20E7             JR      NZ,REN12
          E88C CD87C9   REN14   CALL    0C987H
          E88F 7B               LD      A,E
          E890 B2               OR      D
          E891 C4BAE8           CALL    NZ,RENUP1
          E894 C4ECE8           CALL    NZ,RENUP2
          E897 18DB             JR      REN13
          E899 2B       REN15   DEC     HL
          E89A 22D703           LD      (3D7H),HL
          E89D 2B               DEC     HL
          E89E 77               LD      M,A
          E89F 2B               DEC     HL
          E8A0 77               LD      M,A
          E8A1 E1               POP     HL
          E8A2 E1               POP     HL
          E8A3 C38AC4           JP      0C48AH
          E8A6 CD87C9   REN16   CALL    0C987H
          E8A9 7B               LD      A,E
          E8AA B2               OR      D
          E8AB 28C7             JR      Z,REN13
          E8AD CDBAE8           CALL    RENUP1
          E8B0 C4ECE8           CALL    NZ,RENUP2
          E8B3 7E               LD      A,M
          E8B4 FE2C             CP      2CH
          E8B6 20BC             JR      NZ,REN13
          E8B8 18EC             JR      REN16
          E8BA
          E8BA E5       RENUP1  PUSH    HL
          E8BB D5               PUSH    DE
          E8BC 11FFFF           LD      DE,-1
          E8BF CDBBC4           CALL    0C4BBH  ;naechste Zeile
          E8C2 D1               POP     DE
          E8C3 03               INC     BC
          E8C4 03               INC     BC
          E8C5 03               INC     BC
          E8C6 03               INC     BC
          E8C7 60               LD      H,B
          E8C8 69               LD      L,C
          E8C9 ED4B5203         LD      BC,(352H)
          E8CD 7E       RUP11   LD      A,M
          E8CE 23               INC     HL
          E8CF E5               PUSH    HL
          E8D0 B6               OR      M
          E8D1 2816             JR      Z,RUP13
          E8D3 7E               LD      A,M
          E8D4 2B               DEC     HL
          E8D5 6E               LD      L,M
          E8D6 67               LD      H,A
          E8D7 CD89C6           CALL    0C689H
          E8DA 280A             JR      Z,RUP12
          E8DC 2A5403           LD      HL,(354H)
          E8DF 09               ADD     HL,BC
          E8E0 44               LD      B,H
          E8E1 4D               LD      C,L
          E8E2 E1               POP     HL
          E8E3 23               INC     HL
          E8E4 18E7             JR      RUP11
          E8E6 3EFF     RUP12   LD      A,0FFH
          E8E8 B7               OR      A
          E8E9 E1       RUP13   POP     HL
          E8EA E1               POP     HL
          E8EB C9               RET
          E8EC
          E8EC C5       RENUP2  PUSH    BC
          E8ED EB               EX      DE,HL
          E8EE 2AD703           LD      HL,(3D7H)
          E8F1 ED52             SBC     HL,DE
          E8F3 E5               PUSH    HL
          E8F4 C1       RUP21   POP     BC
          E8F5 62               LD      H,D
          E8F6 6B               LD      L,E
          E8F7 1B               DEC     DE
          E8F8 1A               LD      A,(DE)
          E8F9 FE2C             CP      ','
          E8FB 280B             JR      Z,RUP22
          E8FD FE3A             CP      ':'
          E8FF 3007             JR      NC,RUP22
          E901 C5               PUSH    BC
          E902 D5               PUSH    DE
          E903 EDB0             LDIR
          E905 D1               POP     DE
          E906 18EC             JR      RUP21
          E908 EB       RUP22   EX      DE,HL
          E909 D1               POP     DE
          E90A E5               PUSH    HL
          E90B C5               PUSH    BC
          E90C AF               XOR     A
          E90D 0698             LD      B,98H
          E90F CDAED6           CALL    0D6AEH
          E912 CD34D8           CALL    0D834H
          E915 C1               POP     BC
          E916 D1               POP     DE
          E917 23               INC     HL
          E918 13               INC     DE
          E919 7E       RUP23   LD      A,M
          E91A B7               OR      A
          E91B 280F             JR      Z,RUP24
          E91D C5               PUSH    BC
          E91E E5               PUSH    HL
          E91F EB               EX      DE,HL
          E920 09               ADD     HL,BC
          E921 54               LD      D,H
          E922 5D               LD      E,L
          E923 2B               DEC     HL
          E924 EDB8             LDDR
          E926 E1               POP     HL
          E927 EDA0             LDI
          E929 C1               POP     BC
          E92A 18ED             JR      RUP23
          E92C D5       RUP24   PUSH    DE
          E92D ED5B5F03         LD      DE,(35FH)
          E931 CD93C4           CALL    0C493H
          E934 23       RUP25   INC     HL
          E935 7E               LD      A,M
          E936 23               INC     HL
          E937 B6               OR      M
          E938 20FA             JR      NZ,RUP25
          E93A EB               EX      DE,HL
          E93B 73               LD      M,E
          E93C 23               INC     HL
          E93D 72               LD      M,D
          E93E 13               INC     DE
          E93F 13               INC     DE
          E940 ED53D703         LD      (3D7H),DE
          E944 E1               POP     HL
          E945 54               LD      D,H
          E946 5D               LD      E,L
          E947 7E       RUP26   LD      A,M
          E948 B7               OR      A
          E949 23               INC     HL
          E94A 20FB             JR      NZ,RUP26
          E94C C1               POP     BC
          E94D E3               EX      (SP),HL
          E94E C5               PUSH    BC
          E94F EB               EX      DE,HL
          E950 C9               RET
          E951
          E951          DELETE  ;Zeile(n) loeschen
          E951 C8               RET     Z
          E952 CD86C9           CALL    0C986H
          E955 CA42C4           JP      Z,0C442H
          E958 CDD6C8           CALL    0C8D6H
          E95B D5               PUSH    DE
          E95C CD86C9           CALL    0C986H
          E95F E1               POP     HL
          E960 C0               RET     NZ
          E961 EB               EX      DE,HL
          E962 E5               PUSH    HL
          E963 CDBBC4           CALL    0C4BBH  ;naechste Zeile
          E966 D24DC4           JP      NC,0C44DH ;UL-ERROR
          E969 D1               POP     DE
          E96A F5               PUSH    AF
          E96B C5               PUSH    BC
          E96C CDBEC4           CALL    0C4BEH
          E96F D24DC4           JP      NC,0C44DH ;UL-ERROR
          E972 C1               POP     BC
          E973 C350C4           JP      0C450H  ;einsortieren
          E976
          E976          PAUSE   ;Programm unterbrechen
          E976 CDBEC8           CALL    0C8BEH
          E979 200F             JR      NZ,PAUS2
          E97B CD98E4   PAUS1   CALL    KBDS
          E97E 30FB             JR      NC,PAUS1
          E980 FE03             CP      3       ;BRK?
          E982 C8               RET     Z
          E983 FE0A             CP      LF      ;CUU?
          E985 20F4             JR      NZ,PAUS1
          E987 C3E4DD           JP      0DDE4H  ;Eingabe ASCII
          E98A CD21D4   PAUS2   CALL    0D421H
          E98D 4F               LD      C,A
          E98E 3E10     PAUS3   LD      A,10H   ;96 sek.
          E990 1E14             LD      E,14H   ;WAIT
          E992 CD15F0           CALL    0F015H  ;PV5
          E995 C5               PUSH    BC
          E996 CD98E4           CALL    KBDS
          E999 C1               POP     BC
          E99A 300A             JR      NC,PAUS4
          E99C FE03             CP      3       ;BRK?
          E99E C8               RET     Z
          E99F FE0A             CP      LF      ;CUU?
          E9A1 2003             JR      NZ,PAUS4
          E9A3 C3E4DD           JP      0DDE4H  ;Eingabe ASCII
          E9A6 0D       PAUS4   DEC     C
          E9A7 20E5             JR      NZ,PAUS3
          E9A9 C9               RET
          E9AA
          E9AA          BBEEP   ;Signalton
          E9AA 0601             LD      B,1     ;ohne Angabe 1x
          E9AC CDBEC8           CALL    0C8BEH
          E9AF 2804             JR      Z,BBP1
          E9B1 CD21D4           CALL    0D421H
          E9B4 47               LD      B,A     ;Anzahl
          E9B5 3E07     BBP1    LD      A,7     ;Beep
          E9B7 1E00             LD      E,0     ;CRT
          E9B9 CD15F0           CALL    0F015H  ;PV5
          E9BC 10F7             DJNZ    BBP1
          E9BE C9               RET
          E9BF
          E9BF          WINDOW  ;Fenster einstellen
          E9BF CDBEC8           CALL    0C8BEH
          E9C2 2865             JR      Z,WINDOW1
          E9C4 E5               PUSH    HL
          E9C5 CD21D4           CALL    0D421H
          E9C8 E3               EX      (SP),HL     ;in
          E9C9 21F6B9           LD      HL,WNDFN+90 ;Fenster 9
          E9CC CD9DEC           CALL    IRMWR       ;erstellen
          E9CF 23               INC     HL
          E9D0 E3               EX      (SP),HL
          E9D1 CDD6C8           CALL    0C8D6H
          E9D4 CD21D4           CALL    0D421H
          E9D7 E3               EX      (SP),HL
          E9D8 CD9DEC           CALL    IRMWR
          E9DB 23               INC     HL
          E9DC E3               EX      (SP),HL
          E9DD CDD6C8           CALL    0C8D6H
          E9E0 CD21D4           CALL    0D421H
          E9E3 E3               EX      (SP),HL
          E9E4 CD9DEC           CALL    IRMWR
          E9E7 E3               EX      (SP),HL
          E9E8 CDD6C8           CALL    0C8D6H
          E9EB CD21D4           CALL    0D421H
          E9EE E3               EX      (SP),HL
          E9EF 57               LD      D,A
          E9F0 CD18F0           CALL    0F018H  ;IRMON
          E9F3 FE28             CP      28H
          E9F5 304D             JR      NC,WINERR
          E9F7 3AF8B9           LD      A,(WNDFN+92)
          E9FA 5F               LD      E,A
          E9FB FE28             CP      28H
          E9FD 3045             JR      NC,WINERR
          E9FF 7A               LD      A,D
          EA00 93               SUB     E
          EA01 3841             JR      C,WINERR
          EA03 3C               INC     A
          EA04 329EB7           LD      (WINLG),A
          EA07 7B               LD      A,E
          EA08 329CB7           LD      (WINON),A
          EA0B 3AF7B9           LD      A,(WNDFN+91)
          EA0E FE20             CP      20H
          EA10 3032             JR      NC,WINERR
          EA12 57               LD      D,A
          EA13 3AF6B9           LD      A,(WNDFN+90)
          EA16 FE20             CP      20H
          EA18 302A             JR      NC,WINERR
          EA1A 5F               LD      E,A
          EA1B 7A               LD      A,D
          EA1C 93               SUB     E
          EA1D 3825             JR      C,WINERR
          EA1F 3C               INC     A
          EA20 329FB7           LD      (WINLG+1),A
          EA23 7B               LD      A,E
          EA24 329DB7           LD      (WINON+1),A
          EA27 1810             JR      WINDOW2
          EA29 E5       WINDOW1 PUSH    HL
          EA2A CD18F0           CALL    0F018H  ;IRMON
          EA2D 210001           LD      HL,100H
          EA30 229CB7           LD      (WINON),HL
          EA33 21281E           LD      HL,1E28H
          EA36 229EB7           LD      (WINLG),HL
          EA39 210000   WINDOW2 LD      HL,0
          EA3C 22A0B7           LD      (CURSO),HL
          EA3F CD1BF0           CALL    0F01BH  ;IRMOF
          EA42 E1               POP     HL
          EA43 C9               RET
          EA44 CD1BF0   WINERR  CALL    0F01BH  ;IRMOF
          EA47 182C             JR      SNERR2
          EA49
          EA49          BLOAD   ;MC-Programm laden
          EA49 E5               PUSH    HL
          EA4A 2181B7           LD      HL,ARGN
          EA4D AF               XOR     A
          EA4E CD9DEC           CALL    IRMWR   ;ARGN=0
          EA51 E1               POP     HL
          EA52 1E10             LD      E,10H   ;LOAD
          EA54 C315F0           JP      0F015H  ;PV5
          EA57
          EA57 CDE1CD   VPEEK   CALL    0CDE1H
          EA5A E3               EX      (SP),HL
          EA5B 11F3CD           LD      DE,0CDF3H ;RET-Adr.
          EA5E D5               PUSH    DE
          EA5F CD6FC9           CALL    0C96FH
          EA62 E5               PUSH    HL
          EA63 210080           LD      HL,8000H;IRM-Offset
          EA66 19               ADD     HL,DE
          EA67 3803             JR      C,VPK   ;Error
          EA69 3EBF             LD      A,0BFH
          EA6B BC               CP      H
          EA6C 3807     VPK     JR      C,SNERR2
          EA6E CDA1EC           CALL    IRMRD
          EA71 E1               POP     HL
          EA72 C3E9D3           JP      0D3E9H
          EA75
          EA75 C348C3   SNERR2  JP      0C348H  ;SN-ERROR
          EA78
          EA78          VPOKE   ;in IRM schreiben
          EA78 CD6CC9           CALL    0C96CH
          EA7B D5               PUSH    DE
          EA7C CDD6C8           CALL    0C8D6H
          EA7F CD21D4           CALL    0D421H
          EA82 E3               EX      (SP),HL
          EA83 110080           LD      DE,8000H;IRM-Offset
          EA86 19               ADD     HL,DE
          EA87 38E3             JR      C,VPK   ;Error
          EA89 57               LD      D,A
          EA8A 3EBF             LD      A,0BFH
          EA8C BC               CP      H
          EA8D 38DD             JR      C,VPK   ;nur bis BFFFH
          EA8F 7A               LD      A,D
          EA90 CD9DEC           CALL    IRMWR   ;schreiben
          EA93 E1               POP     HL
          EA94 C9               RET
          EA95
          EA95          BORDER  ;schaltet RAM-8!
          EA95 CD21D4           CALL    0D421H
          EA98 0F               RRCA
          EA99 0F               RRCA
          EA9A 0F               RRCA
          EA9B E660             AND     60H     ;Auswahl
          EA9D 4F               LD      C,A
          EA9E 069F             LD      B,9FH   ;Maske
          EAA0 C323F9           JP      TONB
          EAA3
          EAA3          PRAT    ;PRINT AT
          EAA3 3AFD03           LD      A,(3FDH)
          EAA6 CB4F             BIT     1,A
          EAA8 CBCF             SET     1,A
          EAAA 32FD03           LD      (3FDH),A
          EAAD 20C6             JR      NZ,SNERR2
          EAAF D5               PUSH    DE
          EAB0 E5               PUSH    HL
          EAB1 CD18F0           CALL    0F018H  ;IRMON
          EAB4 219CB7           LD      HL,WINON
          EAB7 22F6B9           LD      (WNDFN+90),HL
          EABA 11ECB9           LD      DE,WNDFN+80
          EABD 010600           LD      BC,6    ;Fenster
          EAC0 EDB0             LDIR            ;retten
          EAC2 210000           LD      HL,0    ;Fenster groî
          EAC5 229CB7           LD      (WINON),HL
          EAC8 212820           LD      HL,2028H
          EACB 229EB7           LD      (WINLG),HL
          EACE CD1BF0           CALL    0F01BH  ;IRMOF
          EAD1 E1               POP     HL
          EAD2 CD4EEB           CALL    LOCAT
          EAD5 CDDBC8           CALL    0C8DBH
          EAD8 CDCCC8           CALL    0C8CCH
          EADB 3B               DB      ';'
          EADC 7E               LD      A,M
          EADD FEDF             CP      0DFH
          EADF 381D             JR      C,PRAT2 ;<DFH
          EAE1 FEE3             CP      0E3H
          EAE3 3019             JR      NC,PRAT2;>E2H
          EAE5 CDDFE6           CALL    PREX4   ;INK,PAPER,COLOR
          EAE8 E5       PRAT1   PUSH    HL
          EAE9 CD18F0           CALL    0F018H  ;IRMON
          EAEC 21ECB9           LD      HL,WNDFN+80
          EAEF 119CB7           LD      DE,WINON
          EAF2 010600           LD      BC,6    ;Fenster
          EAF5 EDB0             LDIR            ;regenerieren
          EAF7 CD1BF0           CALL    0F01BH  ;IRMOF
          EAFA E1               POP     HL
          EAFB D1               POP     DE
          EAFC C1               POP     BC
          EAFD C9               RET
          EAFE CD03CB   PRAT2   CALL    0CB03H
          EB01 18E5             JR      PRAT1
          EB03
          EB03 C348C3   SNERR3  JP      0C348H  ;SN-ERROR
          EB06
          EB06 CD21D4   INK     CALL    0D421H
          EB09 FE20             CP      32
          EB0B 30F6             JR      NC,SNERR3
          EB0D CB27             SLA     A
          EB0F CB27             SLA     A
          EB11 CB27             SLA     A
          EB13 57               LD      D,A
          EB14 E5               PUSH    HL
          EB15 21A3B7           LD      HL,COLOR
          EB18 CDA1EC           CALL    IRMRD
          EB1B E1               POP     HL
          EB1C E607             AND     7
          EB1E 1812             JR      COL2
          EB20
          EB20 CD21D4   PAPER   CALL    0D421H
          EB23 FE08     COL1    CP      8
          EB25 30DC             JR      NC,SNERR3
          EB27 57               LD      D,A
          EB28 E5               PUSH    HL
          EB29 21A3B7           LD      HL,COLOR
          EB2C CDA1EC           CALL    IRMRD
          EB2F E1               POP     HL
          EB30 E6F8             AND     0F8H
          EB32 B2       COL2    OR      D
          EB33 E5               PUSH    HL
          EB34 21A3B7           LD      HL,COLOR
          EB37 CD9DEC           CALL    IRMWR   ;neuer Farbwert
          EB3A E1               POP     HL
          EB3B C9               RET
          EB3C
          EB3C CDBEC8   BCOLOR  CALL    0C8BEH
          EB3F 28C2             JR      Z,SNERR3
          EB41 CD06EB           CALL    INK     ;Vordergrund
          EB44 CDBEC8           CALL    0C8BEH
          EB47 C8               RET     Z
          EB48 CDD6C8           CALL    0C8D6H
          EB4B 18D3             JR      PAPER   ;Hintergrund
          EB4D C9               RET
          EB4E
          EB4E          LOCAT   ;Cursor positionieren
          EB4E CDBDC8           CALL    0C8BDH
          EB51 CDCCC8           CALL    0C8CCH
          EB54 28               DB      '('
          EB55 CD21D4   LOCATE  CALL    0D421H
          EB58 57               LD      D,A
          EB59 E5               PUSH    HL
          EB5A 219FB7           LD      HL,WINLG+1
          EB5D CDA1EC           CALL    IRMRD
          EB60 E1               POP     HL
          EB61 3D               DEC     A
          EB62 BA               CP      D
          EB63 389E             JR      C,SNERR3
          EB65 CDD6C8           CALL    0C8D6H
          EB68 D5               PUSH    DE
          EB69 CD21D4           CALL    0D421H
          EB6C D1               POP     DE
          EB6D 4F               LD      C,A
          EB6E E5               PUSH    HL
          EB6F 219EB7           LD      HL,WINLG
          EB72 CDA1EC           CALL    IRMRD
          EB75 E1               POP     HL
          EB76 3D               DEC     A
          EB77 B9               CP      C
          EB78 3889             JR      C,SNERR3
          EB7A 79               LD      A,C
          EB7B E5               PUSH    HL
          EB7C 21A0B7           LD      HL,CURSO
          EB7F CD9DEC           CALL    IRMWR
          EB82 7A               LD      A,D
          EB83 23               INC     HL
          EB84 CD9DEC   LOC1    CALL    IRMWR
          EB87 E1               POP     HL
          EB88 C9               RET
          EB89
          EB89          INKEY   ;Eingabe ein Zeichen
          EB89 E5               PUSH    HL
          EB8A CD98E4           CALL    KBDS
          EB8D 300F             JR      NC,INKEY3
          EB8F 3E01             LD      A,1
          EB91 CD7BD1           CALL    0D17BH
          EB94 CDE4DD           CALL    0DDE4H  ;Eingabe ASCII
          EB97 2AC203   INKEY1  LD      HL,(3C2H)
          EB9A 77               LD      M,A
          EB9B C3A9D1   INKEY2  JP      0D1A9H
          EB9E AF       INKEY3  XOR     A
          EB9F CD7BD1           CALL    0D17BH
          EBA2 18F7             JR      INKEY2
          EBA4
          EBA4          SOUND   ;Tonausgabe
          EBA4 CD21D4           CALL    0D421H
          EBA7 E5               PUSH    HL
          EBA8 2182B7           LD      HL,ARG1
          EBAB 0604             LD      B,4     ;4 Argumente
          EBAD CD9DEC   SOUND1  CALL    IRMWR
          EBB0 23               INC     HL
          EBB1 E3               EX      (SP),HL
          EBB2 05               DEC     B
          EBB3 280B             JR      Z,SOUND2
          EBB5 C5               PUSH    BC
          EBB6 CDD6C8           CALL    0C8D6H
          EBB9 CD21D4           CALL    0D421H
          EBBC C1               POP     BC
          EBBD E3               EX      (SP),HL
          EBBE 18ED             JR      SOUND1
          EBC0 CDBEC8   SOUND2  CALL    0C8BEH
          EBC3 281C             JR      Z,SOUND3
          EBC5 CDD6C8           CALL    0C8D6H
          EBC8 CD21D4           CALL    0D421H
          EBCB E3               EX      (SP),HL
          EBCC CD9DEC           CALL    IRMWR
          EBCF 23               INC     HL
          EBD0 E3               EX      (SP),HL
          EBD1 CDBEC8           CALL    0C8BEH
          EBD4 280B             JR      Z,SOUND3
          EBD6 CDD6C8           CALL    0C8D6H
          EBD9 CD21D4           CALL    0D421H
          EBDC E3               EX      (SP),HL
          EBDD CD9DEC           CALL    IRMWR
          EBE0 E3               EX      (SP),HL
          EBE1 1E35     SOUND3  LD      E,35H   ;TON
          EBE3 C1               POP     BC
          EBE4 C315F0           JP      0F015H  ;PV5
          EBE7
          EBE7          PSET    ;Punkt setzen
          EBE7 0601             LD      B,1     ;setzen
          EBE9 C5       POINT   PUSH    BC
          EBEA CD6CC9           CALL    0C96CH
          EBED E5               PUSH    HL
          EBEE 7B               LD      A,E
          EBEF 21D3B7           LD      HL,HOR
          EBF2 CD9DEC           CALL    IRMWR
          EBF5 7A               LD      A,D
          EBF6 23               INC     HL
          EBF7 CD9DEC           CALL    IRMWR
          EBFA E3               EX      (SP),HL
          EBFB CDD6C8           CALL    0C8D6H
          EBFE CD21D4           CALL    0D421H
          EC01 E3               EX      (SP),HL
          EC02 23               INC     HL
          EC03 CD9DEC           CALL    IRMWR
          EC06 E1               POP     HL
          EC07 CD1CEC           CALL    GFARB
          EC0A 1E30             LD      E,30H   ;PUSE
          EC0C C1               POP     BC
          EC0D 05               DEC     B
          EC0E 2801             JR      Z,POINT2
          EC10 1D               DEC     E       ;PUDE
          EC11 CD15F0   POINT2  CALL    0F015H  ;PV1
          EC14 DA75EA           JP      C,SNERR2
          EC17 C9               RET
          EC18
          EC18          PRESET  ;Punkt loeschen
          EC18 0600             LD      B,0     ;loeschen
          EC1A 18CD             JR      POINT
          EC1C
          EC1C CDBEC8   GFARB   CALL    0C8BEH
          EC1F C8               RET     Z
          EC20 CDD6C8           CALL    0C8D6H
          EC23 CD21D4           CALL    0D421H
          EC26 E5               PUSH    HL
          EC27 21D6B7           LD      HL,FARB ;Grafik-Farbe
          EC2A 17               RLA
          EC2B 17               RLA
          EC2C 17               RLA
          EC2D C384EB           JP      LOC1    ;in IRM schreib.
          EC30
          EC30          INSTR   ;String1 in String2 suchen
          EC30 CD36CD           CALL    0CD36H  ;Klammer auf?
          EC33 CDD6C8           CALL    0C8D6H
          EC36 E5               PUSH    HL
          EC37 CD30D3           CALL    0D330H
          EC3A 2838             JR      Z,INSTR4
          EC3C 47               LD      B,A
          EC3D 23               INC     HL
          EC3E 23               INC     HL
          EC3F 5E               LD      E,M
          EC40 23               INC     HL
          EC41 56               LD      D,M
          EC42 E1               POP     HL
          EC43 D5               PUSH    DE
          EC44 C5               PUSH    BC
          EC45 CD3ACD           CALL    0CD3AH
          EC48 CDDBC8           CALL    0C8DBH  ;Klammer zu?
          EC4B C1               POP     BC
          EC4C D1               POP     DE
          EC4D E5               PUSH    HL
          EC4E D5               PUSH    DE
          EC4F C5               PUSH    BC
          EC50 CD30D3           CALL    0D330H
          EC53 281F             JR      Z,INSTR4
          EC55 23               INC     HL
          EC56 23               INC     HL
          EC57 4E               LD      C,M
          EC58 23               INC     HL
          EC59 66               LD      H,M
          EC5A 69               LD      L,C
          EC5B C1               POP     BC
          EC5C 4F               LD      C,A
          EC5D D1               POP     DE
          EC5E E5               PUSH    HL
          EC5F C5       INSTR0  PUSH    BC
          EC60 D5               PUSH    DE
          EC61 1A               LD      A,(DE)
          EC62 BE       INSTR1  CP      M
          EC63 2812             JR      Z,INSTR5
          EC65 23               INC     HL
          EC66 0D               DEC     C
          EC67 20F9             JR      NZ,INSTR1
          EC69 AF       INSTR2  XOR     A
          EC6A E1               POP     HL
          EC6B E1               POP     HL
          EC6C E1               POP     HL
          EC6D 11F3CD   INSTR3  LD      DE,0CDF3H ;RET-Adr.
          EC70 D5               PUSH    DE
          EC71 C3C0D0           JP      0D0C0H
          EC74 C367C9   INSTR4  JP      0C967H  ;FC-ERROR
          EC77 23       INSTR5  INC     HL
          EC78 E5               PUSH    HL
          EC79 2B               DEC     HL
          EC7A 23       INSTR6  INC     HL
          EC7B 0D               DEC     C
          EC7C 280E             JR      Z,INSTR7
          EC7E 13               INC     DE
          EC7F 05               DEC     B
          EC80 2811             JR      Z,INSTR8
          EC82 1A               LD      A,(DE)
          EC83 BE               CP      M
          EC84 28F4             JR      Z,INSTR6
          EC86 E1               POP     HL
          EC87 D1               POP     DE
          EC88 C1               POP     BC
          EC89 0D               DEC     C
          EC8A 18D3             JR      INSTR0
          EC8C 13       INSTR7  INC     DE
          EC8D 05               DEC     B
          EC8E E1               POP     HL
          EC8F 20D8             JR      NZ,INSTR2
          EC91 1801             JR      INSTR9
          EC93 E1       INSTR8  POP     HL
          EC94 D1       INSTR9  POP     DE
          EC95 D1               POP     DE
          EC96 D1               POP     DE
          EC97 A7               AND     A
          EC98 ED52             SBC     HL,DE
          EC9A 7D               LD      A,L
          EC9B 18D0             JR      INSTR3
          EC9D
          EC9D 1E28     IRMWR   LD      E,28H   ;LDMA
          EC9F 180D             JR      JPV5
          ECA1
          ECA1 1E29     IRMRD   LD      E,29H   ;LDAM
          ECA3 1809             JR      JPV5
          ECA5
          ECA5          BKEY    ;F-Taste belegen
          ECA5 CD21D4           CALL    0D421H
          ECA8 FE10             CP      16      ;F0 ... F15
          ECAA 3052             JR      NC,SNERR4
          ECAC 1E39             LD      E,39H   ;KEY
          ECAE C315F0   JPV5    JP      0F015H  ;PV5
          ECB1
          ECB1          KEYLIST ;F-Tasten auflisten
          ECB1 1E3A             LD      E,3AH   ;KEYLI
          ECB3 18F9             JR      JPV5
          ECB5
          ECB5          SWITCH  ;Module schalten
          ECB5 CD21D4           CALL    0D421H
          ECB8 F5               PUSH    AF
          ECB9 CDD6C8           CALL    0C8D6H
          ECBC CD21D4           CALL    0D421H
          ECBF 57               LD      D,A     ;Steuerbyte
          ECC0 F1               POP     AF
          ECC1 E5               PUSH    HL
          ECC2 6F               LD      L,A     ;Steckplatz
          ECC3 3E02             LD      A,2     ;schalten
          ECC5 1E26             LD      E,26H   ;MODU
          ECC7 CD15F0           CALL    0F015H  ;PV5
          ECCA E1               POP     HL
          ECCB C9               RET
          ECCC
          ECCC CDE1CD   PTEST   CALL    0CDE1H
          ECCF E3               EX      (SP),HL
          ECD0 11F3CD           LD      DE,0CDF3H ;RET-Adr.
          ECD3 D5               PUSH    DE
          ECD4 CD6FC9           CALL    0C96FH
          ECD7 E5               PUSH    HL
          ECD8 7B               LD      A,E     ;nur
          ECD9 21D3B7           LD      HL,HOR  ;X-Koordinate
          ECDC CD9DEC           CALL    IRMWR   ;eintragen
          ECDF 7A               LD      A,D
          ECE0 23               INC     HL
          ECE1 CD9DEC           CALL    IRMWR
          ECE4 1E2F             LD      E,2FH   ;PUDE
          ECE6 CD15F0           CALL    0F015H  ;PV5
          ECE9 0600             LD      B,0
          ECEB 280C             JR      Z,PTST1 ;war geloescht
          ECED 23               INC     HL
          ECEE 23               INC     HL
          ECEF CD9DEC           CALL    IRMWR
          ECF2 1E30             LD      E,30H   ;PUSE
          ECF4 CD15F0           CALL    0F015H  ;PV5
          ECF7 0601             LD      B,1
          ECF9 78       PTST1   LD      A,B     ;Rueckgabewert
          ECFA E1               POP     HL
          ECFB C3E9D3           JP      0D3E9H
          ECFE
          ECFE C348C3   SNERR4  JP      0C348H  ;SN-ERROR
          ED01
          ED01          CLOSE   ;Kanal schlieîen
          ED01 0E00             LD      C,0
          ED03 7E               LD      A,M
          ED04 FE49             CP      'I'     ;Eingabe?
          ED06 2805             JR      Z,CLOS1
          ED08 0C               INC     C
          ED09 FE4F             CP      'O'     ;Ausgabe?
          ED0B 20F1             JR      NZ,SNERR4
          ED0D C5       CLOS1   PUSH    BC
          ED0E 23               INC     HL
          ED0F 7E               LD      A,M
          ED10 FE23             CP      '#'
          ED12 20EA     CLOS2   JR      NZ,SNERR4
          ED14 23               INC     HL
          ED15 CD21D4           CALL    0D421H
          ED18 E603             AND     3       ;4 Geraete
          ED1A C1               POP     BC
          ED1B C8               RET     Z       ;Console
          ED1C E5               PUSH    HL
          ED1D 17               RLA             ;*2
          ED1E 81               ADD     C       ;Ein-/Ausgabe
          ED1F F5               PUSH    AF
          ED20 3D               DEC     A
          ED21 0600             LD      B,0
          ED23 37               SCF
          ED24 CB10     CLOS3   RL      B       ;Bit platzieren
          ED26 3D               DEC     A
          ED27 20FB             JR      NZ,CLOS3
          ED29 210703           LD      HL,307H ;E/A-Flag
          ED2C 7E               LD      A,M
          ED2D A8               XOR     B       ;negieren
          ED2E 77               LD      M,A
          ED2F F1               POP     AF
          ED30 E1               POP     HL
          ED31 CBF7             SET     6,A     ;close
          ED33 D5               PUSH    DE
          ED34 5F               LD      E,A
          ED35 1603             LD      D,3
          ED37 CD0EE0           CALL    BASIO
          ED3A D1               POP     DE
          ED3B C9               RET
          ED3C
          ED3C          RANDOM  ;Zufallsgenerator
          ED3C ED5F             LD      A,R
          ED3E 321D03           LD      (31DH),A
          ED41 C9               RET
          ED42
          ED42          OPEN    ;Kanal oeffnen
          ED42 7E               LD      A,M
          ED43 23               INC     HL
          ED44 FE49             CP      'I'     ;Eingabe?
          ED46 2819             JR      Z,OPEN1
          ED48 FE4F             CP      'O'     ;Ausgabe?
          ED4A 20C6             JR      NZ,CLOS2
          ED4C CD25DE           CALL    0DE25H
          ED4F CDC8DD           CALL    0DDC8H
          ED52 C8               RET     Z
          ED53 3ED5             LD      A,0D5H
          ED55 CDB2DC           CALL    0DCB2H
          ED58 21EA03           LD      HL,3EAH ;Druckpuffer
          ED5B AF               XOR     A
          ED5C CDD5DD           CALL    0DDD5H
          ED5F E1               POP     HL
          ED60 C9               RET
          ED61 CD5FDE   OPEN1   CALL    0DE5FH  ;Eingabe
          ED64 3A0903           LD      A,(309H);IN-Index
          ED67 E603             AND     3
          ED69 C8               RET     Z
          ED6A 3ED5             LD      A,0D5H
          ED6C CDB2DC           CALL    0DCB2H
          ED6F 21EA03           LD      HL,3EAH ;Druckuffer
          ED72 CDE4DD           CALL    0DDE4H  ;Eingabe ASCII
          ED75 E1               POP     HL
          ED76 C9               RET
          ED77
          ED77          BLINE   ;Linie zeichnen
          ED77 013E04           LD      BC,43EH ;4 Par.,LINE
          ED7A 1803             JR      GRAPH
          ED7C
          ED7C          CIRCLE  ;Kreis zeichnen
          ED7C 013F03           LD      BC,33FH ;3 Par.,CIRCLE
          ED7F C5       GRAPH   PUSH    BC
          ED80 CD6CC9           CALL    0C96CH
          ED83 C1               POP     BC
          ED84 C5               PUSH    BC
          ED85 E5               PUSH    HL
          ED86 2182B7           LD      HL,ARG1
          ED89 7B       GRAPH1  LD      A,E
          ED8A CD9DEC           CALL    IRMWR
          ED8D 23               INC     HL
          ED8E 7A               LD      A,D
          ED8F CD9DEC           CALL    IRMWR
          ED92 23               INC     HL
          ED93 05               DEC     B
          ED94 280C             JR      Z,GRAPH2
          ED96 E3               EX      (SP),HL
          ED97 C5               PUSH    BC
          ED98 CDD6C8           CALL    0C8D6H
          ED9B CD6CC9           CALL    0C96CH
          ED9E C1               POP     BC
          ED9F E3               EX      (SP),HL
          EDA0 18E7             JR      GRAPH1
          EDA2 E1       GRAPH2  POP     HL
          EDA3 CD1CEC           CALL    GFARB
          EDA6 D1               POP     DE
          EDA7 C315F0           JP      0F015H  ;PV5
          EDAA
          EDAA          CSRLN   ;akt. Zeile holen
          EDAA CDE1CD           CALL    0CDE1H
          EDAD E3               EX      (SP),HL
          EDAE 11F3CD           LD      DE,0CDF3H ;RET-Adr.
          EDB1 D5               PUSH    DE
          EDB2 CD24D4           CALL    0D424H
          EDB5 E5               PUSH    HL
          EDB6 A7               AND     A
          EDB7 3E00             LD      A,0
          EDB9 2006             JR      NZ,CSRLN1
          EDBB 219DB7           LD      HL,WINON+1
          EDBE CDA1EC           CALL    IRMRD
          EDC1 47       CSRLN1  LD      B,A
          EDC2 21A1B7           LD      HL,CURSO+1
          EDC5 CDA1EC           CALL    IRMRD
          EDC8 80               ADD     B       ;akt. Zeile
          EDC9 E1               POP     HL
          EDCA C3E9D3           JP      0D3E9H
          EDCD
          EDCD          VGET    ;Zeichen von Bildschirm lesen
          EDCD E3               EX      (SP),HL
          EDCE 3E01             LD      A,1
          EDD0 CD7BD1           CALL    0D17BH
          EDD3 CD18F0           CALL    0F018H  ;IRMON
          EDD6 ED5BA0B7         LD      DE,(CURSO)
          EDDA CD7CE0           CALL    DABR
          EDDD 7E               LD      A,M
          EDDE CD1BF0           CALL    0F01BH  ;IRMOF
          EDE1 C397EB           JP      INKEY1  ;als Zeichen
          EDE4                                  ;zurueckgeben
          EDE4
          EDE4          ESCTAB  ;ESC-Tabelle
          EDE4 2DE2             DW      ESC0    ;Tabulator
          EDE6 3EF9             DW      ESC1    ;Anz0   Zugr0
          EDE8 43F9             DW      ESC2    ;1      1
          EDEA 48F9             DW      ESC3    ;0      1
          EDEC 4DF9             DW      ESC4    ;1      0
          EDEE DEF0             DW      ESC5    ;MODUL
          EDF0 5BF8             DW      ESC6    ;SYSTEM
          EDF2 65F9             DW      ESC7    ;PixInvers o/o
          EDF4 CCE3             DW      ESC8    ;ColSwap o/o
          EDF6 6EF9             DW      ESC9    ;Farbebene o/o
          EDF8 76F9             DW      ESCA    ;HiRes o/o
          EDFA 91F9             DW      ESCB    ;HRG o/o
          EDFC 98F9             DW      ESCC    ;IBM/CAOS
          EDFE
          EDFE          FREIE   EQU     $
          EDFE FF               DS      0EDFFH-$,0FFH   ;frei
          EDFF
          EDFF 43       VERSION DB      43H     ;CAOS-Version
          EE00
          EE00                  END

        Errors: 0000
        End+1 : EE00

          0200
          0200          ;**     CAOS 4.3 ROM F          **
          0200          ;       (17.02.95)
          0200
          0200                  ORG     0F000H
          F000
          F000 C359F1           JP      PWRON
          F003 C357F0           JP      PV1     ;DEFB nr
          F006 C373F0           JP      PV2     ;(ARGC)=nr
          F009 C387F0           JP      PV3     ;E=nr
          F00C C33FF0           JP      PV4     ;E=nr, IRM e/a
          F00F C3C0F0           JP      RCALL   ;DEFW offset
          F012 C38EF1           JP      BYE     ;JUMP-Einsprung
          F015 C333F0           JP      PV5     ;E=nr, IRM/Stack
          F018 C38AF0           JP      IRMON
          F01B C3A9F0           JP      IRMOF
          F01E C32AF0           JP      PV6     ;(ARGC)=nr
          F021 CD6BFB   JDISK   CALL    CON
          F024 CD00D0           CALL    JDISC   ;DISK-Verteiler
          F027 C372FB           JP      COFF
          F02A
          F02A C5       PV6     PUSH    BC
          F02B CD8AF0           CALL    IRMON
          F02E CD73F0           CALL    PV2
          F031 1807             JR      PV51
          F033
          F033 C5       PV5     PUSH    BC
          F034 CD8AF0           CALL    IRMON
          F037 CD87F0           CALL    PV3
          F03A CDA9F0   PV51    CALL    IRMOF
          F03D C1               POP     BC
          F03E C9               RET
          F03F
          F03F CD4EF0   PV4     CALL    SCRON
          F042 CD87F0           CALL    PV3
          F045 F5       SCROFF  PUSH    AF
          F046 DB88             IN      A,88H
          F048 CB97             RES     2,A
          F04A D388             OUT     88H     ;IRM aus
          F04C F1               POP     AF
          F04D C9               RET
          F04E
          F04E F5       SCRON   PUSH    AF
          F04F DB88             IN      A,88H
          F051 CBD7             SET     2,A     ;IRM ein
          F053 D388             OUT     88H
          F055 F1               POP     AF
          F056 C9               RET
          F057
          F057 F3       PV1     DI
          F058 E5               PUSH    HL
          F059 E1               POP     HL
          F05A E1               POP     HL
          F05B 23               INC     HL      ;nr uebergehen
          F05C E5               PUSH    HL
          F05D 2B               DEC     HL      ;(HL)=nr
          F05E 3B               DEC     SP
          F05F 3B               DEC     SP
          F060 FB               EI
          F061 F5               PUSH    AF
          F062 D5               PUSH    DE
          F063 5E               LD      E,M
          F064 1600     PV22    LD      D,0
          F066 2AB0B7           LD      HL,(SUTAB)
          F069 19               ADD     HL,DE
          F06A 19               ADD     HL,DE   ;HL=Pos. in Tab
          F06B 5E               LD      E,M
          F06C 23               INC     HL
          F06D 56               LD      D,M
          F06E EB               EX      DE,HL
          F06F D1               POP     DE
          F070 F1               POP     AF
          F071 E3       EXRT    EX      (SP),HL
          F072 C9               RET             ;UP anspringen
          F073
          F073 A7       PV2     AND     A       ;VR: F
          F074 E5       PV21    PUSH    HL
          F075 D5               PUSH    DE
          F076 C5               PUSH    BC
          F077 E5               PUSH    HL
          F078 21E0F3           LD      HL,POP3 ;Returnadresse
          F07B E3               EX      (SP),HL ;kellern
          F07C E5               PUSH    HL
          F07D F5               PUSH    AF
          F07E D5               PUSH    DE
          F07F 38E3             JR      C,PV22  ;falls PV3
          F081 3A80B7           LD      A,(ARGC);sonst E
          F084 5F               LD      E,A     ;beschaffen
          F085 18DD             JR      PV22
          F087
          F087 37       PV3     SCF             ;VR: F
          F088 18EA             JR      PV21
          F08A
          F08A C1       IRMON   POP     BC      ;Rueckkehradr.
          F08B FDE5             PUSH    IY
          F08D FD210000         LD      IY,0    ;SP in IY merken
          F091 FD39             ADD     IY,SP   ;(Kein UP ver-
          F093 F3               DI              ;aendert IY!)
          F094 DD770B           LD      (IX+11),A
          F097 DB88             IN      A,88H
          F099 CBD7             SET     2,A     ;IRM ein
          F09B CBEF             SET     5,A     ;LED ein
          F09D D388             OUT     88H
          F09F ED7BAEB7         LD      SP,(SYSP)
          F0A3 FB               EI
          F0A4 DD7E0B           LD      A,(IX+11)
          F0A7 C5               PUSH    BC
          F0A8 C9               RET             ;wie JP (BC)
          F0A9
          F0A9 C1       IRMOF   POP     BC      ;analog IRMON
          F0AA DD770B           LD      (IX+11),A
          F0AD DB88             IN      A,88H
          F0AF CB97             RES     2,A
          F0B1 CBAF             RES     5,A
          F0B3 F3               DI
          F0B4 D388             OUT     88H
          F0B6 FDF9             LD      SP,IY
          F0B8 FB               EI
          F0B9 DD7E0B           LD      A,(IX+11)
          F0BC FDE1             POP     IY
          F0BE C5               PUSH    BC
          F0BF C9               RET
          F0C0
          F0C0          RCALL   ;Relativer UP-Aufruf
          F0C0                  ;ohne Registerzerstoerung
          F0C0 E3               EX      (SP),HL
          F0C1 D5               PUSH    DE
          F0C2 5E               LD      E,M
          F0C3 23               INC     HL
          F0C4 56               LD      D,M     ;DE=Offset
          F0C5 23               INC     HL
          F0C6 EB               EX      DE,HL
          F0C7 19               ADD     HL,DE   ;addieren
          F0C8 E3               EX      (SP),HL ;Zieladresse
          F0C9 EB               EX      DE,HL   ;DE von Stack
          F0CA F3               DI
          F0CB 33               INC     SP
          F0CC 33               INC     SP
          F0CD E3               EX      (SP),HL ;HL von Stack
          F0CE 3B               DEC     SP
          F0CF 3B               DEC     SP
          F0D0 FB               EI
          F0D1 C9               RET             ;Ziel anspringen
          F0D2
          F0D2          ;SWITCH und JUMP
          F0D2
          F0D2 7F7F     SWI7F   DW      7F7FH
          F0D4 53574954         DB      'SWITCH'
          F0DA 01               DB      1
          F0DB A7               AND     A
          F0DC 2008             JR      NZ,SWI
          F0DE CD6BFB   ESC5    CALL    CON
          F0E1 CDDDC1           CALL    MODULC  ;Module listen
          F0E4 1829             JR      MCOFF
          F0E6 53       SWI     LD      D,E     ;Steuerbyte
          F0E7 2D               DEC     L
          F0E8 200C             JR      NZ,SWI2 ;nicht IRM
          F0EA FE01             CP      1
          F0EC 2808             JR      Z,SWI2  ;nur lesen
          F0EE 2C               INC     L
          F0EF 26B8             LD      H,0B8H  ;IRM nur
          F0F1 72               LD      M,D     ;eintragen!
          F0F2 26FF             LD      H,0FFH
          F0F4 1804             JR      SWI3
          F0F6 2C       SWI2    INC     L
          F0F7 CD09F1           CALL    MODU    ;lesen/schalten
          F0FA 7D       SWI3    LD      A,L
          F0FB CDB7F4           CALL    AHSPC   ;Platz
          F0FE 7C               LD      A,H
          F0FF CDB7F4           CALL    AHSPC   ;Kennbyte
          F102 7A               LD      A,D
          F103 CDD4F4           CALL    AHEX    ;Steuerbyte
          F106 C3C9F4           JP      CRLF
          F109
          F109          MODU    ;Lesen und Schalten      **26**
          F109 CD6BFB           CALL    CON
          F10C CD1FC3           CALL    MODUC
          F10F C372FB   MCOFF   JP      COFF
          F112
          F112          ;Betriebssystem wechseln
          F112 7F7F     JUMP7F  DW      7F7FH
          F114 4A554D50         DB      'JUMP'
          F118 03               DB      3
          F119 7D               LD      A,L
          F11A 47       JUMP    LD      B,A             ;**27**
          F11B 0E80             LD      C,80H
          F11D ED78             IN      A,(C)
          F11F 3C               INC     A       ;Kennbyte FF?
          F120 2013             JR      NZ,JUM0
          F122 CD9AF3           CALL    OSTR
          F125 4B65696E         DB      'Kein Modul!'
          F130 070D0A00         DB      7,CR,LF,0
          F134 C9               RET
          F135 C5       JUM0    PUSH    BC
          F136 26B8             LD      H,0B8H
          F138 0607             LD      B,7     ;ab Platz 8!
          F13A 04       JUM1    INC     B
          F13B 280D             JR      Z,JUM2  ;bis FF
          F13D ED78             IN      A,(C)
          F13F 2F               CPL
          F140 E670             AND     70H     ;Speichermodul?
          F142 20F6             JR      NZ,JUM1
          F144 ED79             OUT     (C),A   ;aus
          F146 68               LD      L,B
          F147 77               LD      M,A
          F148 18F0             JR      JUM1
          F14A C1       JUM2    POP     BC
          F14B 3EFF             LD      A,0FFH  ;Ausgabe FF
          F14D 68               LD      L,B
          F14E 77               LD      M,A     ;Eintrag
          F14F F3               DI
          F150 ED79             OUT     (C),A   ;einschalten
          F152 DB88             IN      A,88H
          F154 E67E             AND     7EH
          F156 C3B4B7           JP      BJUMP   ;in IRM
          F159
          F159          PWRON   ;Einschalt-Init
          F159 31C401           LD      SP,1C4H
          F15C 3E63             LD      A,63H
          F15E D386             OUT     86H     ;RAM4 on
          F160 AF               XOR     A
          F161 47               LD      B,A
          F162 4F               LD      C,A
          F163 02       PWR1    LD      (BC),A  ;Speicher
          F164 0D               DEC     C       ;loeschen
          F165 20FC             JR      NZ,PWR1
          F167 10FA             DJNZ    PWR1
          F169 0E80             LD      C,80H   ;Module
          F16B ED79     PWR2    OUT     (C),A   ;abschalten
          F16D 10FC             DJNZ    PWR2
          F16F CD6BFB           CALL    CON
          F172 CD4FC0           CALL    SYSI    ;IRM-Init usw.
          F175 AF               XOR     A
          F176 329BB7   PWR3    LD      (WINNR),A
          F179 CD8FC5           CALL    WCOPY   ;Fenstervektor-
          F17C 3C               INC     A       ;speicher init.
          F17D FE0A             CP      10
          F17F 38F5             JR      C,PWR3
          F181 CD48F9           CALL    ESC3
          F184 3E0C             LD      A,0CH   ;Zweitbild
          F186 CDF7E3           CALL    CRT     ;loeschen
          F189 CD3EF9           CALL    ESC1
          F18C 1809             JR      PWR4
          F18E
          F18E          BYE     ;Tasten-RESET
          F18E 31C401           LD      SP,1C4H
          F191 CD6BFB           CALL    CON
          F194 CD4FC0           CALL    SYSI    ;IRM-Init usw.
          F197                  ;
          F197 CD84CD   PWR4    CALL    V24INI  ;M003 suchen
          F19A 3809             JR      C,PWR5  ;kein M003!
          F19C 3281B7           LD      (ARGN),A
          F19F CD78C8           CALL    V24OC   ;Druckerinit
          F1A2 CD6ECD           CALL    UMINIT  ;SIO B fuer
          F1A5 CD72FB   PWR5    CALL    COFF    ;Interrupt
          F1A8 018008           LD      BC,880H ;ROM-Modul mit
          F1AB ED78             IN      A,(C)   ;Strukturbyte
          F1AD 3D               DEC     A       ;01?
          F1AE 2014             JR      NZ,PWR6 ;nein
          F1B0 3E43             LD      A,43H
          F1B2 ED79             OUT     (C),A   ;ein ab 4000H
          F1B4 3208B8           LD      (0B808H),A
          F1B7 DD7E04           LD      A,(IX+4)
          F1BA E6FC             AND     0FCH    ;RAM4 aus
          F1BC DD7704           LD      (IX+4),A
          F1BF D386             OUT     86H
          F1C1 C30040           JP      4000H   ;anspringen
          F1C4 06FC     PWR6    LD      B,0FCH
          F1C6 ED78             IN      A,(C)
          F1C8 FEA7             CP      0A7H    ;Floppy?
          F1CA 203A             JR      NZ,MEN0 ;nein
          F1CC ED79             OUT     (C),A   ;einschalten
          F1CE 01F3B3           LD      BC,0B3F3H
          F1D1 ED78             IN      A,(C)   ;Betriebsart
          F1D3 3D               DEC     A
          F1D4 2830             JR      Z,MEN0  ;PC-BA
          F1D6 FE04             CP      4
          F1D8 282C             JR      Z,MEN0  ;KC-BA
          F1DA CD9AF3           CALL    OSTR
          F1DD 0C0A             DB      0CH,LF
          F1DF 4175746F         DB      'Autostart Floppy'
          F1EF 0D0A00           DB      CR,LF,0
          F1F2 3E01             LD      A,1
          F1F4 3281B7           LD      (ARGN),A
          F1F7 3EFC             LD      A,0FCH
          F1F9 CD1AF1           CALL    JUMP    ;Startversuch
          F1FC 1808             JR      MEN0
          F1FE          ;
          F1FE 7F7F     MENU7F  DW      7F7FH
          F200 4D454E55         DB      'MENU'
          F204 1F               DB      1FH
          F205 E1               POP     HL      ;Stack clear
          F206 CD9AF3   MEN0    CALL    OSTR
          F209 0C0A             DB      0CH,LF
          F20B 2A204B43         DB      '* KC-CAOS 4.3 *',0
          F21B 2100C0   MENU    LD      HL,0C000H       ;**46**
          F21E 4D               LD      C,L
          F21F 45               LD      B,L     ;BC=0
          F220 CDC9F4   MEN1    CALL    CRLF
          F223 3E02     MEN2    LD      A,2     ;CLLN
          F225 CDF7E3           CALL    CRT
          F228 3AECB7           LD      A,(PROMPT)
          F22B FE20             CP      20H
          F22D 3002             JR      NC,MEN3
          F22F 3E25             LD      A,'%'   ;Standard
          F231 CDC9F3   MEN3    CALL    OCHR
          F234 CDACE4           CALL    BRKT
          F237 3832             JR      C,LOOP2 ;Break
          F239 DD7E09           LD      A,(IX+9)
          F23C EDB1     MEN4    CPIR
          F23E E26BF2           JP      PO,LOOP2;ausgesucht
          F241 EDA1             CPI
          F243 20F7             JR      NZ,MEN4 ;2mal!
          F245 7E       MEN5    LD      A,M
          F246 FE20             CP      20H     ;Epilog?
          F248 38D6             JR      C,MEN1
          F24A FE30             CP      30H
          F24C 38D5             JR      C,MEN2
          F24E FE60             CP      60H
          F250 30D1             JR      NC,MEN2
          F252 CDC9F3           CALL    OCHR
          F255 23               INC     HL
          F256 0B               DEC     BC
          F257 18EC             JR      MEN5
          F259
          F259          LOOP    ;Eingabeschleife
          F259 CD4EF0           CALL    SCRON           ;**12**
          F25C CD72FB           CALL    COFF
          F25F 3AECB7           LD      A,(PROMPT)
          F262 FE20             CP      20H
          F264 3002             JR      NC,LOOP1
          F266 3E25             LD      A,'%'   ;Standard
          F268 CDC9F3   LOOP1   CALL    OCHR    ;Prompt
          F26B CD70F2   LOOP2   CALL    INPUT
          F26E 18E9             JR      LOOP
          F270
          F270          INPUT   ;Menuekommandoroutine
          F270 CD85F4           CALL    INLIN
          F273 300B             JR      NC,INP1
          F275 3E0B             LD      A,0BH   ;bei BRK
          F277 CDF7E3           CALL    CRT     ;Cursor hoch
          F27A 3E02             LD      A,2     ;und
          F27C CDF7E3           CALL    CRT     ;Zeile loeschen
          F27F C9               RET
          F280 13       INP1    INC     DE      ;Zeichen danach
          F281 1A               LD      A,(DE)
          F282 E6DF             AND     0DFH    ;leer?
          F284 C8               RET     Z
          F285 CD4DF3           CALL    MSUCH   ;Suche ab C000H
          F288 3846             JR      C,INP5  ;gefunden
          F28A 3A05B8           LD      A,(0B805H)
          F28D E601             AND     1
          F28F 200A             JR      NZ,INP2 ;CAOS-C war an
          F291 CD6BFB           CALL    CON
          F294 0620             LD      B,20H
          F296 CD4FF3           CALL    MS1
          F299 3835             JR      C,INP5  ;gefunden
          F29B D5       INP2    PUSH    DE
          F29C 3A02B8           LD      A,(0B802H)
          F29F 5F               LD      E,A     ;ROM-C merken
          F2A0 16D1             LD      D,0D1H  ;BASIC nicht mit
          F2A2 3E02     INP3    LD      A,2
          F2A4 6F               LD      L,A
          F2A5 CD09F1           CALL    MODU    ;ROMC-Ebene ein
          F2A8 DDCB04BF         RES     7,(IX+4),A
          F2AC D386             OUT     86H     ;CAOSC aus!
          F2AE EB               EX      DE,HL
          F2AF E3               EX      (SP),HL ;DE=Suchkette
          F2B0 EB               EX      DE,HL
          F2B1 0620             LD      B,20H
          F2B3 CD4FF3           CALL    MS1     ;Menuewort?
          F2B6 3813             JR      C,INP4  ;gefunden
          F2B8 EB               EX      DE,HL
          F2B9 E3               EX      (SP),HL ;DE=Schaltzust.
          F2BA EB               EX      DE,HL
          F2BB 3E10             LD      A,10H
          F2BD 82               ADD     D
          F2BE 57               LD      D,A
          F2BF 30E1             JR      NC,INP3 ;naechste Ebene
          F2C1 53               LD      D,E
          F2C2 3E02             LD      A,2
          F2C4 6F               LD      L,A
          F2C5 CD09F1           CALL    MODU    ;ROMC wie zuvor
          F2C8 D1               POP     DE
          F2C9 182C             JR      ERR1    ;invalid command
          F2CB                  ;
          F2CB F1       INP4    POP     AF      ;Schaltzustand
          F2CC AF               XOR     A       ;ROMC vergessen
          F2CD 3205B8           LD      (0B805H),A
          F2D0 7E       INP5    LD      A,M     ;Epilog
          F2D1 23               INC     HL
          F2D2 E5               PUSH    HL
          F2D3 FE1F             CP      1FH
          F2D5 C8               RET     Z       ;ohne arg!
          F2D6 F5               PUSH    AF
          F2D7 CD25F5           CALL    GARG    ;Arg's erfassen
          F2DA C1               POP     BC
          F2DB 384E             JR      C,ERR4  ;bad args
          F2DD 3A81B7           LD      A,(ARGN)
          F2E0 48               LD      C,B
          F2E1 CBA0             RES     4,B
          F2E3 CB28             SRA     B
          F2E5 B8               CP      B
          F2E6 3835             JR      C,ERR3  ;zu wenig arg
          F2E8 2804             JR      Z,INP6
          F2EA CB61             BIT     4,C
          F2EC 2021             JR      NZ,ERR2 ;zu viele arg
          F2EE CB41     INP6    BIT     0,C
          F2F0 CDE7F5           CALL    LARG    ;Arg's laden
          F2F3 C0               RET     NZ      ;mit IRM on
          F2F4 C345F0           JP      SCROFF  ;mit IRM off
          F2F7
          F2F7 CD9AF3   ERR1    CALL    OSTR
          F2FA 66616C73         DB      'falsches Kommando',7,0
          F30D 183B             JR      ERRCR
          F30F CD9AF3   ERR2    CALL    OSTR
          F312 7A752076         DB      'zu viele',0
          F31B 181D             JR      ERRA
          F31D CD9AF3   ERR3    CALL    OSTR
          F320 7A752077         DB      'zu wenig',0
          F329 180F             JR      ERRA
          F32B CD9AF3   ERR4    CALL    OSTR
          F32E 6665686C         DB      'fehlerhafte',0
          F33A E1       ERRA    POP     HL      ;Stack clear
          F33B CD9AF3           CALL    OSTR
          F33E 20417267         DB      ' Argumente',7,0
          F34A C3C9F4   ERRCR   JP      CRLF
          F34D
          F34D 0600     MSUCH   LD      B,0
          F34F 2100C0   MS1     LD      HL,0C000H
          F352 4D               LD      C,L
          F353 DD7E09           LD      A,(IX+9)
          F356 EDB1     ZSUCH   CPIR                    ;**1D**
          F358 37               SCF
          F359 3F               CCF
          F35A E0               RET     PO      ;nicht gef.
          F35B EDA1             CPI
          F35D 20F7             JR      NZ,ZSUCH
          F35F F5               PUSH    AF
          F360 D5               PUSH    DE
          F361 1A       ZS1     LD      A,(DE)
          F362 13               INC     DE
          F363 FE21             CP      21H
          F365 380D             JR      C,ZS3   ;Kettenende
          F367 CB6E             BIT     5,M     ;groî?
          F369 CC42F5           CALL    Z,UPCASE
          F36C EDA1             CPI
          F36E 28F1             JR      Z,ZS1
          F370 D1       ZS2     POP     DE
          F371 F1               POP     AF
          F372 18E2             JR      ZSUCH
          F374                  ;
          F374 7E       ZS3     LD      A,M
          F375 FE20             CP      20H     ;Epilog?
          F377 3809             JR      C,ZS4   ;ja
          F379 28F5             JR      Z,ZS2   ;SPC!
          F37B FE80             CP      80H
          F37D 30F1             JR      NC,ZS2  ;>80H
          F37F 23               INC     HL
          F380 18F2             JR      ZS3
          F382                  ;
          F382 F1       ZS4     POP     AF
          F383 F1               POP     AF
          F384 37               SCF             ;gefunden
          F385 C9               RET
          F386
          F386 47       WAIT    LD      B,A             ;**14**
          F387 AF               XOR     A
          F388 CD8EF3   WAIT1   CALL    WTUP
          F38B 10FB             DJNZ    WAIT1
          F38D C9               RET
          F38E                  ;
          F38E 3D       WTUP    DEC     A       ;UP fuer WAIT
          F38F C8               RET     Z
          F390 F5               PUSH    AF
          F391 F1               POP     AF
          F392 18FA             JR      WTUP
          F394
          F394 DD7E02   BNROST  LD      A,(IX+2);Blocknummer u.
          F397 CDD4F4   AHOSTR  CALL    AHEX    ;RG A und folg.
          F39A E3       OSTR    EX      (SP),HL ;ZK      **23**
          F39B 7E       OSTR1   LD      A,M     ;ausgeben
          F39C 23               INC     HL
          F39D A7               AND     A       ;bis 00-Byte
          F39E CA71F0           JP      Z,EXRT
          F3A1 CDC9F3           CALL    OCHR
          F3A4 18F5             JR      OSTR1
          F3A6
          F3A6 CDB6F3   NORM    CALL    NIN             ;**13**
          F3A9 21A7FB   NOUT    LD      HL,ZEI0         ;**20**
          F3AC E5       SOUT    PUSH    HL              ;**1E**
          F3AD 2AB9B7           LD      HL,(OUTAB)
          F3B0 E3               EX      (SP),HL
          F3B1 22B9B7           LD      (OUTAB),HL
          F3B4 E1               POP     HL
          F3B5 C9               RET
          F3B6
          F3B6 21ABFB   NIN     LD      HL,ZEI4         ;**21**
          F3B9 E5       SIN     PUSH    HL              ;**1F**
          F3BA 2ABBB7           LD      HL,(INTAB)
          F3BD E3               EX      (SP),HL
          F3BE 22BBB7           LD      (INTAB),HL
          F3C1 E1               POP     HL
          F3C2 C9               RET
          F3C3
          F3C3 E5       INTB    PUSH    HL              ;**16**
          F3C4 2ABBB7           LD      HL,(INTAB)
          F3C7 1804             JR      INTA1
          F3C9 E5       OCHR    PUSH    HL              ;**24**
          F3CA 2AB9B7           LD      HL,(OUTAB)
          F3CD D5       INTA1   PUSH    DE      ;s.a. PV1
          F3CE C5               PUSH    BC      ;(sehr aehnlich)
          F3CF 5E               LD      E,M
          F3D0 1600             LD      D,0
          F3D2 2AB0B7           LD      HL,(SUTAB)
          F3D5 F5               PUSH    AF
          F3D6 19               ADD     HL,DE
          F3D7 19               ADD     HL,DE
          F3D8 F1               POP     AF
          F3D9 5E               LD      E,M
          F3DA 23               INC     HL
          F3DB 56               LD      D,M
          F3DC EB               EX      DE,HL
          F3DD CD2CE2           CALL    JPHL
          F3E0 C1       POP3    POP     BC      ;auch fuer PV2
          F3E1 D1               POP     DE      ;bis PV6!
          F3E2 E1               POP     HL
          F3E3 C9               RET
          F3E4
          F3E4 E5       KBD     PUSH    HL              ;**04**
          F3E5 D5               PUSH    DE
          F3E6 C5               PUSH    BC
          F3E7 DDCB0876 KBD1    BIT     6,(IX+8);F-Taste aktiv?
          F3EB 205C             JR      NZ,KBD9;ja
          F3ED 1E00     KBD2    LD      E,0
          F3EF CDEAF7   KBD3    CALL    CUCP    ;blinken
          F3F2 1C               INC     E       ;e/a-Merker
          F3F3 060F             LD      B,0FH   ;F00h mal
          F3F5 CDA3E4   KBD4    CALL    KBDZ    ;abfragen
          F3F8 3807             JR      C,KBD5
          F3FA 0B               DEC     BC
          F3FB 78               LD      A,B
          F3FC B1               OR      C
          F3FD 20F6             JR      NZ,KBD4 ;dann Cursor
          F3FF 18EE             JR      KBD3    ;wieder weg usw.
          F401                  ;
          F401 CB43     KBD5    BIT     0,E     ;gerade ein?
          F403 C4EAF7           CALL    NZ,CUCP ;ja - wegnehmen
          F406 57               LD      D,A
          F407 DDCB086E         BIT     5,(IX+8);Click ein?
          F40B C4BFE3           CALL    NZ,CLIK
          F40E 7A               LD      A,D
          F40F 21A2B7           LD      HL,STBT
          F412 CB66             BIT     4,M     ;ESC aktiv?
          F414 280D             JR      Z,KBD6
          F416 ED5BA0B7         LD      DE,(CURSO)
          F41A CDF6E1           CALL    CRT1    ;ESC ausfuehren
          F41D ED53A0B7         LD      (CURSO),DE
          F421 18CA             JR      KBD2
          F423                  ;
          F423 FE1B     KBD6    CP      ESC
          F425 2004             JR      NZ,KBD7
          F427 CBE6             SET     4,M     ;ESC merken
          F429 18C2             JR      KBD2
          F42B                  ;
          F42B FEF1     KBD7    CP      0F1H    ;F-Taste?
          F42D 38B1             JR      C,POP3
          F42F E60F             AND     0FH
          F431 47               LD      B,A
          F432 2100B9           LD      HL,0B900H
          F435 7E       KBD8    LD      A,M
          F436 2C               INC     L
          F437 28B4             JR      Z,KBD2  ;Speicherende
          F439 A7               AND     A
          F43A 20F9             JR      NZ,KBD8;Pos. in Puffer
          F43C 10F7             DJNZ    KBD8    ;auszaehlen
          F43E 7D               LD      A,L
          F43F FE9C             CP      9CH
          F441 30AA             JR      NC,KBD2 ;Speicherende
          F443 DDCB08F6         SET     6,(IX+8);F-Taste aktiv
          F447 1808             JR      KBD10
          F449                  ;
          F449 CDACE4   KBD9    CALL    BRKT    ;Abbruch?
          F44C 381A             JR      C,KBD12
          F44E 2AD1B7           LD      HL,(FTAST);Zeiger auf
          F451 7E       KBD10   LD      A,M     ;naechstes CHR
          F452 FE1B             CP      ESC
          F454 200B             JR      NZ,KBD11
          F456 23               INC     HL
          F457 22D1B7           LD      (FTAST),HL
          F45A 21A2B7           LD      HL,STBT
          F45D CBE6             SET     4,M     ;ESC merken
          F45F 1886             JR      KBD1
          F461                  ;
          F461 23       KBD11   INC     HL
          F462 22D1B7           LD      (FTAST),HL;Zeiger rett.
          F465 A7               AND     A       ;Null-Ende?
          F466 2007             JR      NZ,KBD13
          F468 DDCB08B6 KBD12   RES     6,(IX+8);ja - inaktiv
          F46C C3EDF3           JP      KBD2
          F46F                  ;
          F46F 21A2B7   KBD13   LD      HL,STBT
          F472 CB66             BIT     4,M
          F474 CAE0F3           JP      Z,POP3
          F477 ED5BA0B7         LD      DE,(CURSO)
          F47B CDF6E1           CALL    CRT1    ;ESC ausfuehren
          F47E ED53A0B7         LD      (CURSO),DE
          F482 C3E7F3           JP      KBD1
          F485
          F485 CDC3F3   INLIN   CALL    INTB            ;**17**
          F488 CDC9F3           CALL    OCHR
          F48B FE03             CP      3       ;BRK?
          F48D 37               SCF
          F48E 2804             JR      Z,INLI1
          F490 FE0D             CP      CR      ;ENTER?
          F492 20F1             JR      NZ,INLIN
          F494 F5       INLI1   PUSH    AF
          F495 CDC9F4           CALL    CRLF    ;PA: A=0
          F498 ED5BA0B7         LD      DE,(CURSO)
          F49C BA               CP      D       ;Zeile 1 durch
          F49D                                  ;PAGE-Mode?
          F49D 2004             JR      NZ,INLI2
          F49F 3A9FB7           LD      A,(WINLG+1)
          F4A2 57               LD      D,A     ;D korrigieren
          F4A3 15       INLI2   DEC     D       ;Zeile drueber
          F4A4 E5               PUSH    HL
          F4A5 CD7CE0           CALL    DABR
          F4A8 EB               EX      DE,HL
          F4A9 E1               POP     HL      ;PA: DE
          F4AA F1               POP     AF      ;PA: CY=BRK
          F4AB C9       NOOP    RET
          F4AC
          F4AC 7F7F     GO7F    DW      7F7FH
          F4AE 676F             DB      'go'
          F4B0 03               DB      3
          F4B1 E9               JP      (HL)
          F4B2
          F4B2 7C       HLHX    LD      A,H             ;**1A**
          F4B3 CDD4F4           CALL    AHEX
          F4B6 7D               LD      A,L
          F4B7 CDD4F4   AHSPC   CALL    AHEX
          F4BA 3E20     SPACE   LD      A,20H           ;**2B**
          F4BC C3C9F3   SPAC0   JP      OCHR
          F4BF
          F4BF CD9AF3   ERRM    CALL    OSTR            ;**17**
          F4C2 4552524F         DB      'ERROR',7,0
          F4C9                  ;
          F4C9 CD9AF3   CRLF    CALL    OSTR            ;**2C**
          F4CC 0D0A00           DB      CR,LF,0
          F4CF C9               RET
          F4D0
          F4D0 3E10     HOME    LD      A,10H           ;**2D**
          F4D2 18E8             JR      SPAC0
          F4D4
          F4D4 F5       AHEX    PUSH    AF              ;**1C**
          F4D5 1F               RRA             ;Tetradentausch
          F4D6 1F               RRA
          F4D7 1F               RRA
          F4D8 1F               RRA
          F4D9 CDDDF4           CALL    AHEX0   ;erst aufrufen,
          F4DC F1               POP     AF      ;dann reinlaufen
          F4DD E60F     AHEX0   AND     0FH     ;Maske
          F4DF C690             ADD     90H     ;uebliche
          F4E1 27               DAA             ;Routine
          F4E2 CE40             ADC     40H     ;fuer die
          F4E4 27               DAA             ;Hexausgabe
          F4E5 18D5             JR      SPAC0
          F4E7
          F4E7 CDEAF4   HLDE    CALL    HLDE1           ;**1B**
          F4EA CDB2F4   HLDE1   CALL    HLHX
          F4ED EB               EX      DE,HL
          F4EE C9               RET
          F4EF
          F4EF 13       RHEX0   INC     DE
          F4F0 1A       RHEX    LD      A,(DE)          ;**18**
          F4F1 FE20             CP      ' '     ;Trennzeichen
          F4F3 28FA             JR      Z,RHEX0 ;uebergehen
          F4F5 AF               XOR     A
          F4F6 2198B7           LD      HL,NUMVX+1
          F4F9 77               LD      M,A
          F4FA 2B               DEC     HL      ;HL=NUMVX
          F4FB 77               LD      M,A
          F4FC 2B               DEC     HL      ;HL=NUMNX
          F4FD 77               LD      M,A     ;alles nullsetz
          F4FE 1A       RH1     LD      A,(DE)
          F4FF B7               OR      A       ;Ende-Dummy?
          F500 C8               RET     Z
          F501 FE20             CP      ' '     ;Ende-Space?
          F503 C8               RET     Z
          F504 D630             SUB     '0'
          F506 D8               RET     C
          F507 FE0A             CP      10
          F509 380B             JR      C,RH2
          F50B D607             SUB     7
          F50D E6DF             AND     0DFH    ;Klein>Groî
          F50F FE0A             CP      10
          F511 D8               RET     C
          F512 FE10             CP      10H
          F514 3F               CCF
          F515 D8               RET     C
          F516 13       RH2     INC     DE
          F517 34               INC     M       ;NUMNX erhoehen
          F518 23               INC     HL
          F519 ED6F             RLD             ;Tetrade
          F51B 23               INC     HL      ;durchschieben
          F51C ED6F             RLD
          F51E 2B               DEC     HL
          F51F 2B               DEC     HL      ;RLD setzt auch
          F520 28DC             JR      Z,RH1   ;Z-Flag!
          F522 1B               DEC     DE      ;Fehler: Zahl
          F523 37               SCF             ;zu groî
          F524 C9               RET
          F525
          F525          GARG    ;bis 10 Argumente erfassen
          F525 0181B7           LD      BC,ARGN         ;**22**
          F528 AF               XOR     A
          F529 02               LD      (BC),A  ;(ARGN)=0
          F52A CDF0F4   GARG1   CALL    RHEX
          F52D D8               RET     C       ;Fehler
          F52E 7E               LD      A,M
          F52F B7               OR      A       ;Ende-Dummy?
          F530 C8               RET     Z
          F531 23               INC     HL
          F532 03               INC     BC
          F533 7E               LD      A,M     ;L(NUMVX)
          F534 02               LD      (BC),A  ;L(Argument)
          F535 23               INC     HL
          F536 03               INC     BC
          F537 7E               LD      A,M     ;H(NUMVX)
          F538 02               LD      (BC),A  ;H(Argument)
          F539 2E81             LD      L,81H   ;HL=ARGN
          F53B 34               INC     M
          F53C 7E               LD      A,M
          F53D C6F5             ADD     0F5H    ;10 Argumente?
          F53F 30E9             JR      NC,GARG1
          F541 C9               RET             ;Fehler: zu viel
          F542
          F542          UPCASE  ;A upcasen, wenn Kleinbuchstabe
          F542 FE61             CP      'a'
          F544 D8               RET     C
          F545 FE7B             CP      'z'+1
          F547 D0               RET     NC
          F548 E6DF             AND     0DFH
          F54A C9               RET
          F54B
          F54B CD6BFB   SIXD    CALL    CON             ;**31**
          F54E CD87C0           CALL    SIXC
          F551 CD72FB           CALL    COFF
          F554                  ;
          F554 DD360500 KPUFF   LD      (IX+5H),0
          F558 DD3606B7         LD      (IX+6H),CASS/256
          F55C C9               RET
          F55D
          F55D C5       INIEA   PUSH    BC              ;**43**
          F55E 4E               LD      C,M     ;1.Byte=Adr.
          F55F 23               INC     HL
          F560 46               LD      B,M     ;2.Byte=Anz.
          F561 23               INC     HL
          F562 EDB3             OTIR
          F564 C1               POP     BC
          F565 C9               RET
          F566
          F566 56       INIMEX  LD      D,M     ;Anzahl
          F567 23               INC     HL
          F568 F3       INIME   DI                      ;**44**
          F569 CD5DF5   INIME1  CALL    INIEA
          F56C 15               DEC     D       ;D Kanaele
          F56D 20FA             JR      NZ,INIME1
          F56F FB               EI
          F570 C9               RET
          F571          ;
          F571 7F7F     SAVE7F  DW      7F7FH
          F573 53415645         DB      'SAVE'
          F577 05               DB      5
          F578 CD9AF3           CALL    OSTR
          F57B 4E616D65         DB      'Name :',0
          F582 CD85F4           CALL    INLIN
          F585 D8               RET     C       ;BRK
          F586 210600           LD      HL,6
          F589 19               ADD     HL,DE   ;Beginn Name
          F58A                  ;
          F58A 1100B7   SAVE    LD      DE,CASS         ;**36**
          F58D 010B00           LD      BC,11   ;Name nach
          F590 EDB0             LDIR            ;Puffer
          F592 AF               XOR     A
          F593 12               LD      (DE),A
          F594 2181B7           LD      HL,ARGN ;alle Arg.
          F597 1E10             LD      E,10H   ;mit ARGN
          F599 0E15             LD      C,15H
          F59B EDB0             LDIR            ;nach Puffer
          F59D CD54F5           CALL    KPUFF   ;Standard setzen
          F5A0 CD28E5           CALL    ISRO
          F5A3 2A82B7   SAV1    LD      HL,(ARG1);Ladeadr.
          F5A6 1100B7           LD      DE,CASS
          F5A9 018000           LD      BC,80H
          F5AC 3A01B8           LD      A,(0B801H)
          F5AF E601             AND     1
          F5B1 200F             JR      NZ,SAV3 ;IRM ein
          F5B3 41               LD      B,C
          F5B4 CD45F0   SAV2    CALL    SCROFF
          F5B7 7E               LD      A,M     ;aus RAM
          F5B8 CD4EF0           CALL    SCRON
          F5BB 12               LD      (DE),A  ;in Puffer
          F5BC 23               INC     HL
          F5BD 13               INC     DE
          F5BE 10F4             DJNZ    SAV2
          F5C0 1802             JR      SAV4
          F5C2 EDB0     SAV3    LDIR            ;kopieren
          F5C4 2282B7   SAV4    LD      (ARG1),HL
          F5C7 CD9AF3           CALL    OSTR
          F5CA 0200             DB      2,0     ;CLLN
          F5CC CD94F3           CALL    BNROST  ;Blocknummer
          F5CF 00               NOP
          F5D0 01A000           LD      BC,0A0H
          F5D3 CDACE4           CALL    BRKT
          F5D6 DAE2E4           JP      C,CSROI ;BRK
          F5D9 ED5B84B7         LD      DE,(ARG2)
          F5DD ED52             SBC     HL,DE   ;Ende erreicht?
          F5DF D2DBE4           JP      NC,CSRO
          F5E2 CD37E5           CALL    MBO     ;Block ausgeben
          F5E5 18BC             JR      SAV1
          F5E7
          F5E7 ED4B86B7 LARG    LD      BC,(ARG3)       ;**15**
          F5EB ED5B84B7         LD      DE,(ARG2)
          F5EF 2A82B7           LD      HL,(ARG1)
          F5F2 3A81B7           LD      A,(ARGN)
          F5F5 C9               RET
          F5F6
          F5F6          LUP     ;LOAD-Unterprogramm
          F5F6                  ;PA: CY=1 BRK gedrueckt
          F5F6 DD3403           INC     (IX+3)  ;erwarteter Blk
          F5F9 CD9DE5   LUP1    CALL    MBI
          F5FC 3020             JR      NC,LUP3
          F5FE CD9AF3           CALL    OSTR
          F601 09090920         DB      9,9,9,' ',0
          F606 CD94F3           CALL    BNROST
          F609 203F             DB      ' ?'    ;fehlerhaft
          F60B 1E00             DB      1EH,0
          F60D DD7E03           LD      A,(IX+3)
          F610 3D               DEC     A       ;Block 01 erw.?
          F611 28E6             JR      Z,LUP1
          F613 CDE4F3           CALL    KBD     ;nein
          F616 FE03             CP      3       ;BRK?
          F618 37               SCF
          F619 C8               RET     Z
          F61A FE0A             CP      LF      ;CUD?
          F61C 20DB             JR      NZ,LUP1
          F61E DD7E02   LUP3    LD      A,(IX+2)
          F621 DD4603           LD      B,(IX+3)
          F624 05               DEC     B       ;Block 01 erw.?
          F625 2817             JR      Z,LUP6
          F627 04               INC     B       ;richtige
          F628 B8               CP      B       ;Blocknummer?
          F629 280B             JR      Z,LUP5
          F62B 3C               INC     A       ;Block FF?
          F62C 2808             JR      Z,LUP5
          F62E CD94F3   LUP4    CALL    BNROST
          F631 2A               DB      '*'     ;falsche Nr.
          F632 1900             DB      19H,0
          F634 18C3             JR      LUP1
          F636
          F636 CD94F3   LUP5    CALL    BNROST
          F639 3E20             DB      '> '    ;korrekter Blk.
          F63B 1900             DB      19H,0
          F63D C9               RET
          F63E
          F63E 3D       LUP6    DEC     A       ;Block 01?
          F63F 20ED             JR      NZ,LUP4
          F641 CDC9F4           CALL    CRLF    ;keine Nr,
          F644 2100B7           LD      HL,CASS
          F647 060B             LD      B,11    ;sondern Name
          F649 7E       LUP7    LD      A,M     ;ausgeben
          F64A 23               INC     HL
          F64B CDF7E3           CALL    CRT
          F64E 10F9             DJNZ    LUP7
          F650 C3BAF4           JP      SPACE
          F653
          F653 CD9AF3   NOMC    CALL    OSTR
          F656 6B65696E         DB      'keine MC-Datei!',0
          F666 C3E2E4   CLJP    JP      CSROI
          F669          ;
          F669 7F7F     VERI7F  DW      7F7FH
          F66B 56455249         DB      'VERIFY'
          F671 01               DB      1
          F672 DD360700 VERIF   LD      (IX+7),0        ;**11**
          F676 1816             JR      LOAD1
          F678          ;
          F678 7F7F     LOAD7F  DW      7F7FH
          F67A 4C4F4144         DB      'LOAD'
          F67E 01               DB      1
          F67F DD360701 LOAD    LD      (IX+7),1;LOAD   ;**10**
          F683 3A81B7           LD      A,(ARGN)
          F686 FE02             CP      2
          F688 3804             JR      C,LOAD1 ;Autostart?
          F68A DDCB07CE         SET     1,(IX+7);unterdruecken
          F68E CDB6E4   LOAD1   CALL    ISRI1
          F691 CD54F5           CALL    KPUFF   ;Standard setzen
          F694 DD360300         LD      (IX+3),0
          F698 CDF6F5           CALL    LUP
          F69B 38C9     LOAD2   JR      C,CLJP  ;BRK
          F69D DDCB0746         BIT     0,(IX+7)
          F6A1 2855             JR      Z,LOAD5 ;Verify
          F6A3 2E10             LD      L,10H
          F6A5 DD7E07           LD      A,(IX+7)
          F6A8 E6E3             AND     0E3H    ;Bits 2..4 Null
          F6AA DD7707           LD      (IX+7),A
          F6AD 7E               LD      A,M     ;Anzahl Arg.
          F6AE CB27             SLA     A
          F6B0 CB27             SLA     A       ;2* schieben
          F6B2 E61C             AND     1CH     ;Maske
          F6B4 DDB607           OR      (IX+7)
          F6B7 DD7707           LD      (IX+7),A
          F6BA 7E               LD      A,M     ;Anzahl Arg.
          F6BB D602             SUB     2
          F6BD FE09             CP      9       ;MC?
          F6BF 3092             JR      NC,NOMC
          F6C1 ED4B15B7         LD      BC,(CASS+15H)
          F6C5 C5               PUSH    BC
          F6C6 ED5B13B7         LD      DE,(CASS+13H)
          F6CA 2A11B7           LD      HL,(CASS+11H)
          F6CD 3A81B7           LD      A,(ARGN)
          F6D0 A7               AND     A       ;Ladeoffset?
          F6D1 2811             JR      Z,LOAD3 ;nein
          F6D3 ED4B82B7         LD      BC,(ARG1)
          F6D7 09               ADD     HL,BC   ;AAdr,Eadr
          F6D8 EB               EX      DE,HL   ;umrechnen
          F6D9 09               ADD     HL,BC
          F6DA EB               EX      DE,HL
          F6DB DDCB0766         BIT     4,(IX+7);4..7 Args?
          F6DF 2003             JR      NZ,LOAD3
          F6E1 E3               EX      (SP),HL
          F6E2 09               ADD     HL,BC   ;SAdr umrechnen
          F6E3 E3               EX      (SP),HL
          F6E4 CDE7F4   LOAD3   CALL    HLDE    ;AAdr,EAdr ausg.
          F6E7 3A10B7           LD      A,(CASS+10H)
          F6EA FE03             CP      3
          F6EC 3805             JR      C,LOAD4 ;keine SAdr
          F6EE E3               EX      (SP),HL
          F6EF CDB2F4           CALL    HLHX    ;SAdr ausg.
          F6F2 E3               EX      (SP),HL
          F6F3 C1       LOAD4   POP     BC      ;SAdr merken
          F6F4 ED4386B7         LD      (ARG3),BC
          F6F8 CDC9F4   LOAD5   CALL    CRLF
          F6FB EB               EX      DE,HL   ;DE=Ladeadr.
          F6FC                  ;Load-Hauptschleife
          F6FC CDF6F5   LOAD6   CALL    LUP
          F6FF 389A             JR      C,LOAD2 ;BRK
          F701 DDCB0746         BIT     0,(IX+7)
          F705 2828             JR      Z,LOAD11;Verify
          F707 E5               PUSH    HL
          F708 ED52             SBC     HL,DE
          F70A 018000           LD      BC,80H
          F70D ED42             SBC     HL,BC
          F70F 09               ADD     HL,BC
          F710 3001             JR      NC,LOAD7
          F712 4D               LD      C,L     ;restl. Anzahl
          F713 2100B7   LOAD7   LD      HL,CASS
          F716 3A01B8           LD      A,(0B801H)
          F719 E601             AND     1
          F71B 200F             JR      NZ,LOAD9;IRM ein
          F71D 41               LD      B,C
          F71E 7E       LOAD8   LD      A,M     ;aus Puffer
          F71F CD45F0           CALL    SCROFF
          F722 12               LD      (DE),A  ;in RAM
          F723 23               INC     HL
          F724 13               INC     DE
          F725 CD4EF0           CALL    SCRON
          F728 10F4             DJNZ    LOAD8
          F72A 1802             JR      LOAD10
          F72C EDB0     LOAD9   LDIR            ;kopieren
          F72E E1       LOAD10  POP     HL
          F72F DD3402   LOAD11  INC     (IX+2)  ;Blocknr. FF?
          F732 20C8             JR      NZ,LOAD6
          F734                  ;
          F734 CDE2E4   CSRI    CALL    CSROI           ;**0B**
          F737 DD7E07           LD      A,(IX+7)
          F73A E603             AND     3
          F73C 3D               DEC     A
          F73D C0               RET     NZ      ;kein Start
          F73E DD7E07           LD      A,(IX+7)
          F741 E61C             AND     1CH
          F743 FE0C             CP      0CH
          F745 D8               RET     C       ;keine Sadr
          F746 2A86B7           LD      HL,(ARG3);Sadr
          F749 E9               JP      (HL)    ;Ansprung
          F74A          ;
          F74A 7F7F     COL7F   DW      7F7FH
          F74C 434F4C4F         DB      'COLOR'
          F751 01               DB      1
          F752 CD6BFB   COLR    CALL    CON             ;**0F**
          F755 CD1EC5           CALL    COLRC
          F758 181D             JR      JCOFF
          F75A
          F75A E5       CSTBT   PUSH    HL              ;**42**
          F75B 21A2B7           LD      HL,STBT
          F75E CBDE             SET     3,M
          F760 CDC9F3           CALL    OCHR    ;Steuerzeichen
          F763 CB9E             RES     3,M     ;darstellen
          F765 E1               POP     HL
          F766 C9               RET
          F767          ;
          F767 7F7F     DISP7F  DW      7F7FH
          F769 44495350         DB      'DISPLAY'
          F770 03               DB      3
          F771 CD6BFB   DISP    CALL    CON             ;**3B**
          F774 CDA7C7           CALL    DISPC
          F777 C372FB   JCOFF   JP      COFF
          F77A
          F77A          LDAME   ;fuer DISPC, MODIC, FSAVE, view
          F77A CD72FB           CALL    COFF
          F77D 3A01B8           LD      A,(0B801H)
          F780 E601             AND     1       ;IRM off?
          F782 CC45F0           CALL    Z,SCROFF
          F785 7E               LD      A,M     ;Byte holen
          F786 CD4EF0   JCON    CALL    SCRON
          F789 C36BFB           JP      CON
          F78C          ;
          F78C 7F7F     MODI7F  DW      7F7FH
          F78E 4D4F4449         DB      'MODIFY'
          F794 03               DB      3
          F795 CD6BFB   MODI    CALL    CON             ;**2E**
          F798 CDD8C7           CALL    MODIC
          F79B 18DA             JR      JCOFF
          F79D
          F79D          LDMAE   ;fuer MODIC, FLOAD
          F79D CD72FB           CALL    COFF
          F7A0 F5               PUSH    AF
          F7A1 3A01B8           LD      A,(0B801H)
          F7A4 E601             AND     1       ;IRM off?
          F7A6 CC45F0           CALL    Z,SCROFF
          F7A9 F1               POP     AF
          F7AA 77               LD      M,A     ;Byte eintragen
          F7AB 18D9             JR      JCON
          F7AD          ;
          F7AD 7F7F     WIND7F  DW      7F7FH
          F7AF 57494E44         DB      'WINDOW'
          F7B5 01               DB      1
          F7B6 CD6BFB           CALL    CON
          F7B9 CD4FC5           CALL    WINDC
          F7BC 1829             JR      KCOFF
          F7BE
          F7BE CD6BFB   WININ   CALL    CON             ;**3C**
          F7C1 CDA2C5           CALL    WININC
          F7C4 1821             JR      KCOFF
          F7C6
          F7C6 CD6BFB   WINAK   CALL    CON             ;**3D**
          F7C9 CD72C5           CALL    WINAKC
          F7CC 1819             JR      KCOFF
          F7CE          ;
          F7CE 7F7F     KEY7F   DW      7F7FH
          F7D0 4B4559           DB      'KEY'
          F7D3 01               DB      1
          F7D4 FE01             CP      1
          F7D6 3008             JR      NC,KEYL
          F7D8 CD6BFB   KEYLI   CALL    CON             ;**3A**
          F7DB CDB4C4           CALL    KEYLIC  ;Keylist
          F7DE 1807             JR      KCOFF
          F7E0
          F7E0 7D       KEYL    LD      A,L     ;Nummer
          F7E1 CD6BFB   KEY     CALL    CON             ;**39**
          F7E4 CD08C4           CALL    KEYC
          F7E7 C372FB   KCOFF   JP      COFF
          F7EA
          F7EA          CUCP    ;Cursor compeln
          F7EA D5               PUSH    DE              ;**25**
          F7EB F5               PUSH    AF
          F7EC E5               PUSH    HL
          F7ED CD52E0           CALL    PADR0
          F7F0 3822             JR      C,CUCP3 ;auîerhalb
          F7F2 E5               PUSH    HL
          F7F3 CD7CE0           CALL    DABR
          F7F6 7E               LD      A,M
          F7F7 E1               POP     HL
          F7F8 A7               AND     A       ;Dummy?
          F7F9 200A             JR      NZ,CUCP1
          F7FB CBCD             SET     1,L     ;vorletzte
          F7FD CBD5             SET     2,L     ;Cursorzeile
          F7FF 7E               LD      A,M
          F800 EE7F             XOR     7FH     ;Strichcursor
          F802 77               LD      M,A
          F803 180F             JR      CUCP3
          F805 C5       CUCP1   PUSH    BC
          F806 ED5BEEB7         LD      DE,(CUMUST);Muster
          F80A 0608             LD      B,8     ;Zeichenhoehe
          F80C 1A       CUCP2   LD      A,(DE)
          F80D AE               XOR     M       ;verknuepfen
          F80E 77               LD      M,A
          F80F 13               INC     DE
          F810 2C               INC     L
          F811 10F9             DJNZ    CUCP2   ;8*
          F813 C1               POP     BC
          F814 E1       CUCP3   POP     HL
          F815 F1               POP     AF
          F816 D1               POP     DE
          F817 C9               RET
          F818
          F818 CD6BFB   PUSE    CALL    CON             ;**30**
          F81B CD55C6           CALL    PUSEC   ;Punkt setzen
          F81E 1841             JR      COF
          F820
          F820 CD6BFB   PUDE    CALL    CON             ;**2F**
          F823 CD32C7           CALL    PUDEC   ;Punkt loeschen
          F826 1839             JR      COF
          F828
          F828 CD6BFB   CIRCL   CALL    CON             ;**3F**
          F82B CD62C6           CALL    CIRCLC  ;Kreis
          F82E 1831             JR      COF
          F830
          F830 CD6BFB   LINE    CALL    CON             ;**3E**
          F833 CDD8C5           CALL    LINEC   ;Linie
          F836 1829             JR      COF
          F838
          F838 CD6BFB   MBOUT   CALL    CON             ;**38**
          F83B CDB9CD           CALL    MBOC    ;Byte ausgeben
          F83E 1821             JR      COF
          F840
          F840 CD6BFB   MBIN    CALL    CON             ;**37**
          F843 CD33CE           CALL    MBIC    ;Byte einlesen
          F846 1819             JR      COF
          F848
          F848 CD72FB   JIOERR  CALL    COFF    ;Sprung zu
          F84B 2AC9B7           LD      HL,(IOERR);?IO ERROR
          F84E CDA9F0           CALL    IRMOF
          F851 E9               JP      (HL)
          F852          ;
          F852 7F7F     SYS7F   DW      7F7FH
          F854 53595354         DB      'SYSTEM'
          F85A 11               DB      11H
          F85B CD6BFB   ESC6    CALL    CON
          F85E CDEAC0           CALL    SYSTC
          F861 C372FB   COF     JP      COFF
          F864
          F864          BASPV   ;BASIC-I/O-Verteiler
          F864 E5               PUSH    HL
          F865 C5               PUSH    BC
          F866 CD8AF0           CALL    IRMON
          F869 CB6B             BIT     5,E
          F86B D5               PUSH    DE
          F86C 2053             JR      NZ,BASBYE
          F86E 23               INC     HL
          F86F 23               INC     HL
          F870 CB7B             BIT     7,E
          F872 2042             JR      NZ,BSA2
          F874 E5               PUSH    HL
          F875 7B               LD      A,E
          F876 E607             AND     7
          F878 21AEF8           LD      HL,BUPTAB
          F87B 85               ADD     L
          F87C 6F               LD      L,A
          F87D 7A               LD      A,D     ;Parameter
          F87E 53               LD      D,E     ;Steuerbyte
          F87F 5E               LD      E,M     ;UP-Nummer
          F880 E1               POP     HL
          F881 CD87F0           CALL    PV3     ;Aufruf
          F884 D1               POP     DE
          F885 57               LD      D,A     ;Ausg.-Param.
          F886 7B               LD      A,E
          F887 E64F             AND     4FH
          F889 EE43             XOR     43H
          F88B 2018             JR      NZ,BSA1
          F88D CD9AF3           CALL    OSTR
          F890 56455249         DB      'VERIFY ?(Y):',0
          F89D CDE4F3           CALL    KBD
          F8A0 FE59             CP      'Y'
          F8A2 CC72F6           CALL    Z,VERIF
          F8A5 7A       BSA1    LD      A,D
          F8A6 CB9B             RES     3,E
          F8A8 CDA9F0           CALL    IRMOF
          F8AB C1               POP     BC
          F8AC E1               POP     HL
          F8AD C9               RET
          F8AE
          F8AE          BUPTAB  ;H-Teil konstant!
          F8AE 16               DB      16H     ;INTB   #0
          F8AF 24               DB      24H     ;OCHR
          F8B0 37               DB      37H     ;MBIN   #1
          F8B1 38               DB      38H     ;MBOUT
          F8B2 06               DB      06H     ;USIN1  #2
          F8B3 02               DB      02H     ;UOT1
          F8B4 07               DB      07H     ;USIN2  #3
          F8B5 03               DB      03H     ;UOT2
          F8B6
          F8B6 CD98E4   BSA2    CALL    KBDS
          F8B9 D1               POP     DE
          F8BA 57               LD      D,A
          F8BB 30E8             JR      NC,BSA1
          F8BD CBBB             RES     7,E
          F8BF 18E4             JR      BSA1
          F8C1
          F8C1 3A5E03   BASBYE  LD      A,(35EH);geschuetzt?
          F8C4 A7               AND     A
          F8C5 2809             JR      Z,BASB1
          F8C7 CDA9F0           CALL    IRMOF
          F8CA CD41C6           CALL    0C641H  ;NEW
          F8CD CD8AF0           CALL    IRMON
          F8D0 1600     BASB1   LD      D,0
          F8D2 3E02             LD      A,2     ;BASIC-ROM
          F8D4 6F               LD      L,A     ;abschalten
          F8D5 CD09F1           CALL    MODU
          F8D8 2AB0B7           LD      HL,(SUTAB)
          F8DB 116A02           LD      DE,SUBAS
          F8DE A7               AND     A
          F8DF ED52             SBC     HL,DE   ;BASEX aktiv?
          F8E1 2006             JR      NZ,BASB2
          F8E3 2A0102           LD      HL,(SUSP)
          F8E6 22B0B7           LD      (SUTAB),HL
          F8E9 C359F2   BASB2   JP      LOOP
          F8EC
          F8EC 7E       ZKOUT   LD      A,M             ;**45**
          F8ED 23               INC     HL
          F8EE A7               AND     A
          F8EF C8               RET     Z
          F8F0 CDC9F3           CALL    OCHR
          F8F3 18F7             JR      ZKOUT
          F8F5
          F8F5 CDE7F5   TON     CALL    LARG            ;**35**
          F8F8 DDCB084E TON1    BIT     1,(IX+8);noch alter Ton
          F8FC 20FA             JR      NZ,TON1
          F8FE C5       TON2    PUSH    BC
          F8FF 0E8C             LD      C,8CH   ;CTC0
          F901 CD2AF9           CALL    TON4    ;starten
          F904 0C               INC     C       ;CTC1
          F905 EB               EX      DE,HL
          F906 CD2AF9           CALL    TON4    ;starten
          F909 C1               POP     BC
          F90A 79               LD      A,C     ;Lautstaerke
          F90B EE1F             XOR     1FH     ;da nullaktiv
          F90D F681             OR      81H     ;maskieren
          F90F 4F               LD      C,A
          F910 78               LD      A,B
          F911 A7               AND     A       ;Dauerton?
          F912 280D             JR      Z,TON3
          F914 CBB9             RES     7,C     ;nein, Blinkaus
          F916 DDCB08CE         SET     1,(IX+8);neuer Ton
          F91A 3EC7             LD      A,0C7H  ;EI,Zaehler 50Hz
          F91C D38E             OUT     8EH     ;CTC2
          F91E 78               LD      A,B     ;Dauer
          F91F D38E             OUT     8EH
          F921 0660     TON3    LD      B,60H
          F923 DB89     TONB    IN      A,89H
          F925 A0               AND     B       ;RAM8 maskieren
          F926 B1               OR      C
          F927 D389             OUT     89H     ;Ltst. ausgeben
          F929 C9               RET
          F92A
          F92A          TON4    ;CTC (C) programmieren mit HL
          F92A 7D               LD      A,L
          F92B A7               AND     A       ;Ton?
          F92C 2E03             LD      L,3
          F92E 280B             JR      Z,TON6  ;kein Ton
          F930 6F               LD      L,A
          F931 3E07             LD      A,7     ;Zeitgeber
          F933 CB44             BIT     0,H     ;Vorteiler?
          F935 2802             JR      Z,TON5
          F937 F620             OR      20H     ;ja
          F939 ED79     TON5    OUT     (C),A
          F93B ED69     TON6    OUT     (C),L
          F93D C9               RET
          F93E
          F93E          ;ESC-Funktionen:
          F93E 0100B2   ESC1    LD      BC,0B200H
          F941 180D             JR      ESCVR
          F943
          F943 0105AD   ESC2    LD      BC,0AD05H
          F946 1808             JR      ESCVR
          F948
          F948 0104AD   ESC3    LD      BC,0AD04H
          F94B 1803             JR      ESCVR
          F94D
          F94D 0101B2   ESC4    LD      BC,0B201H
          F950 60       ESCVR   LD      H,B
          F951 2E00             LD      L,0
          F953 22CBB7           LD      (VRAM),HL
          F956 06FA             LD      B,0FAH
          F958          AXO84   ;AND/XOR/OUT84
          F958 78               LD      A,B
          F959 F3                DI
          F95A DDA601            AND    (IX+1)
          F95D A9                XOR    C
          F95E DD7701   OUT84    LD     (IX+1),A
          F961 D384              OUT    (84H),A
          F963 FB               EI
          F964 C9               RET
          F965
          F965 0E04     ESC7    LD      C,4     ;Invers-Bit
          F967 21A2B7   XORSTB  LD      HL,STBT
          F96A 7E               LD      A,M
          F96B A9               XOR     C
          F96C 77               LD      M,A
          F96D C9               RET
          F96E
          F96E DD7E01   ESC9    LD      A,(IX+1)
          F971 EE02             XOR     2
          F973 F3               DI
          F974 18E8             JR      OUT84
          F976
          F976 21A2B7   ESCA    LD      HL,STBT
          F979 CBB6             RES     6,M     ;HRG aus
          F97B 0108FF   ESCAB   LD      BC,0FF08H
          F97E CD58F9           CALL    AXO84
          F981 01007F           LD      BC,7F00H;Blinken aus
          F984 CB5F             BIT     3,A
          F986 2802             JR      Z,AXO89
          F988 0E80             LD      C,80H   ;ein
          F98A DB89     AXO89   IN      A,89H
          F98C A0               AND     B
          F98D A9               XOR     C
          F98E D389             OUT     89H
          F990 C9               RET
          F991
          F991 21A2B7   ESCB    LD      HL,STBT
          F994 CBF6             SET     6,M     ;HRG ein
          F996 18E3             JR      ESCAB
          F998
          F998 0E20     ESCC    LD      C,20H   ;IBM <-> CAOS
          F99A 18CB             JR      XORSTB
          F99C          ;
          F99C 7F7F     V24O7F  DW      7F7FH
          F99E 5632344F         DB      'V24OUT'
          F9A4 01               DB      1
          F9A5          V24OUT  ;Druckerroutine          **47**
          F9A5 CD6BFB           CALL    CON
          F9A8 CD78C8           CALL    V24OC
          F9AB 3E0D     V24CRLF LD      A,CR
          F9AD CDF9F9           CALL    PRINT
          F9B0 3E0A             LD      A,LF    ;CR+LF drucken
          F9B2 CDF9F9           CALL    PRINT
          F9B5 C372FB   COF1    JP      COFF
          F9B8
          F9B8          HCPGM   ;Reaktion auf ShCLR
          F9B8 F5               PUSH    AF
          F9B9 DD7E04           LD      A,(IX+4);CAOSC merken
          F9BC F5               PUSH    AF
          F9BD CBFF             SET     7,A     ;CAOSC on
          F9BF DD7704           LD      (IX+4),A
          F9C2 D386             OUT     86H
          F9C4 CD04CA           CALL    HCPGMC
          F9C7 F1               POP     AF
          F9C8 DD7704           LD      (IX+4),A;wie vorher
          F9CB D386             OUT     86H
          F9CD F1               POP     AF
          F9CE C9               RET
          F9CF
          F9CF          ;
          F9CF 7F7F     V24D7F  DW      7F7FH
          F9D1 56323444         DB      'V24DUP'
          F9D7 01               DB      1
          F9D8          V24DUP  ;Duplexroutine           **48**
          F9D8 CD6BFB           CALL    CON
          F9DB CDF8CC           CALL    V24DC
          F9DE 18D5             JR      COF1
          F9E0
          F9E0 CD6BFB   INIDUP  CALL    CON
          F9E3 CD6ECD           CALL    UMINIT
          F9E6 18CD             JR      COF1
          F9E8
          F9E8          ;Centronics initialisieren
          F9E8 7F7F     CEN7F   DW      7F7FH
          F9EA 43454E           DB      'CEN'
          F9ED 01               DB      1
          F9EE CD6BFB           CALL    CON
          F9F1 CD4EC8           CALL    CENC
          F9F4 18B5             JR      V24CRLF
          F9F6
          F9F6          ECHO    ;Druckroutine mit Protokoll
          F9F6 CDF7E3           CALL    CRT
          F9F9 DDCB047E PRINT   BIT     7,(IX+4)
          F9FD 2008             JR      NZ,PR1  ;CAOSC on!
          F9FF E5               PUSH    HL
          FA00 2172FB           LD      HL,COFF ;nach PRINTC
          FA03 E3               EX      (SP),HL ;wieder aus
          FA04 CD6BFB           CALL    CON
          FA07 CDA6C9   PR1     CALL    PRINTC  ;drucken
          FA0A C9               RET
          FA0B
          FA0B          M001PR  ;Druckroutine fuer M001
          FA0B F5               PUSH    AF
          FA0C DB05     BUSY1   IN      A,(5)
          FA0E CB57             BIT     2,A     ;BUSY?
          FA10 20FA             JR      NZ,BUSY1
          FA12 F1               POP     AF
          FA13 F5               PUSH    AF
          FA14 D304             OUT     (4),A   ;Daten
          FA16 AF               XOR     A
          FA17 D305             OUT     (5),A
          FA19 3C               INC     A       ;Strobe-Imp.
          FA1A D305             OUT     (5),A
          FA1C F1               POP     AF
          FA1D C9               RET
          FA1E
          FA1E          M021PR  ;Druckroutine fuer M021
          FA1E F5               PUSH    AF
          FA1F DB90     BUSY2   IN      A,(90H)
          FA21 CB77             BIT     6,A     ;BUSY?
          FA23 20FA             JR      NZ,BUSY2
          FA25 F1               POP     AF
          FA26 F5               PUSH    AF
          FA27 D391             OUT     (91H),A ;Daten
          FA29 AF               XOR     A
          FA2A D390             OUT     (90H),A
          FA2C 3E80             LD      A,80H   ;Strobe-Imp.
          FA2E D390             OUT     (90H),A
          FA30 F1               POP     AF
          FA31 C9               RET
          FA32
          FA32          V24PR   ;Druckroutine fuer V24
          FA32 F5               PUSH    AF
          FA33 C5       V24PR1  PUSH    BC
          FA34 CDB5FA           CALL    LCSO
          FA37 3E0A             LD      A,0AH
          FA39 81               ADD     C
          FA3A 4F               LD      C,A
          FA3B ED78             IN      A,(C)
          FA3D CB57             BIT     2,A     ;bereit?
          FA3F 2008             JR      NZ,V24PR2
          FA41 3E01             LD      A,1     ;nein-warten
          FA43 CD86F3           CALL    WAIT
          FA46 C1               POP     BC
          FA47 18EA             JR      V24PR1
          FA49 C1       V24PR2  POP     BC
          FA4A F1               POP     AF
          FA4B C5               PUSH    BC
          FA4C F5               PUSH    AF
          FA4D CDB5FA           CALL    LCSO
          FA50 3E08     V24PUT  LD      A,8
          FA52 81               ADD     C
          FA53 4F               LD      C,A
          FA54 F1               POP     AF
          FA55 ED79             OUT     (C),A   ;Ausgabe
          FA57 C1               POP     BC
          FA58 C9               RET
          FA59
          FA59          V24OT   ;Ausgabe V.24-duplex
          FA59 F5               PUSH    AF
          FA5A C5       V24OT1  PUSH    BC
          FA5B CDC2FA           CALL    LCSOD
          FA5E 3E0A             LD      A,0AH
          FA60 81               ADD     C
          FA61 4F               LD      C,A
          FA62 ED78             IN      A,(C)
          FA64 CB57             BIT     2,A
          FA66 2008             JR      NZ,V24OT2
          FA68 3E01             LD      A,1
          FA6A CD86F3           CALL    WAIT
          FA6D C1               POP     BC
          FA6E 18EA             JR      V24OT1
          FA70 C1       V24OT2  POP     BC
          FA71 F1               POP     AF
          FA72 C5               PUSH    BC
          FA73 F5               PUSH    AF
          FA74 CDC2FA           CALL    LCSOD
          FA77 18D7             JR      V24PUT
          FA79
          FA79          V24IN   ;Eingabe V.24-duplex
          FA79 C5               PUSH    BC
          FA7A E5               PUSH    HL
          FA7B D5               PUSH    DE
          FA7C CDC2FA           CALL    LCSOD
          FA7F C5               PUSH    BC
          FA80 3E0A             LD      A,0AH
          FA82 81               ADD     C
          FA83 4F               LD      C,A
          FA84 ED78             IN      A,(C)
          FA86 CB47             BIT     0,A     ;bereit?
          FA88 2015             JR      NZ,V24IN2
          FA8A 3E05             LD      A,5     ;WR5
          FA8C ED79             OUT     (C),A
          FA8E 3EEA             LD      A,0EAH  ;DTR on, 8bit,
          FA90 ED79             OUT     (C),A   ;Senderfreigabe
          FA92 ED78     V24IN1  IN      A,(C)
          FA94 CB47             BIT     0,A     ;jetzt bereit?
          FA96 2007             JR      NZ,V24IN2
          FA98 CDACE4           CALL    BRKT
          FA9B 3815             JR      C,V24IN4
          FA9D 18F3             JR      V24IN1
          FA9F                  ;
          FA9F 3E05     V24IN2  LD      A,5     ;WR5
          FAA1 ED79             OUT     (C),A
          FAA3 3E6A             LD      A,6AH   ;DTR off usw.
          FAA5 ED79             OUT     (C),A
          FAA7 C1               POP     BC
          FAA8 3E08             LD      A,8
          FAAA 81               ADD     C
          FAAB 4F               LD      C,A
          FAAC ED78             IN      A,(C)   ;Einlesen
          FAAE D1       V24IN3  POP     DE
          FAAF E1               POP     HL
          FAB0 C1               POP     BC
          FAB1 C9               RET
          FAB2                  ;
          FAB2 C1       V24IN4  POP     BC
          FAB3 18F9             JR      V24IN3
          FAB5
          FAB5          LCSO    ;Lade C mit SIO-Offset f.V24OUT
          FAB5 F5               PUSH    AF
          FAB6 3AE1B7           LD      A,(HCPZ)
          FAB9 CB57     LCSO1   BIT     2,A
          FABB 0E01             LD      C,1
          FABD 2001             JR      NZ,LCSOE
          FABF 0D               DEC     C
          FAC0 F1       LCSOE   POP     AF
          FAC1 C9               RET
          FAC2
          FAC2          LCSOD   ;dto. fuer V24DUP
          FAC2 F5               PUSH    AF
          FAC3 3AE8B7           LD      A,(HCPZ2)
          FAC6 18F1             JR      LCSO1
          FAC8
          FAC8          ISRSB   ;ISR SIO B fuer MC-Load oder
          FAC8                  ;Fremdtastatur
          FAC8 E5               PUSH    HL
          FAC9 D5               PUSH    DE
          FACA C5               PUSH    BC
          FACB F5               PUSH    AF
          FACC DD7E04           LD      A,(IX+4);merken fuer
          FACF F5               PUSH    AF      ;CAOS-ROM-C
          FAD0 DB09             IN      A,9     ;1.Zeichen
          FAD2 2166FB           LD      HL,IOTAB3
          FAD5 CD5DF5           CALL    INIEA
          FAD8 CD5AFB           CALL    IRET
          FADB FE0D             CP      CR      ;Fremdtastatur?
          FADD 281B             JR      Z,ISB2
          FADF FE1B             CP      ESC     ;MC-Programm?
          FAE1 2012             JR      NZ,ISB1
          FAE3 3E06             LD      A,6
          FAE5 32E8B7           LD      (HCPZ2),A
          FAE8 CDD8F9           CALL    V24DUP
          FAEB CD79FA           CALL    V24IN
          FAEE D654             SUB     'T'
          FAF0 281B             JR      Z,ISB4  ;MC laden
          FAF2 3D               DEC     A
          FAF3 282C             JR      Z,ISB6  ;MC starten
          FAF5 CDE0F9   ISB1    CALL    INIDUP  ;nichts
          FAF8 180B             JR      ISB3
          FAFA                  ;
          FAFA CDE0F9   ISB2    CALL    INIDUP
          FAFD 2129FB           LD      HL,ISRT ;Neue ISR
          FB00 F3               DI
          FB01 22E201           LD      (1E2H),HL
          FB04 FB               EI
          FB05 F1       ISB3    POP     AF
          FB06 D386             OUT     86H     ;wie vor INT!
          FB08 F1               POP     AF
          FB09 C1               POP     BC
          FB0A D1               POP     DE
          FB0B E1               POP     HL
          FB0C C9               RET
          FB0D                  ;
          FB0D CD5DFB   ISB4    CALL    V24HL   ;Adresse
          FB10 EB               EX      DE,HL
          FB11 CD5DFB           CALL    V24HL   ;Anzahl
          FB14 EB               EX      DE,HL
          FB15 CD79FA   ISB5    CALL    V24IN
          FB18 77               LD      M,A     ;Daten
          FB19 23               INC     HL
          FB1A 1B               DEC     DE
          FB1B 7B               LD      A,E
          FB1C B2               OR      D
          FB1D 20F6             JR      NZ,ISB5
          FB1F 18D4             JR      ISB1
          FB21                  ;
          FB21 CD5DFB   ISB6    CALL    V24HL
          FB24 CD2CE2           CALL    JPHL    ;Prog. starten
          FB27 18CC             JR      ISB1
          FB29
          FB29          ISRT    ;ISR fuer Fremdtastatur
          FB29 F5               PUSH    AF
          FB2A DB09             IN      A,9
          FB2C A7               AND     A
          FB2D 2820             JR      Z,IST2    ;Code 0
          FB2F DDBE0D           CP      (IX+13)
          FB32 2806             JR      Z,IST1    ;Repeat!
          FB34 DD360A00         LD      (IX+10),0
          FB38 1815             JR      IST2
          FB3A D5       IST1    PUSH    DE
          FB3B 57               LD      D,A       ;Code merken
          FB3C DB88             IN      A,88H
          FB3E 5F               LD      E,A
          FB3F CBD7             SET     2,A       ;IRM on!
          FB41 D388             OUT     88H
          FB43 3AE0B7           LD      A,(COUNT)
          FB46 3C               INC     A
          FB47 DD770A           LD      (IX+10),A ;repeat jetzt
          FB4A 7B               LD      A,E
          FB4B D388             OUT     88H
          FB4D 7A               LD      A,D
          FB4E D1               POP     DE
          FB4F DD770D   IST2    LD      (IX+13),A ;Code
          FB52 A7               AND     A
          FB53 2804             JR      Z,IST3
          FB55 DDCB08C6         SET     0,(IX+8)  ;aktivieren
          FB59 F1       IST3    POP     AF
          FB5A FB       IRET    EI
          FB5B ED4D             RETI
          FB5D
          FB5D CD79FA   V24HL   CALL    V24IN
          FB60 6F               LD      L,A
          FB61 CD79FA           CALL    V24IN
          FB64 67               LD      H,A
          FB65 C9               RET
          FB66
          FB66 0B       IOTAB3  DB      0BH     ;SIO-B
          FB67 03                DB     3       ;3 Byte
          FB68 18                 DB    18H     ;ruecksetzen
          FB69 05                 DB    5       ;WR5
          FB6A 6A                 DB    6AH     ;DTR off
          FB6B
          FB6B          CON     ;CAOS-ROM C on
          FB6B F5               PUSH    AF
          FB6C DDCB04FF         SET     7,(IX+4),A
          FB70 180C             JR      CSW
          FB72
          FB72          COFF    ;CAOS-ROM C off
          FB72 F5               PUSH    AF
          FB73 3A05B8           LD      A,(0B805H)
          FB76 E601             AND     1
          FB78 2006             JR      NZ,CNSW ;bleibt on!
          FB7A DDCB04BF         RES     7,(IX+4),A
          FB7E D386     CSW     OUT     86H
          FB80 F1       CNSW    POP     AF
          FB81 C9               RET
          FB82
          FB82          MULT    ;BA=D*C                  **41**
          FB82 CD6BFB           CALL    CON
          FB85 CD0DC5           CALL    MULC
          FB88 18E8             JR      COFF
          FB8A
          FB8A CD6BFB   SQR     CALL    CON             ;**40**
          FB8D CDFEC4           CALL    SQRC
          FB90 18E0             JR      COFF
          FB92
          FB92          ISRC2   ;CTC2: Tonlg
          FB92 CD23E6           CALL    INTEND
          FB95 F5               PUSH    AF
          FB96 D5               PUSH    DE
          FB97 DB88             IN      A,88H
          FB99 5F               LD      E,A
          FB9A CBD7             SET     2,A     ;IRM on
          FB9C D388             OUT     88H
          FB9E CDCFE4           CALL    TOFF
          FBA1 7B               LD      A,E
          FBA2 D388             OUT     88H
          FBA4 D1               POP     DE
          FBA5 F1               POP     AF
          FBA6 C9               RET
          FBA7
          FBA7 00       ZEI0    DB      0       ;CRT
          FBA8 38               DB      38H     ;MBOUT
          FBA9 02       ZEI2    DB      2       ;UOUT1
          FBAA 03       ZEI3    DB      3       ;UOUT2
          FBAB 04       ZEI4    DB      4       ;KBD
          FBAC 37               DB      37H     ;MBIN
          FBAD 06               DB      6       ;UIN1
          FBAE 07               DB      7       ;UIN2
          FBAF
          FBAF F7E3     SUTB    DW      CRT     ;00
          FBB1 37E5             DW      MBO     ;01
          FBB3 BDB7             DW      UOUT1   ;02
          FBB5 C3B7             DW      UOUT2   ;03
          FBB7 E4F3             DW      KBD     ;04
          FBB9 9DE5             DW      MBI     ;05
          FBBB C0B7             DW      UIN1    ;06
          FBBD C6B7             DW      UIN2    ;07
          FBBF 28E5             DW      ISRO    ;08
          FBC1 DBE4             DW      CSRO    ;09
          FBC3 9AE5             DW      ISRI    ;0A
          FBC5 34F7             DW      CSRI    ;0B
          FBC7 98E4             DW      KBDS    ;0C
          FBC9 8EF1             DW      BYE     ;0D
          FBCB A3E4             DW      KBDZ    ;0E
          FBCD 52F7             DW      COLR    ;0F
          FBCF 7FF6             DW      LOAD    ;10
          FBD1 72F6             DW      VERIF   ;11
          FBD3 59F2             DW      LOOP    ;12
          FBD5 A6F3             DW      NORM    ;13
          FBD7 86F3             DW      WAIT    ;14
          FBD9 E7F5             DW      LARG    ;15
          FBDB C3F3             DW      INTB    ;16
          FBDD 85F4             DW      INLIN   ;17
          FBDF F0F4             DW      RHEX    ;18
          FBE1 BFF4             DW      ERRM    ;19
          FBE3 B2F4             DW      HLHX    ;1A
          FBE5 E7F4             DW      HLDE    ;1B
          FBE7 D4F4             DW      AHEX    ;1C
          FBE9 56F3             DW      ZSUCH   ;1D
          FBEB ACF3             DW      SOUT    ;1E
          FBED B9F3             DW      SIN     ;1F
          FBEF A9F3             DW      NOUT    ;20
          FBF1 B6F3             DW      NIN     ;21
          FBF3 25F5             DW      GARG    ;22
          FBF5 9AF3             DW      OSTR    ;23
          FBF7 C9F3             DW      OCHR    ;24
          FBF9 EAF7             DW      CUCP    ;25
          FBFB 09F1             DW      MODU    ;26
          FBFD 1AF1             DW      JUMP    ;27
          FBFF E4E3             DW      LDMA    ;28
          FC01 E6E3             DW      LDAM    ;29
          FC03 ACE4             DW      BRKT    ;2A
          FC05 BAF4             DW      SPACE   ;2B
          FC07 C9F4             DW      CRLF    ;2C
          FC09 D0F4             DW      HOME    ;2D
          FC0B 95F7             DW      MODI    ;2E
          FC0D 20F8             DW      PUDE    ;2F
          FC0F 18F8             DW      PUSE    ;30
          FC11 4BF5             DW      SIXD    ;31
          FC13 7CE0             DW      DABR    ;32
          FC15 70E0             DW      TCIF    ;33
          FC17 60E0             DW      PADR    ;34
          FC19 F5F8             DW      TON     ;35
          FC1B 8AF5             DW      SAVE    ;36
          FC1D 40F8             DW      MBIN    ;37
          FC1F 38F8             DW      MBOUT   ;38
          FC21 E1F7             DW      KEY     ;39
          FC23 D8F7             DW      KEYLI   ;3A
          FC25 71F7             DW      DISP    ;3B
          FC27 BEF7             DW      WININ   ;3C
          FC29 C6F7             DW      WINAK   ;3D
          FC2B 30F8             DW      LINE    ;3E
          FC2D 28F8             DW      CIRCL   ;3F
          FC2F 8AFB             DW      SQR     ;40
          FC31 82FB             DW      MULT    ;41
          FC33 5AF7             DW      CSTBT   ;42
          FC35 5DF5             DW      INIEA   ;43
          FC37 68F5             DW      INIME   ;44
          FC39 ECF8             DW      ZKOUT   ;45
          FC3B 1BF2             DW      MENU    ;46
          FC3D A5F9             DW      V24OUT  ;47
          FC3F D8F9             DW      V24DUP  ;48
          FC41
          FC41
          FC41 5777     KTAB    DB      'Ww'
          FC43 4161             DB      'Aa'
          FC45 3222             DB      '2"'
          FC47 0819             DB      8,19H           ; CUL
          FC49 100C             DB      10H,0CH         ; HOME
          FC4B 2D3D             DB      '-='
          FC4D F2F8             DB      0F2H,0F8H       ; F2
          FC4F 5979             DB      'Yy'
          FC51 4565             DB      'Ee'
          FC53 5373             DB      'Ss'
          FC55 3323             DB      '3#'
          FC57 5E5D             DB      '^_'
          FC59 010F             DB      1,0FH           ; CLR
          FC5B 3A2A             DB      ':*'
          FC5D F3F9             DB      0F3H,0F9H       ; F3
          FC5F 5878             DB      'Xx'
          FC61 5474             DB      'Tt'
          FC63 4666             DB      'Ff'
          FC65 3525             DB      '5%'
          FC67 5070             DB      'Pp'
          FC69 1F02             DB      1FH,2           ; DEL
          FC6B 3040             DB      '0',40H
          FC6D F5FB             DB      0F5H,0FBH       ; F5
          FC6F 5676             DB      'Vv'
          FC71 5575             DB      'Uu'
          FC73 4868             DB      'Hh'
          FC75 3727             DB      '7',27H
          FC77 4F6F             DB      'Oo'
          FC79 1A14             DB      1AH,14H         ; INS
          FC7B 3929             DB      '9)'
          FC7D 0304             DB      3,4             ; BRK
          FC7F 4E6E             DB      'Nn'
          FC81 4969             DB      'Ii'
          FC83 4A6A             DB      'Jj'
          FC85 3828             DB      '8('
          FC87 205B             DB      ' -'		; SPC
          FC89 4B6B             DB      'Kk'
          FC8B 2C3C             DB      ',<'
          FC8D 131B             DB      13H,ESC         ; STOP
          FC8F 4D6D             DB      'Mm'
          FC91 5A7A             DB      'Zz'
          FC93 4767             DB      'Gg'
          FC95 3626             DB      '6&'
          FC97 1C1D             DB      1CH,1DH		; LIST/RUN
          FC99 4C6C             DB      'Ll'
          FC9B 2E3E             DB      '.>'
          FC9D F6FC             DB      0F6H,0FCH	; F6
          FC9F 4262             DB      'Bb'
          FCA1 5272             DB      'Rr'
          FCA3 4464             DB      'Dd'
          FCA5 3424             DB      '4$'
          FCA7 5F5C             DB      '_Ö'
          FCA9 2B3B             DB      '+;'
          FCAB 2F3F             DB      '/?'
          FCAD F4FA             DB      0F4H,0FAH	; F4
          FCAF 4363             DB      'Cc'
          FCB1 5171             DB      'Qq'
          FCB3 1605             DB      16H,5           ; CAPS
          FCB5 3121             DB      '1!'
          FCB7 0A12             DB      LF,12H          ; CUD
          FCB9 0B11             DB      0BH,11H         ; CUU
          FCBB 0918             DB      09H,18H         ; CUR
          FCBD F1F7             DB      0F1H,0F7H       ; F1
          FCBF 0D0E             DB      CR,0EH          ; ENTER
          FCC1
          FCC1
          FCC1 C8FA     ISRTAB  DW      ISRSB   ;SIO B:Empfang
          FCC3 14E6             DW      ISRPA   ;PIO A:Kassette
          FCC5 13E4             DW      ISRPB   ;PIO B:Tastatur
          FCC7 23E6             DW      INTEND  ;CTC 0:frei
          FCC9 04E6             DW      ISRC1   ;CTC 1:Kassette
          FCCB 92FB             DW      ISRC2   ;CTC 2:Tondauer
          FCCD 07E4             DW      ISRC3   ;CTC 3:Tastatur
          FCCF
          FCCF
          FCCF F0E3     CRTTAB  DW      NOT     ;00
          FCD1 74E2             DW      CLR     ;01
          FCD3 3CE3             DW      CLLN    ;02
          FCD5 F0E3             DW      NOT     ;03=BRK
          FCD7 F0E3             DW      NOT     ;04=Sh-BRK
          FCD9 2DE2             DW      ESC0    ;05=TAB
          FCDB F0E3             DW      NOT     ;06
          FCDD A5E3             DW      BEEP    ;07
          FCDF 53E2             DW      CUL     ;08
          FCE1 3CE2             DW      CUR     ;09
          FCE3 45E2             DW      CUD     ;0A
          FCE5 63E2             DW      CUU     ;0B
          FCE7 C9E2             DW      CLS     ;0C
          FCE9 D9E2             DW      CBL     ;0D=Enter
          FCEB F0E3             DW      NOT     ;0E=Sh-Enter
          FCED 4FE2             DW      HCOPY   ;0F
          FCEF D7E2             DW      HOMEPG  ;10
          FCF1 68E2             DW      PAGE    ;11
          FCF3 6FE2             DW      SCROL   ;12
          FCF5 F0E3             DW      NOT     ;13=STOP
          FCF7 E8E3             DW      CLICK   ;14
          FCF9 F0E3             DW      NOT     ;15
          FCFB F0E3             DW      NOT     ;16=CAPS
          FCFD F0E3             DW      NOT     ;17
          FCFF 5DE2             DW      CEL     ;18
          FD01 D9E2             DW      CBL     ;19
          FD03 AAE2             DW      INS     ;1A
          FD05 F1E3             DW      ESCPRG  ;1B
          FD07 F0E3             DW      NOT     ;1C=LIST
          FD09 F0E3             DW      NOT     ;1D=RUN
          FD0B 43E2             DW      NL      ;1E=CONT
          FD0D 77E2             DW      DEL     ;1F
          FD0F
          FD0F
          FD0F          TOKTAB  ;BASIC-Token
          FD0F                  ;(Bit 7 im 1. Byte gesetzt!)
          FD0F C94E4B45         DB      '+NKEY$'
          FD15 CA4F5953         DB      '-OYST'
          FD1A D3545249         DB      '-TRING$'
          FD21 C94E5354         DB      '+NSTR'
          FD26 D2454E55         DB      '-ENUMBER'
          FD2E C4454C45         DB      '-ELETE'
          FD34 D0415553         DB      'ðAUSE'
          FD39 C2454550         DB      '-EEP'
          FD3D D7494E44         DB      '+INDOW'
          FD43 C24F5244         DB      '-ORDER'
          FD49 C94E4B           DB      '+NK'
          FD4C D0415045         DB      'ðAPER'
          FD51 C154             DB      '-T'
          FD53 C34F4C4F         DB      '+OLOR'
          FD58 D34F554E         DB      '-OUND'
          FD5D D0534554         DB      'ðSET'
          FD61 D0524553         DB      'ðRESET'
          FD67 C24C4F41         DB      '-LOAD'
          FD6C D6504545         DB      '-PEEK'
          FD71 D6504F4B         DB      '-POKE'
          FD76 CC4F4341         DB      '¦OCATE'
          FD7C CB45594C         DB      '-EYLIST'
          FD83 CB4559           DB      '-EY'
          FD86 D3574954         DB      '-WITCH'
          FD8C D0544553         DB      'ðTEST'
          FD91 C34C4F53         DB      '+LOSE'
          FD96 CF50454E         DB      '¤PEN'
          FD9A D2414E44         DB      '-ANDOMIZE'
          FDA3 D6474554         DB      '-GET$'
          FDA8 CC494E45         DB      '¦INE'
          FDAC C3495243         DB      '+IRCLE'
          FDB2 C353524C         DB      '+SRLIN'
          FDB8 80               DB      80H
          FDB9
          FDB9          TOKJP   ;Sprungtabelle fuer BASIC-Token
          FDB9 89EB             DW      INKEY
          FDBB FD02             DW      02FDH   ;JOYST
          FDBD 12E7             DW      STRING
          FDBF 30EC             DW      INSTR
          FDC1 71E7             DW      RENUM
          FDC3 51E9             DW      DELETE
          FDC5 76E9             DW      PAUSE
          FDC7 AAE9             DW      BBEEP
          FDC9 BFE9             DW      WINDOW
          FDCB 95EA             DW      BORDER
          FDCD 06EB             DW      INK
          FDCF 20EB             DW      PAPER
          FDD1 48C3             DW      0C348H  ;AT
          FDD3 3CEB             DW      BCOLOR
          FDD5 A4EB             DW      SOUND
          FDD7 E7EB             DW      PSET
          FDD9 18EC             DW      PRESET
          FDDB 49EA             DW      BLOAD
          FDDD 48C3             DW      0C348H  ;VPEEK
          FDDF 78EA             DW      VPOKE
          FDE1 55EB             DW      LOCATE
          FDE3 B1EC             DW      KEYLIST
          FDE5 A5EC             DW      BKEY
          FDE7 B5EC             DW      SWITCH
          FDE9 48C3             DW      0C348H  ;PTEST
          FDEB 01ED             DW      CLOSE
          FDED 42ED             DW      OPEN
          FDEF 3CED             DW      RANDOM
          FDF1 48C3             DW      0C348H  ;VGET
          FDF3 77ED             DW      BLINE
          FDF5 7CED             DW      CIRCLE
          FDF7
          FDF7          FREIF   EQU     $
          FDF7 FF               DS      0FDF8H-$,0FFH   ;frei
          FDF8
          FDF8 80402010 BITTAB  DB      80H,40H,20H,10H
          FDFC 08040201         DB      8,4,2,1
          FE00
          FE00                  END

        Errors: 0000
        End+1 : FE00
        
